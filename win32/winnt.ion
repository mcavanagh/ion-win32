@foreign const LANG_NEUTRAL   = 0x00;
@foreign const LANG_INVARIANT = 0x7f;

@foreign const SUBLANG_NEUTRAL            = 0x00;
@foreign const SUBLANG_DEFAULT            = 0x01;
@foreign const SUBLANG_SYS_DEFAULT        = 0x02;
@foreign const SUBLANG_CUSTOM_DEFAULT     = 0x03;
@foreign const SUBLANG_CUSTOM_UNSPECIFIED = 0x04;
@foreign const SUBLANG_UI_CUSTOM_DEFAULT  = 0x05;

@foreign
func MAKELANGID(p: WORD, s: WORD): WORD;

@foreign const DELETE                   = 0x00010000L;
@foreign const READ_CONTROL             = 0x00020000L;
@foreign const WRITE_DAC                = 0x00040000L;
@foreign const WRITE_OWNER              = 0x00080000L;
@foreign const SYNCHRONIZE              = 0x00100000L;
@foreign const STANDARD_RIGHTS_REQUIRED = 0x000F0000L;
@foreign const STANDARD_RIGHTS_READ     = READ_CONTROL;
@foreign const STANDARD_RIGHTS_WRITE    = READ_CONTROL;
@foreign const STANDARD_RIGHTS_EXECUTE  = READ_CONTROL;
@foreign const STANDARD_RIGHTS_ALL      = 0x001F0000L;
@foreign const SPECIFIC_RIGHTS_ALL      = 0x0000FFFFL;

@foreign const GENERIC_READ    = long(0x80000000);
@foreign const GENERIC_WRITE   = long(0x40000000);
@foreign const GENERIC_EXECUTE = long(0x20000000);
@foreign const GENERIC_ALL     = long(0x10000000);

@foreign const FILE_READ_DATA               = 0x0001;
@foreign const FILE_LIST_DIRECTORY          = 0x0001;
@foreign const FILE_WRITE_DATA              = 0x0002;
@foreign const FILE_ADD_FILE                = 0x0002;
@foreign const FILE_APPEND_DATA             = 0x0004;
@foreign const FILE_ADD_SUBDIRECTORY        = 0x0004;
@foreign const FILE_CREATE_PIPE_INSTANCE    = 0x0004;

@foreign const FILE_READ_EA             = 0x0008;
@foreign const FILE_WRITE_EA            = 0x0010;
@foreign const FILE_EXECUTE             = 0x0020;
@foreign const FILE_TRAVERSE            = 0x0020;
@foreign const FILE_DELETE_CHILD        = 0x0040;
@foreign const FILE_READ_ATTRIBUTES     = 0x0080;
@foreign const FILE_WRITE_ATTRIBUTES    = 0x0100;
@foreign const FILE_ALL_ACCESS          = STANDARD_RIGHTS_REQUIRED | SYNCHRONIZE | 0x1FF;
@foreign const FILE_GENERIC_READ        = STANDARD_RIGHTS_READ | FILE_READ_DATA | FILE_READ_ATTRIBUTES | FILE_READ_EA | SYNCHRONIZE;
@foreign const FILE_GENERIC_WRITE       = STANDARD_RIGHTS_WRITE | FILE_WRITE_DATA | FILE_WRITE_ATTRIBUTES | FILE_WRITE_EA | FILE_APPEND_DATA | SYNCHRONIZE;
@foreign const FILE_GENERIC_EXECUTE     = STANDARD_RIGHTS_EXECUTE | FILE_READ_ATTRIBUTES | FILE_EXECUTE | SYNCHRONIZE;

@foreign const FILE_SHARE_READ      = 0x00000001;
@foreign const FILE_SHARE_WRITE     = 0x00000002;
@foreign const FILE_SHARE_DELETE    = 0x00000004;

@foreign const FILE_ATTRIBUTE_READONLY              = 0x00000001;
@foreign const FILE_ATTRIBUTE_HIDDEN                = 0x00000002;
@foreign const FILE_ATTRIBUTE_SYSTEM                = 0x00000004;
@foreign const FILE_ATTRIBUTE_DIRECTORY             = 0x00000010;
@foreign const FILE_ATTRIBUTE_ARCHIVE               = 0x00000020;
@foreign const FILE_ATTRIBUTE_DEVICE                = 0x00000040;
@foreign const FILE_ATTRIBUTE_NORMAL                = 0x00000080;
@foreign const FILE_ATTRIBUTE_TEMPORARY             = 0x00000100;
@foreign const FILE_ATTRIBUTE_SPARSE_FILE           = 0x00000200;
@foreign const FILE_ATTRIBUTE_REPARSE_POINT         = 0x00000400;
@foreign const FILE_ATTRIBUTE_COMPRESSED            = 0x00000800;
@foreign const FILE_ATTRIBUTE_OFFLINE               = 0x00001000;
@foreign const FILE_ATTRIBUTE_NOT_CONTENT_INDEXED   = 0x00002000;
@foreign const FILE_ATTRIBUTE_ENCRYPTED             = 0x00004000;
@foreign const FILE_ATTRIBUTE_INTEGRITY_STREAM      = 0x00008000;
@foreign const FILE_ATTRIBUTE_VIRTUAL               = 0x00010000;
@foreign const FILE_ATTRIBUTE_NO_SCRUB_DATA         = 0x00020000;
@foreign const FILE_ATTRIBUTE_EA                    = 0x00040000;
@foreign const FILE_ATTRIBUTE_PINNED                = 0x00080000;
@foreign const FILE_ATTRIBUTE_UNPINNED              = 0x00100000;
@foreign const FILE_ATTRIBUTE_RECALL_ON_OPEN        = 0x00040000;
@foreign const FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS = 0x00400000;
@foreign const FILE_ATTRIBUTE_STRICTLY_SEQUENTIAL   = 0x20000000;

@foreign const TREE_CONNECT_ATTRIBUTE_PRIVACY   = 0x00004000;
@foreign const TREE_CONNECT_ATTRIBUTE_INTEGRITY = 0x00008000;
@foreign const TREE_CONNECT_ATTRIBUTE_GLOBAL    = 0x00000004;

@foreign const FILE_VOLUME_IS_COMPRESSED            = 0x00008000;
@foreign const FILE_SUPPORTS_OBJECT_IDS             = 0x00010000;
@foreign const FILE_SUPPORTS_ENCRYPTION             = 0x00020000;
@foreign const FILE_NAMED_STREAMS                   = 0x00040000;
@foreign const FILE_READ_ONLY_VOLUME                = 0x00080000;
@foreign const FILE_SEQUENTIAL_WRITE_ONCE           = 0x00100000;
@foreign const FILE_SUPPORTS_TRANSACTIONS           = 0x00200000;
@foreign const FILE_SUPPORTS_HARD_LINKS             = 0x00400000;
@foreign const FILE_SUPPORTS_EXTENDED_ATTRIBUTES    = 0x00800000;
@foreign const FILE_SUPPORTS_OPEN_BY_FILE_ID        = 0x01000000;
@foreign const FILE_SUPPORTS_USN_JOURNAL            = 0x02000000;
@foreign const FILE_SUPPORTS_INTEGRITY_STREAMS      = 0x04000000;
@foreign const FILE_SUPPORTS_BLOCK_REFCOUNTING      = 0x08000000;
@foreign const FILE_SUPPORTS_SPARSE_VDL             = 0x10000000;
@foreign const FILE_DAX_VOLUME                      = 0x20000000;
@foreign const FILE_SUPPORTS_GHOSTING               = 0x40000000;
@foreign const FILE_INVALID_FILE_ID                 = LONGLONG(-1);

@foreign const FILE_CASE_SENSITIVE_SEARCH           = 0x00000001;
@foreign const FILE_CASE_PRESERVED_NAMES            = 0x00000002;
@foreign const FILE_UNICODE_ON_DISK                 = 0x00000004;
@foreign const FILE_PERSISTENT_ACLS                 = 0x00000008;
@foreign const FILE_FILE_COMPRESSION                = 0x00000010;
@foreign const FILE_VOLUME_QUOTAS                   = 0x00000020;
@foreign const FILE_SUPPORTS_SPARSE_FILES           = 0x00000040;
@foreign const FILE_SUPPORTS_REPARSE_POINTS         = 0x00000080;
@foreign const FILE_SUPPORTS_REMOTE_STORAGE         = 0x00000100;
@foreign const FILE_RETURNS_CLEANUP_RESULT_INFO     = 0x00000200;
@foreign const FILE_SUPPORTS_POSIX_UNLINK_RENAME    = 0x00000400;

@foreign
typedef PVOID = void*;

@foreign
typedef PVOID64 = void*;

@foreign
typedef CHAR = char;

@foreign
typedef SHORT = short;

@foreign
typedef LONG = long;

@foreign
typedef WCHAR = wchar;

@foreign
typedef PWCHAR = WCHAR*;

@foreign
typedef LPWCH = WCHAR*;

@foreign
typedef PWCH = WCHAR*;

@foreign
typedef LPCWCH = WCHAR*;

@foreign
typedef PCWCH = WCHAR*;

@foreign
typedef NWPSTR = WCHAR*;

@foreign
typedef LPWSTR = WCHAR*;

@foreign
typedef PWSTR = WCHAR*;

@foreign
typedef PZPWSTR = PWSTR*;

@foreign
typedef PCZPWSTR = PWSTR*;

@foreign
typedef LPUWSTR = WCHAR*;

@foreign
typedef PUWSTR = WCHAR*;

@foreign
typedef LPCWSTR = WCHAR*;

@foreign
typedef PCWSTR = WCHAR*;

@foreign
typedef PZPCWSTR = PCWSTR*;

@foreign
typedef PCZPCWSTR = PCWSTR*;

@foreign
typedef LPCUWSTR = WCHAR*;

@foreign
typedef PCUWSTR = WCHAR*;

@foreign
typedef PZZWSTR = WCHAR*;

@foreign
typedef PCZZWSTR = WCHAR*;

@foreign
typedef PUZZWSTR = WCHAR*;

@foreign
typedef PCUZZWSTR = WCHAR*;

@foreign
typedef PNZWCH = WCHAR*;

@foreign
typedef PCNZWCH = WCHAR*;

@foreign
typedef PUNZWCH = WCHAR*;

@foreign
typedef PCUNZWCH = WCHAR*;

@foreign
typedef LPCWCHAR = WCHAR*;

@foreign
typedef PCWCHAR = WCHAR*;

@foreign
typedef LPCUWCHAR = WCHAR*;

@foreign
typedef PCUWCHAR = WCHAR*;

@foreign
typedef UCSCHAR = ulong;

@foreign
typedef PUCSCHAR = UCSCHAR*;

@foreign
typedef PCUCSCHAR = UCSCHAR*;

@foreign
typedef PUCSSTR = UCSCHAR*;

@foreign
typedef PUUCSSTR = UCSCHAR*;

@foreign
typedef PCUCSSTR = UCSCHAR*;

@foreign
typedef PCUUCSSTR = UCSCHAR*;

@foreign
typedef PUUCSCHAR = UCSCHAR*;

@foreign
typedef PCUUCSCHAR = UCSCHAR*;

@foreign
typedef PCHAR = CHAR*;

@foreign
typedef LPCH = CHAR*;

@foreign
typedef PCH = CHAR*;

@foreign
typedef LPCCH = CHAR*;

@foreign
typedef PCCH = CHAR*;

@foreign
typedef NPSTR = CHAR*;

@foreign
typedef LPSTR = CHAR*;

@foreign
typedef PSTR = CHAR*;

@foreign
typedef PZPSTR = PSTR*;

@foreign
typedef PCZPSTR = PSTR*;

@foreign
typedef LPCSTR = CHAR*;

@foreign
typedef PCSTR = CHAR*;

@foreign
typedef PZPCSTR = PCSTR*;

@foreign
typedef PCZPCSTR = PCSTR*;

@foreign
typedef PZZSTR = CHAR*;

@foreign
typedef PCZZSTR = CHAR*;

@foreign
typedef PNZCH = CHAR*;

@foreign
typedef PCNZCH = CHAR*;

@foreign
typedef TCHAR = char;

@foreign
typedef PTCHAR = char*;

@foreign
typedef TBYTE = uchar;

@foreign
typedef PTBYTE = uchar*;

@foreign
typedef LPTCH = LPCH;

@foreign
typedef PTCH = LPCH;

@foreign
typedef LPCTCH = LPCCH;

@foreign
typedef PCTCH = LPCCH;

@foreign
typedef PTSTR = LPSTR;

@foreign
typedef LPTSTR = LPSTR;

@foreign
typedef PUTSTR = LPSTR;

@foreign
typedef LPUTSTR = LPSTR;

@foreign
typedef PCTSTR = LPCSTR;

@foreign
typedef LPCTSTR = LPCSTR;

@foreign
typedef PCUTSTR = LPCSTR;

@foreign
typedef LPCUTSTR = LPCSTR;

@foreign
typedef PZZTSTR = PZZSTR;

@foreign
typedef PUZZTSTR = PZZSTR;

@foreign
typedef PCZZTSTR = PCZZSTR;

@foreign
typedef PCUZZTSTR = PCZZSTR;

@foreign
typedef PZPTSTR = PZPSTR;

@foreign
typedef PNZTCH = PNZCH;

@foreign
typedef PUNZTCH = PNZCH;

@foreign
typedef PCNZTCH = PCNZCH;

@foreign
typedef PCUNZTCH = PCNZCH;

@foreign
typedef PSHORT = SHORT*;

@foreign
typedef PLONG = LONG*;

@foreign
struct PROCESSOR_NUMBER {
    Group: WORD;
    Number: BYTE;
    Reserved: BYTE;
}

@foreign
typedef PPROCESSOR_NUMBER = PROCESSOR_NUMBER*;

@foreign
struct GROUP_AFFINITY {
    Mask: KAFFINITY;
    Group: WORD;
    Reserved: WORD[3];
}

@foreign
typedef PGROUP_AFFINITY = GROUP_AFFINITY*;

@foreign
typedef HANDLE = void*;

@foreign
typedef PHANDLE = HANDLE*;

@foreign
typedef FCHAR = BYTE;

@foreign
typedef FSHORT = WORD;

@foreign
typedef FLONG = DWORD;

@foreign
typedef HRESULT = long;

@foreign
typedef CCHAR = char;

@foreign
typedef LCID = DWORD;

@foreign
typedef PLCID = PDWORD;

@foreign
typedef LANGID = WORD;

@foreign
enum COMPARTMENT_ID {
    UNSPECIFIED_COMPARTMENT_ID = 0,
    DEFAULT_COMPARTMENT_ID,
}

@foreign
typedef PCOMPARTMENT_ID = COMPARTMENT_ID;

@foreign
struct FLOAT128 {
    LowPart: llong;
    HighPart: llong;
}

@foreign
typedef PFLOAT128 = FLOAT128*;

@foreign
typedef LONGLONG = llong;

@foreign
typedef ULONGLONG = ullong;

@foreign
typedef PLONGLONG = LONGLONG*;

@foreign
typedef PULONGLONG = ULONGLONG*;

@foreign
typedef USN = LONGLONG;

struct LARGE_INTEGER___inner_s {
    LowPart: DWORD;
    HighPart: LONG;
}

@foreign
union LARGE_INTEGER {
    s: LARGE_INTEGER___inner_s;
    u: LARGE_INTEGER___inner_s;
    QuadPart: LONGLONG;
}

@foreign
typedef PLARGE_INTEGER = LARGE_INTEGER*;

struct ULARGE_INTEGER___inner_s {
    LowPart: DWORD;
    HighPart: DWORD;
}

@foreign
union ULARGE_INTEGER {
    s: ULARGE_INTEGER___inner_s;
    u: ULARGE_INTEGER___inner_s;
    QuadPart: ULONGLONG;
}

@foreign
typedef PULARGE_INTEGER = ULARGE_INTEGER*;

@foreign
typedef RTL_REFERENCE_COUNT = LONG_PTR;

@foreign
typedef PRTL_REFERENCE_COUNT = LONG_PTR*;

@foreign
typedef RTL_REFERENCE_COUNT32 = LONG;

@foreign
typedef PRTL_REFERENCE_COUNT32 = LONG*;

@foreign
struct LUID {
    LowPart: DWORD;
    HighPart: LONG;
}

@foreign
typedef PLUID = LUID*;

@foreign
typedef DWORDLONG = ULONGLONG;

@foreign
typedef PDWORDLONG = DWORDLONG*;

@foreign
func _rotl8(Value: uchar, Shift: uchar): uchar;

@foreign
func _rotl16(Value: ushort, Shift: uchar): ushort;

@foreign
func _rotr8(Value: uchar, Shift: uchar): uchar;

@foreign
func _rotr16(Value: ushort, Shift: uchar): ushort;

@foreign
func _rotl(Value: uint, Shift: int): uint;

@foreign
func _rotl64(Value: ullong, Shift: int): ullong;

@foreign
func _rotr(Value: uint, Shift: int): uint;

@foreign
func _rotr64(Value: ullong, Shift: int): ullong;

@foreign
typedef BOOLEAN = BYTE;

@foreign
typedef PBOOLEAN = BOOLEAN*;

@foreign
struct LIST_ENTRY {
    Flink: _LIST_ENTRY*;
    Blink: _LIST_ENTRY*;
}

@foreign
typedef PLIST_ENTRY = LIST_ENTRY*;

@foreign
typedef PRLIST_ENTRY = LIST_ENTRY*;

@foreign
struct SINGLE_LIST_ENTRY {
    Next: _SINGLE_LIST_ENTRY*;
}

@foreign
typedef PSINGLE_LIST_ENTRY = SINGLE_LIST_ENTRY*;

@foreign
struct LIST_ENTRY32 {
    Flink: DWORD;
    Blink: DWORD;
}

@foreign
typedef PLIST_ENTRY32 = LIST_ENTRY32*;

@foreign
struct LIST_ENTRY64 {
    Flink: ULONGLONG;
    Blink: ULONGLONG;
}

@foreign
typedef PLIST_ENTRY64 = LIST_ENTRY64*;

@foreign
typedef EXCEPTION_ROUTINE = func(ExceptionRecord: _EXCEPTION_RECORD*, EstablisherFrame: PVOID, ContextRecord: CONTEXT*, DispatcherContext: PVOID): EXCEPTION_DISPOSITION;

@foreign
typedef PEXCEPTION_ROUTINE = EXCEPTION_ROUTINE*;

@foreign
typedef KSPIN_LOCK = ULONG_PTR;

@foreign
typedef PKSPIN_LOCK = KSPIN_LOCK*;

@foreign
struct M128A {
    Low: ULONGLONG;
    High: LONGLONG;
}

@foreign
typedef PM128A = M128A*;

@foreign
struct XSAVE_FORMAT {
    ControlWord: WORD;
    StatusWord: WORD;
    TagWord: BYTE;
    Reserved1: BYTE;
    ErrorOpcode: WORD;
    ErrorOffset: DWORD;
    ErrorSelector: WORD;
    Reserved2: WORD;
    DataOffset: DWORD;
    DataSelector: WORD;
    Reserved3: WORD;
    MxCsr: DWORD;
    MxCsr_Mask: DWORD;
    FloatRegisters: M128A[8];
    XmmRegisters: M128A[16];
    Reserved4: BYTE[96];
}

@foreign
typedef PXSAVE_FORMAT = XSAVE_FORMAT*;

@foreign
struct XSAVE_AREA_HEADER {
    Mask: DWORD64;
    CompactionMask: DWORD64;
    Reserved2: DWORD64[6];
}

@foreign
typedef PXSAVE_AREA_HEADER = XSAVE_AREA_HEADER*;

@foreign
struct XSAVE_AREA {
    LegacyState: XSAVE_FORMAT;
    Header: XSAVE_AREA_HEADER;
}

@foreign
typedef PXSAVE_AREA = XSAVE_AREA*;

@foreign
struct XSTATE_CONTEXT {
    Mask: DWORD64;
    Length: DWORD;
    Reserved1: DWORD;
    Area: PXSAVE_AREA;
    Buffer: PVOID;
}

@foreign
typedef PXSTATE_CONTEXT = XSTATE_CONTEXT*;

@foreign
struct SCOPE_TABLE_AMD64 {
    Count: DWORD;
    ScopeRecord: (null)[1];
}

@foreign
typedef PSCOPE_TABLE_AMD64 = SCOPE_TABLE_AMD64*;

@foreign
func _bittest(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _bittestandcomplement(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _bittestandset(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _bittestandreset(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _interlockedbittestandset(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _interlockedbittestandreset(Base: LONG*, Offset: LONG): BOOLEAN;

@foreign
func _bittest64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _bittestandcomplement64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _bittestandset64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _bittestandreset64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _interlockedbittestandset64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _interlockedbittestandreset64(Base: LONG64*, Offset: LONG64): BOOLEAN;

@foreign
func _BitScanForward(Index: DWORD*, Mask: DWORD): BOOLEAN;

@foreign
func _BitScanReverse(Index: DWORD*, Mask: DWORD): BOOLEAN;

@foreign
func _BitScanForward64(Index: DWORD*, Mask: DWORD64): BOOLEAN;

@foreign
func _BitScanReverse64(Index: DWORD*, Mask: DWORD64): BOOLEAN;

@foreign
func _InterlockedIncrement16(Addend: SHORT*): SHORT;

@foreign
func _InterlockedDecrement16(Addend: SHORT*): SHORT;

@foreign
func _InterlockedCompareExchange16(Destination: SHORT*, ExChange: SHORT, Comperand: SHORT): SHORT;

@foreign
func _InterlockedAnd(Destination: LONG*, Value: LONG): LONG;

@foreign
func _InterlockedOr(Destination: LONG*, Value: LONG): LONG;

@foreign
func _InterlockedXor(Destination: LONG*, Value: LONG): LONG;

@foreign
func _InterlockedAnd64(Destination: LONG64*, Value: LONG64): LONG64;

@foreign
func _InterlockedOr64(Destination: LONG64*, Value: LONG64): LONG64;

@foreign
func _InterlockedXor64(Destination: LONG64*, Value: LONG64): LONG64;

@foreign
func _InterlockedIncrement(Addend: LONG*): LONG;

@foreign
func _InterlockedDecrement(Addend: LONG*): LONG;

@foreign
func _InterlockedExchange(Target: LONG*, Value: LONG): LONG;

@foreign
func _InterlockedExchangeAdd(Addend: LONG*, Value: LONG): LONG;

@foreign
func _InterlockedCompareExchange(Destination: LONG*, ExChange: LONG, Comperand: LONG): LONG;

@foreign
func _InterlockedIncrement64(Addend: LONG64*): LONG64;

@foreign
func _InterlockedDecrement64(Addend: LONG64*): LONG64;

@foreign
func _InterlockedExchange64(Target: LONG64*, Value: LONG64): LONG64;

@foreign
func _InterlockedExchangeAdd64(Addend: LONG64*, Value: LONG64): LONG64;

@foreign
func _InterlockedCompareExchange64(Destination: LONG64*, ExChange: LONG64, Comperand: LONG64): LONG64;

@foreign
func _InterlockedCompareExchange128(Destination: LONG64*, ExchangeHigh: LONG64, ExchangeLow: LONG64, ComparandResult: LONG64*): BOOLEAN;

@foreign
func _InterlockedCompareExchangePointer(Destination: PVOID*, Exchange: PVOID, Comperand: PVOID): PVOID;

@foreign
func _InterlockedExchangePointer(Target: PVOID*, Value: PVOID): PVOID;

@foreign
func _InterlockedExchange8(Target: CHAR*, Value: CHAR): CHAR;

@foreign
func _InterlockedExchange16(Destination: SHORT*, ExChange: SHORT): SHORT;

@foreign
func _InterlockedExchangeAdd8(_Addend: char*, _Value: char): char;

@foreign
func _InterlockedAnd8(Destination: char*, Value: char): char;

@foreign
func _InterlockedOr8(Destination: char*, Value: char): char;

@foreign
func _InterlockedXor8(Destination: char*, Value: char): char;

@foreign
func _InterlockedAnd16(Destination: SHORT*, Value: SHORT): SHORT;

@foreign
func _InterlockedOr16(Destination: SHORT*, Value: SHORT): SHORT;

@foreign
func _InterlockedXor16(Destination: SHORT*, Value: SHORT): SHORT;

@foreign
func __cpuidex(CPUInfo: int*, Function: int, SubLeaf: int);

@foreign
func _mm_clflush(Address: void const*);

@foreign
func _ReadWriteBarrier();

@foreign
func __faststorefence();

@foreign
func _mm_lfence();

@foreign
func _mm_mfence();

@foreign
func _mm_sfence();

@foreign
func _mm_pause();

@foreign
func _mm_prefetch(a: CHAR*, sel: int);

@foreign
func _m_prefetchw(Source: void const*);

@foreign
func _mm_getcsr(): uint;

@foreign
func _mm_setcsr(MxCsr: uint);

@foreign
func __getcallerseflags(): uint;

@foreign
func __segmentlimit(Selector: DWORD): DWORD;

@foreign
func __readpmc(Counter: DWORD): DWORD64;

@foreign
func __rdtsc(): DWORD64;

@foreign
func __movsb(Destination: PBYTE, Source: BYTE*, Count: SIZE_T);

@foreign
func __movsw(Destination: PWORD, Source: WORD*, Count: SIZE_T);

@foreign
func __movsd(Destination: PDWORD, Source: DWORD*, Count: SIZE_T);

@foreign
func __movsq(Destination: PDWORD64, Source: DWORD64*, Count: SIZE_T);

@foreign
func __stosb(Destination: PBYTE, Value: BYTE, Count: SIZE_T);

@foreign
func __stosw(Destination: PWORD, Value: WORD, Count: SIZE_T);

@foreign
func __stosd(Destination: PDWORD, Value: DWORD, Count: SIZE_T);

@foreign
func __stosq(Destination: PDWORD64, Value: DWORD64, Count: SIZE_T);

@foreign
func __mulh(Multiplier: LONG64, Multiplicand: LONG64): LONGLONG;

@foreign
func __umulh(Multiplier: DWORD64, Multiplicand: DWORD64): ULONGLONG;

@foreign
func __popcnt64(operand: DWORD64): DWORD64;

@foreign
func __shiftleft128(LowPart: DWORD64, HighPart: DWORD64, Shift: BYTE): DWORD64;

@foreign
func __shiftright128(LowPart: DWORD64, HighPart: DWORD64, Shift: BYTE): DWORD64;

@foreign
func _mul128(Multiplier: LONG64, Multiplicand: LONG64, HighProduct: LONG64*): LONG64;

@foreign
func _umul128(Multiplier: DWORD64, Multiplicand: DWORD64, HighProduct: DWORD64*): DWORD64;

@foreign
func __readgsbyte(Offset: DWORD): BYTE;

@foreign
func __readgsword(Offset: DWORD): WORD;

@foreign
func __readgsdword(Offset: DWORD): DWORD;

@foreign
func __readgsqword(Offset: DWORD): DWORD64;

@foreign
func __writegsbyte(Offset: DWORD, Data: BYTE);

@foreign
func __writegsword(Offset: DWORD, Data: WORD);

@foreign
func __writegsdword(Offset: DWORD, Data: DWORD);

@foreign
func __writegsqword(Offset: DWORD, Data: DWORD64);

@foreign
func __incgsbyte(Offset: DWORD);

@foreign
func __addgsbyte(Offset: DWORD, Value: BYTE);

@foreign
func __incgsword(Offset: DWORD);

@foreign
func __addgsword(Offset: DWORD, Value: WORD);

@foreign
func __incgsdword(Offset: DWORD);

@foreign
func __addgsdword(Offset: DWORD, Value: DWORD);

@foreign
func __incgsqword(Offset: DWORD);

@foreign
func __addgsqword(Offset: DWORD, Value: DWORD64);

@foreign
typedef XMM_SAVE_AREA32 = XSAVE_FORMAT;

@foreign
typedef PXMM_SAVE_AREA32 = XSAVE_FORMAT*;

struct CONTEXT___inner_s {
    Header: M128A[2];
    Legacy: M128A[8];
    Xmm0: M128A;
    Xmm1: M128A;
    Xmm2: M128A;
    Xmm3: M128A;
    Xmm4: M128A;
    Xmm5: M128A;
    Xmm6: M128A;
    Xmm7: M128A;
    Xmm8: M128A;
    Xmm9: M128A;
    Xmm10: M128A;
    Xmm11: M128A;
    Xmm12: M128A;
    Xmm13: M128A;
    Xmm14: M128A;
    Xmm15: M128A;
}

union CONTEXT___inner_u {
    FltSave: XMM_SAVE_AREA32;
    s: CONTEXT___inner_s;
}

@foreign
struct CONTEXT {
    P1Home: DWORD64;
    P2Home: DWORD64;
    P3Home: DWORD64;
    P4Home: DWORD64;
    P5Home: DWORD64;
    P6Home: DWORD64;
    ContextFlags: DWORD;
    MxCsr: DWORD;
    SegCs: WORD;
    SegDs: WORD;
    SegEs: WORD;
    SegFs: WORD;
    SegGs: WORD;
    SegSs: WORD;
    EFlags: DWORD;
    Dr0: DWORD64;
    Dr1: DWORD64;
    Dr2: DWORD64;
    Dr3: DWORD64;
    Dr6: DWORD64;
    Dr7: DWORD64;
    Rax: DWORD64;
    Rcx: DWORD64;
    Rdx: DWORD64;
    Rbx: DWORD64;
    Rsp: DWORD64;
    Rbp: DWORD64;
    Rsi: DWORD64;
    Rdi: DWORD64;
    R8: DWORD64;
    R9: DWORD64;
    R10: DWORD64;
    R11: DWORD64;
    R12: DWORD64;
    R13: DWORD64;
    R14: DWORD64;
    R15: DWORD64;
    Rip: DWORD64;
    u: CONTEXT___inner_u;
    VectorRegister: M128A[26];
    VectorControl: DWORD64;
    DebugControl: DWORD64;
    LastBranchToRip: DWORD64;
    LastBranchFromRip: DWORD64;
    LastExceptionToRip: DWORD64;
    LastExceptionFromRip: DWORD64;
}

@foreign
typedef PCONTEXT = CONTEXT*;

@foreign
typedef RUNTIME_FUNCTION = _IMAGE_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef PRUNTIME_FUNCTION = _IMAGE_RUNTIME_FUNCTION_ENTRY*;

@foreign
typedef SCOPE_TABLE = SCOPE_TABLE_AMD64;

@foreign
typedef PSCOPE_TABLE = SCOPE_TABLE_AMD64*;

@foreign
struct UNWIND_HISTORY_TABLE_ENTRY {
    ImageBase: DWORD64;
    FunctionEntry: PRUNTIME_FUNCTION;
}

@foreign
typedef PUNWIND_HISTORY_TABLE_ENTRY = UNWIND_HISTORY_TABLE_ENTRY*;

@foreign
struct UNWIND_HISTORY_TABLE {
    Count: DWORD;
    LocalHint: BYTE;
    GlobalHint: BYTE;
    Search: BYTE;
    Once: BYTE;
    LowAddress: DWORD64;
    HighAddress: DWORD64;
    Entry: UNWIND_HISTORY_TABLE_ENTRY[12];
}

@foreign
typedef PUNWIND_HISTORY_TABLE = UNWIND_HISTORY_TABLE*;

@foreign
typedef GET_RUNTIME_FUNCTION_CALLBACK = func(ControlPc: DWORD64, Context: PVOID): PRUNTIME_FUNCTION;

@foreign
typedef PGET_RUNTIME_FUNCTION_CALLBACK = GET_RUNTIME_FUNCTION_CALLBACK*;

@foreign
typedef OUT_OF_PROCESS_FUNCTION_TABLE_CALLBACK = func(Process: HANDLE, TableAddress: PVOID, Entries: PDWORD, Functions: PRUNTIME_FUNCTION*): DWORD;

@foreign
typedef POUT_OF_PROCESS_FUNCTION_TABLE_CALLBACK = OUT_OF_PROCESS_FUNCTION_TABLE_CALLBACK*;

@foreign
struct DISPATCHER_CONTEXT {
    ControlPc: DWORD64;
    ImageBase: DWORD64;
    FunctionEntry: PRUNTIME_FUNCTION;
    EstablisherFrame: DWORD64;
    TargetIp: DWORD64;
    ContextRecord: PCONTEXT;
    LanguageHandler: PEXCEPTION_ROUTINE;
    HandlerData: PVOID;
    HistoryTable: PUNWIND_HISTORY_TABLE;
    ScopeIndex: DWORD;
    Fill0: DWORD;
}

@foreign
typedef PDISPATCHER_CONTEXT = DISPATCHER_CONTEXT*;

@foreign
typedef PEXCEPTION_FILTER = func(ExceptionPointers: EXCEPTION_POINTERS*, EstablisherFrame: PVOID): LONG;

@foreign
typedef PTERMINATION_HANDLER = func(_abnormal_termination: BOOLEAN, EstablisherFrame: PVOID);

struct KNONVOLATILE_CONTEXT_POINTERS___inner_s1 {
    Xmm0: PM128A;
    Xmm1: PM128A;
    Xmm2: PM128A;
    Xmm3: PM128A;
    Xmm4: PM128A;
    Xmm5: PM128A;
    Xmm6: PM128A;
    Xmm7: PM128A;
    Xmm8: PM128A;
    Xmm9: PM128A;
    Xmm10: PM128A;
    Xmm11: PM128A;
    Xmm12: PM128A;
    Xmm13: PM128A;
    Xmm14: PM128A;
    Xmm15: PM128A;
}

struct KNONVOLATILE_CONTEXT_POINTERS___inner_s2 {
    Rax: PDWORD64;
    Rcx: PDWORD64;
    Rdx: PDWORD64;
    Rbx: PDWORD64;
    Rsp: PDWORD64;
    Rbp: PDWORD64;
    Rsi: PDWORD64;
    Rdi: PDWORD64;
    R8: PDWORD64;
    R9: PDWORD64;
    R10: PDWORD64;
    R11: PDWORD64;
    R12: PDWORD64;
    R13: PDWORD64;
    R14: PDWORD64;
    R15: PDWORD64;
}

union KNONVOLATILE_CONTEXT_POINTERS___inner_u1 {
    FloatingContext: PM128A[16];
    s: KNONVOLATILE_CONTEXT_POINTERS___inner_s1;
}

union KNONVOLATILE_CONTEXT_POINTERS___inner_u2 {
    IntegerContext: PDWORD64[16];
    s: KNONVOLATILE_CONTEXT_POINTERS___inner_s2;
}

@foreign
struct KNONVOLATILE_CONTEXT_POINTERS {
    u: KNONVOLATILE_CONTEXT_POINTERS___inner_u1;
    u2: KNONVOLATILE_CONTEXT_POINTERS___inner_u2;
}

@foreign
typedef PKNONVOLATILE_CONTEXT_POINTERS = KNONVOLATILE_CONTEXT_POINTERS*;

struct SCOPE_TABLE_ARM___inner {
    BeginAddress: DWORD;
    EndAddress: DWORD;
    HandlerAddress: DWORD;
    JumpTarget: DWORD;
}

@foreign
struct SCOPE_TABLE_ARM {
    Count: DWORD;
    ScopeRecord: SCOPE_TABLE_ARM___inner[1];
}

@foreign
typedef PSCOPE_TABLE_ARM = SCOPE_TABLE_ARM*;

struct SCOPE_TABLE_ARM64___inner {
    BeginAddress: DWORD;
    EndAddress: DWORD;
    HandlerAddress: DWORD;
    JumpTarget: DWORD;
}

@foreign
struct SCOPE_TABLE_ARM64 {
    Count: DWORD;
    ScopeRecord: SCOPE_TABLE_ARM64___inner[1];
}

@foreign
typedef PSCOPE_TABLE_ARM64 = SCOPE_TABLE_ARM64*;

@foreign
struct KNONVOLATILE_CONTEXT_POINTERS_ARM64 {
    X19: PDWORD64;
    X20: PDWORD64;
    X21: PDWORD64;
    X22: PDWORD64;
    X23: PDWORD64;
    X24: PDWORD64;
    X25: PDWORD64;
    X26: PDWORD64;
    X27: PDWORD64;
    X28: PDWORD64;
    Fp: PDWORD64;
    Lr: PDWORD64;
    D8: PDWORD64;
    D9: PDWORD64;
    D10: PDWORD64;
    D11: PDWORD64;
    D12: PDWORD64;
    D13: PDWORD64;
    D14: PDWORD64;
    D15: PDWORD64;
}

@foreign
typedef PKNONVOLATILE_CONTEXT_POINTERS_ARM64 = KNONVOLATILE_CONTEXT_POINTERS_ARM64*;

@foreign
func __int2c();

// @PROBLEM bitfields
@foreign
struct LDT_ENTRY;

@foreign
typedef PLDT_ENTRY = LDT_ENTRY*;

@foreign
struct WOW64_FLOATING_SAVE_AREA {
    ControlWord: DWORD;
    StatusWord: DWORD;
    TagWord: DWORD;
    ErrorOffset: DWORD;
    ErrorSelector: DWORD;
    DataOffset: DWORD;
    DataSelector: DWORD;
    RegisterArea: BYTE[80];
    Cr0NpxState: DWORD;
}

@foreign
typedef PWOW64_FLOATING_SAVE_AREA = WOW64_FLOATING_SAVE_AREA*;

@foreign
struct WOW64_CONTEXT {
    ContextFlags: DWORD;
    Dr0: DWORD;
    Dr1: DWORD;
    Dr2: DWORD;
    Dr3: DWORD;
    Dr6: DWORD;
    Dr7: DWORD;
    FloatSave: WOW64_FLOATING_SAVE_AREA;
    SegGs: DWORD;
    SegFs: DWORD;
    SegEs: DWORD;
    SegDs: DWORD;
    Edi: DWORD;
    Esi: DWORD;
    Ebx: DWORD;
    Edx: DWORD;
    Ecx: DWORD;
    Eax: DWORD;
    Ebp: DWORD;
    Eip: DWORD;
    SegCs: DWORD;
    EFlags: DWORD;
    Esp: DWORD;
    SegSs: DWORD;
    ExtendedRegisters: BYTE[512];
}

@foreign
typedef PWOW64_CONTEXT = WOW64_CONTEXT*;

// @PROBLEM bitfields
@foreign
struct WOW64_LDT_ENTRY;

@foreign
typedef PWOW64_LDT_ENTRY = WOW64_LDT_ENTRY*;

@foreign
struct WOW64_DESCRIPTOR_TABLE_ENTRY {
    Selector: DWORD;
    Descriptor: WOW64_LDT_ENTRY;
}

@foreign
typedef PWOW64_DESCRIPTOR_TABLE_ENTRY = WOW64_DESCRIPTOR_TABLE_ENTRY*;

@foreign
struct EXCEPTION_RECORD {
    ExceptionCode: DWORD;
    ExceptionFlags: DWORD;
    ExceptionRecord: _EXCEPTION_RECORD*;
    ExceptionAddress: PVOID;
    NumberParameters: DWORD;
    ExceptionInformation: ULONG_PTR[15];
}

@foreign
typedef _EXCEPTION_RECORD = EXCEPTION_RECORD;

@foreign
typedef PEXCEPTION_RECORD = EXCEPTION_RECORD*;

@foreign
struct EXCEPTION_RECORD32 {
    ExceptionCode: DWORD;
    ExceptionFlags: DWORD;
    ExceptionRecord: DWORD;
    ExceptionAddress: DWORD;
    NumberParameters: DWORD;
    ExceptionInformation: DWORD[15];
}

@foreign
typedef PEXCEPTION_RECORD32 = EXCEPTION_RECORD32*;

@foreign
struct EXCEPTION_RECORD64 {
    ExceptionCode: DWORD;
    ExceptionFlags: DWORD;
    ExceptionRecord: DWORD64;
    ExceptionAddress: DWORD64;
    NumberParameters: DWORD;
    __unusedAlignment: DWORD;
    ExceptionInformation: DWORD64[15];
}

@foreign
typedef PEXCEPTION_RECORD64 = EXCEPTION_RECORD64*;

@foreign
struct EXCEPTION_POINTERS {
    ExceptionRecord: PEXCEPTION_RECORD;
    ContextRecord: PCONTEXT;
}

@foreign
typedef PEXCEPTION_POINTERS = EXCEPTION_POINTERS*;

@foreign
typedef PACCESS_TOKEN = PVOID;

@foreign
typedef PSECURITY_DESCRIPTOR = PVOID;

@foreign
typedef PSID = PVOID;

@foreign
typedef PCLAIMS_BLOB = PVOID;

@foreign
typedef ACCESS_MASK = DWORD;

@foreign
typedef PACCESS_MASK = ACCESS_MASK*;

@foreign
struct GENERIC_MAPPING {
    GenericRead: ACCESS_MASK;
    GenericWrite: ACCESS_MASK;
    GenericExecute: ACCESS_MASK;
    GenericAll: ACCESS_MASK;
}

@foreign
typedef PGENERIC_MAPPING = GENERIC_MAPPING*;

@foreign
struct LUID_AND_ATTRIBUTES {
    Luid: LUID;
    Attributes: DWORD;
}

@foreign
typedef PLUID_AND_ATTRIBUTES = LUID_AND_ATTRIBUTES*;

@foreign
typedef LUID_AND_ATTRIBUTES_ARRAY = LUID_AND_ATTRIBUTES[1];

@foreign
typedef PLUID_AND_ATTRIBUTES_ARRAY = LUID_AND_ATTRIBUTES_ARRAY*;

@foreign
struct SID_IDENTIFIER_AUTHORITY {
    Value: BYTE[6];
}

@foreign
typedef PSID_IDENTIFIER_AUTHORITY = SID_IDENTIFIER_AUTHORITY*;

@foreign
struct SID {
    Revision: BYTE;
    SubAuthorityCount: BYTE;
    IdentifierAuthority: SID_IDENTIFIER_AUTHORITY;
    SubAuthority: DWORD[1];
}

@foreign
typedef PISID = SID*;

@foreign
union SE_SID {
    Sid: SID;
    Buffer: BYTE[68];
}

@foreign
typedef PSE_SID = SE_SID*;

@foreign
enum SID_NAME_USE {
    SidTypeUser = 1,
    SidTypeGroup,
    SidTypeDomain,
    SidTypeAlias,
    SidTypeWellKnownGroup,
    SidTypeDeletedAccount,
    SidTypeInvalid,
    SidTypeUnknown,
    SidTypeComputer,
    SidTypeLabel,
    SidTypeLogonSession,
}

@foreign
typedef PSID_NAME_USE = SID_NAME_USE*;

@foreign
struct SID_AND_ATTRIBUTES {
    Sid: PSID;
    Attributes: DWORD;
}

@foreign
typedef PSID_AND_ATTRIBUTES = SID_AND_ATTRIBUTES*;

@foreign
typedef SID_AND_ATTRIBUTES_ARRAY = SID_AND_ATTRIBUTES[1];

@foreign
typedef PSID_AND_ATTRIBUTES_ARRAY = SID_AND_ATTRIBUTES_ARRAY*;

@foreign
typedef SID_HASH_ENTRY = ULONG_PTR;

@foreign
typedef PSID_HASH_ENTRY = ULONG_PTR*;

@foreign
struct SID_AND_ATTRIBUTES_HASH {
    SidCount: DWORD;
    SidAttr: PSID_AND_ATTRIBUTES;
    Hash: SID_HASH_ENTRY[32];
}

@foreign
typedef PSID_AND_ATTRIBUTES_HASH = SID_AND_ATTRIBUTES_HASH*;

@foreign
enum WELL_KNOWN_SID_TYPE {
    WinNullSid = 0,
    WinWorldSid = 1,
    WinLocalSid = 2,
    WinCreatorOwnerSid = 3,
    WinCreatorGroupSid = 4,
    WinCreatorOwnerServerSid = 5,
    WinCreatorGroupServerSid = 6,
    WinNtAuthoritySid = 7,
    WinDialupSid = 8,
    WinNetworkSid = 9,
    WinBatchSid = 10,
    WinInteractiveSid = 11,
    WinServiceSid = 12,
    WinAnonymousSid = 13,
    WinProxySid = 14,
    WinEnterpriseControllersSid = 15,
    WinSelfSid = 16,
    WinAuthenticatedUserSid = 17,
    WinRestrictedCodeSid = 18,
    WinTerminalServerSid = 19,
    WinRemoteLogonIdSid = 20,
    WinLogonIdsSid = 21,
    WinLocalSystemSid = 22,
    WinLocalServiceSid = 23,
    WinNetworkServiceSid = 24,
    WinBuiltinDomainSid = 25,
    WinBuiltinAdministratorsSid = 26,
    WinBuiltinUsersSid = 27,
    WinBuiltinGuestsSid = 28,
    WinBuiltinPowerUsersSid = 29,
    WinBuiltinAccountOperatorsSid = 30,
    WinBuiltinSystemOperatorsSid = 31,
    WinBuiltinPrintOperatorsSid = 32,
    WinBuiltinBackupOperatorsSid = 33,
    WinBuiltinReplicatorSid = 34,
    WinBuiltinPreWindows2000CompatibleAccessSid = 35,
    WinBuiltinRemoteDesktopUsersSid = 36,
    WinBuiltinNetworkConfigurationOperatorsSid = 37,
    WinAccountAdministratorSid = 38,
    WinAccountGuestSid = 39,
    WinAccountKrbtgtSid = 40,
    WinAccountDomainAdminsSid = 41,
    WinAccountDomainUsersSid = 42,
    WinAccountDomainGuestsSid = 43,
    WinAccountComputersSid = 44,
    WinAccountControllersSid = 45,
    WinAccountCertAdminsSid = 46,
    WinAccountSchemaAdminsSid = 47,
    WinAccountEnterpriseAdminsSid = 48,
    WinAccountPolicyAdminsSid = 49,
    WinAccountRasAndIasServersSid = 50,
    WinNTLMAuthenticationSid = 51,
    WinDigestAuthenticationSid = 52,
    WinSChannelAuthenticationSid = 53,
    WinThisOrganizationSid = 54,
    WinOtherOrganizationSid = 55,
    WinBuiltinIncomingForestTrustBuildersSid = 56,
    WinBuiltinPerfMonitoringUsersSid = 57,
    WinBuiltinPerfLoggingUsersSid = 58,
    WinBuiltinAuthorizationAccessSid = 59,
    WinBuiltinTerminalServerLicenseServersSid = 60,
    WinBuiltinDCOMUsersSid = 61,
    WinBuiltinIUsersSid = 62,
    WinIUserSid = 63,
    WinBuiltinCryptoOperatorsSid = 64,
    WinUntrustedLabelSid = 65,
    WinLowLabelSid = 66,
    WinMediumLabelSid = 67,
    WinHighLabelSid = 68,
    WinSystemLabelSid = 69,
    WinWriteRestrictedCodeSid = 70,
    WinCreatorOwnerRightsSid = 71,
    WinCacheablePrincipalsGroupSid = 72,
    WinNonCacheablePrincipalsGroupSid = 73,
    WinEnterpriseReadonlyControllersSid = 74,
    WinAccountReadonlyControllersSid = 75,
    WinBuiltinEventLogReadersGroup = 76,
    WinNewEnterpriseReadonlyControllersSid = 77,
    WinBuiltinCertSvcDComAccessGroup = 78,
    WinMediumPlusLabelSid = 79,
    WinLocalLogonSid = 80,
    WinConsoleLogonSid = 81,
    WinThisOrganizationCertificateSid = 82,
    WinApplicationPackageAuthoritySid = 83,
    WinBuiltinAnyPackageSid = 84,
    WinCapabilityInternetClientSid = 85,
    WinCapabilityInternetClientServerSid = 86,
    WinCapabilityPrivateNetworkClientServerSid = 87,
    WinCapabilityPicturesLibrarySid = 88,
    WinCapabilityVideosLibrarySid = 89,
    WinCapabilityMusicLibrarySid = 90,
    WinCapabilityDocumentsLibrarySid = 91,
    WinCapabilitySharedUserCertificatesSid = 92,
    WinCapabilityEnterpriseAuthenticationSid = 93,
    WinCapabilityRemovableStorageSid = 94,
    WinBuiltinRDSRemoteAccessServersSid = 95,
    WinBuiltinRDSEndpointServersSid = 96,
    WinBuiltinRDSManagementServersSid = 97,
    WinUserModeDriversSid = 98,
    WinBuiltinHyperVAdminsSid = 99,
    WinAccountCloneableControllersSid = 100,
    WinBuiltinAccessControlAssistanceOperatorsSid = 101,
    WinBuiltinRemoteManagementUsersSid = 102,
    WinAuthenticationAuthorityAssertedSid = 103,
    WinAuthenticationServiceAssertedSid = 104,
    WinLocalAccountSid = 105,
    WinLocalAccountAndAdministratorSid = 106,
    WinAccountProtectedUsersSid = 107,
    WinCapabilityAppointmentsSid = 108,
    WinCapabilityContactsSid = 109,
    WinAccountDefaultSystemManagedSid = 110,
    WinBuiltinDefaultSystemManagedGroupSid = 111,
    WinBuiltinStorageReplicaAdminsSid = 112,
    WinAccountKeyAdminsSid = 113,
    WinAccountEnterpriseKeyAdminsSid = 114,
    WinAuthenticationKeyTrustSid = 115,
    WinAuthenticationKeyPropertyMFASid = 116,
    WinAuthenticationKeyPropertyAttestationSid = 117,
    WinAuthenticationFreshKeyAuthSid = 118,
}

@foreign
struct ACL {
    AclRevision: BYTE;
    Sbz1: BYTE;
    AclSize: WORD;
    AceCount: WORD;
    Sbz2: WORD;
}

@foreign
typedef PACL = ACL*;

@foreign
struct ACE_HEADER {
    AceType: BYTE;
    AceFlags: BYTE;
    AceSize: WORD;
}

@foreign
typedef PACE_HEADER = ACE_HEADER*;

@foreign
struct ACCESS_ALLOWED_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_ALLOWED_ACE = ACCESS_ALLOWED_ACE*;

@foreign
struct ACCESS_DENIED_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_DENIED_ACE = ACCESS_DENIED_ACE*;

@foreign
struct SYSTEM_AUDIT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_AUDIT_ACE = SYSTEM_AUDIT_ACE*;

@foreign
struct SYSTEM_ALARM_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_ALARM_ACE = SYSTEM_ALARM_ACE*;

@foreign
struct SYSTEM_RESOURCE_ATTRIBUTE_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_RESOURCE_ATTRIBUTE_ACE = SYSTEM_RESOURCE_ATTRIBUTE_ACE*;

@foreign
struct SYSTEM_SCOPED_POLICY_ID_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_SCOPED_POLICY_ID_ACE = SYSTEM_SCOPED_POLICY_ID_ACE*;

@foreign
struct SYSTEM_MANDATORY_LABEL_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_MANDATORY_LABEL_ACE = SYSTEM_MANDATORY_LABEL_ACE*;

@foreign
struct SYSTEM_PROCESS_TRUST_LABEL_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_PROCESS_TRUST_LABEL_ACE = SYSTEM_PROCESS_TRUST_LABEL_ACE*;

@foreign
struct SYSTEM_ACCESS_FILTER_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_ACCESS_FILTER_ACE = SYSTEM_ACCESS_FILTER_ACE*;

@foreign
struct ACCESS_ALLOWED_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_ALLOWED_OBJECT_ACE = ACCESS_ALLOWED_OBJECT_ACE*;

@foreign
struct ACCESS_DENIED_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_DENIED_OBJECT_ACE = ACCESS_DENIED_OBJECT_ACE*;

@foreign
struct SYSTEM_AUDIT_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_AUDIT_OBJECT_ACE = SYSTEM_AUDIT_OBJECT_ACE*;

@foreign
struct SYSTEM_ALARM_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_ALARM_OBJECT_ACE = SYSTEM_ALARM_OBJECT_ACE*;

@foreign
struct ACCESS_ALLOWED_CALLBACK_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_ALLOWED_CALLBACK_ACE = ACCESS_ALLOWED_CALLBACK_ACE*;

@foreign
struct ACCESS_DENIED_CALLBACK_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_DENIED_CALLBACK_ACE = ACCESS_DENIED_CALLBACK_ACE*;

@foreign
struct SYSTEM_AUDIT_CALLBACK_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_AUDIT_CALLBACK_ACE = SYSTEM_AUDIT_CALLBACK_ACE*;

@foreign
struct SYSTEM_ALARM_CALLBACK_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_ALARM_CALLBACK_ACE = SYSTEM_ALARM_CALLBACK_ACE*;

@foreign
struct ACCESS_ALLOWED_CALLBACK_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_ALLOWED_CALLBACK_OBJECT_ACE = ACCESS_ALLOWED_CALLBACK_OBJECT_ACE*;

@foreign
struct ACCESS_DENIED_CALLBACK_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PACCESS_DENIED_CALLBACK_OBJECT_ACE = ACCESS_DENIED_CALLBACK_OBJECT_ACE*;

@foreign
struct SYSTEM_AUDIT_CALLBACK_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_AUDIT_CALLBACK_OBJECT_ACE = SYSTEM_AUDIT_CALLBACK_OBJECT_ACE*;

@foreign
struct SYSTEM_ALARM_CALLBACK_OBJECT_ACE {
    Header: ACE_HEADER;
    Mask: ACCESS_MASK;
    Flags: DWORD;
    ObjectType: GUID;
    InheritedObjectType: GUID;
    SidStart: DWORD;
}

@foreign
typedef PSYSTEM_ALARM_CALLBACK_OBJECT_ACE = SYSTEM_ALARM_CALLBACK_OBJECT_ACE*;

@foreign
enum ACL_INFORMATION_CLASS {
    AclRevisionInformation = 1,
    AclSizeInformation,
}

@foreign
struct ACL_REVISION_INFORMATION {
    AclRevision: DWORD;
}

@foreign
typedef PACL_REVISION_INFORMATION = ACL_REVISION_INFORMATION*;

@foreign
struct ACL_SIZE_INFORMATION {
    AceCount: DWORD;
    AclBytesInUse: DWORD;
    AclBytesFree: DWORD;
}

@foreign
typedef PACL_SIZE_INFORMATION = ACL_SIZE_INFORMATION*;

@foreign
typedef SECURITY_DESCRIPTOR_CONTROL = WORD;

@foreign
typedef PSECURITY_DESCRIPTOR_CONTROL = WORD*;

@foreign
struct SECURITY_DESCRIPTOR_RELATIVE {
    Revision: BYTE;
    Sbz1: BYTE;
    Control: SECURITY_DESCRIPTOR_CONTROL;
    Owner: DWORD;
    Group: DWORD;
    Sacl: DWORD;
    Dacl: DWORD;
}

@foreign
typedef PISECURITY_DESCRIPTOR_RELATIVE = SECURITY_DESCRIPTOR_RELATIVE*;

@foreign
struct SECURITY_DESCRIPTOR {
    Revision: BYTE;
    Sbz1: BYTE;
    Control: SECURITY_DESCRIPTOR_CONTROL;
    Owner: PSID;
    Group: PSID;
    Sacl: PACL;
    Dacl: PACL;
}

@foreign
typedef PISECURITY_DESCRIPTOR = SECURITY_DESCRIPTOR*;

@foreign
struct SECURITY_OBJECT_AI_PARAMS {
    Size: DWORD;
    ConstraintMask: DWORD;
}

@foreign
typedef PSECURITY_OBJECT_AI_PARAMS = SECURITY_OBJECT_AI_PARAMS*;

@foreign
struct OBJECT_TYPE_LIST {
    Level: WORD;
    Sbz: WORD;
    ObjectType: GUID*;
}

@foreign
typedef POBJECT_TYPE_LIST = OBJECT_TYPE_LIST*;

@foreign
enum AUDIT_EVENT_TYPE {
    AuditEventObjectAccess,
    AuditEventDirectoryServiceAccess,
}

@foreign
typedef PAUDIT_EVENT_TYPE = AUDIT_EVENT_TYPE*;

@foreign
struct PRIVILEGE_SET {
    PrivilegeCount: DWORD;
    Control: DWORD;
    Privilege: LUID_AND_ATTRIBUTES[1];
}

@foreign
typedef PPRIVILEGE_SET = PRIVILEGE_SET*;

@foreign
enum ACCESS_REASON_TYPE {
    AccessReasonNone = 0,
    AccessReasonAllowedAce = 65536,
    AccessReasonDeniedAce = 131072,
    AccessReasonAllowedParentAce = 196608,
    AccessReasonDeniedParentAce = 262144,
    AccessReasonNotGrantedByCape = 327680,
    AccessReasonNotGrantedByParentCape = 393216,
    AccessReasonNotGrantedToAppContainer = 458752,
    AccessReasonMissingPrivilege = 1048576,
    AccessReasonFromPrivilege = 2097152,
    AccessReasonIntegrityLevel = 3145728,
    AccessReasonOwnership = 4194304,
    AccessReasonNullDacl = 5242880,
    AccessReasonEmptyDacl = 6291456,
    AccessReasonNoSD = 7340032,
    AccessReasonNoGrant = 8388608,
    AccessReasonTrustLabel = 9437184,
    AccessReasonFilterAce = 10485760,
}

@foreign
typedef ACCESS_REASON = DWORD;

@foreign
struct ACCESS_REASONS {
    Data: ACCESS_REASON[32];
}

@foreign
typedef PACCESS_REASONS = ACCESS_REASONS*;

@foreign
struct SE_SECURITY_DESCRIPTOR {
    Size: DWORD;
    Flags: DWORD;
    SecurityDescriptor: PSECURITY_DESCRIPTOR;
}

@foreign
typedef PSE_SECURITY_DESCRIPTOR = SE_SECURITY_DESCRIPTOR*;

@foreign
struct SE_ACCESS_REQUEST {
    Size: DWORD;
    SeSecurityDescriptor: PSE_SECURITY_DESCRIPTOR;
    DesiredAccess: ACCESS_MASK;
    PreviouslyGrantedAccess: ACCESS_MASK;
    PrincipalSelfSid: PSID;
    GenericMapping: PGENERIC_MAPPING;
    ObjectTypeListCount: DWORD;
    ObjectTypeList: POBJECT_TYPE_LIST;
}

@foreign
typedef PSE_ACCESS_REQUEST = SE_ACCESS_REQUEST*;

@foreign
struct SE_ACCESS_REPLY {
    Size: DWORD;
    ResultListCount: DWORD;
    GrantedAccess: PACCESS_MASK;
    AccessStatus: PDWORD;
    AccessReason: PACCESS_REASONS;
    Privileges: PPRIVILEGE_SET*;
}

@foreign
typedef PSE_ACCESS_REPLY = SE_ACCESS_REPLY*;

@foreign
enum SECURITY_IMPERSONATION_LEVEL {
    SecurityAnonymous,
    SecurityIdentification,
    SecurityImpersonation,
    SecurityDelegation,
}

@foreign
typedef PSECURITY_IMPERSONATION_LEVEL = SECURITY_IMPERSONATION_LEVEL*;

@foreign
enum TOKEN_TYPE {
    TokenPrimary = 1,
    TokenImpersonation,
}

@foreign
typedef PTOKEN_TYPE = TOKEN_TYPE*;

@foreign
enum TOKEN_ELEVATION_TYPE {
    TokenElevationTypeDefault = 1,
    TokenElevationTypeFull,
    TokenElevationTypeLimited,
}

@foreign
typedef PTOKEN_ELEVATION_TYPE = TOKEN_ELEVATION_TYPE*;

@foreign
enum TOKEN_INFORMATION_CLASS {
    TokenUser = 1,
    TokenGroups,
    TokenPrivileges,
    TokenOwner,
    TokenPrimaryGroup,
    TokenDefaultDacl,
    TokenSource,
    TokenType,
    TokenImpersonationLevel,
    TokenStatistics,
    TokenRestrictedSids,
    TokenSessionId,
    TokenGroupsAndPrivileges,
    TokenSessionReference,
    TokenSandBoxInert,
    TokenAuditPolicy,
    TokenOrigin,
    TokenElevationType,
    TokenLinkedToken,
    TokenElevation,
    TokenHasRestrictions,
    TokenAccessInformation,
    TokenVirtualizationAllowed,
    TokenVirtualizationEnabled,
    TokenIntegrityLevel,
    TokenUIAccess,
    TokenMandatoryPolicy,
    TokenLogonSid,
    TokenIsAppContainer,
    TokenCapabilities,
    TokenAppContainerSid,
    TokenAppContainerNumber,
    TokenUserClaimAttributes,
    TokenDeviceClaimAttributes,
    TokenRestrictedUserClaimAttributes,
    TokenRestrictedDeviceClaimAttributes,
    TokenDeviceGroups,
    TokenRestrictedDeviceGroups,
    TokenSecurityAttributes,
    TokenIsRestricted,
    TokenProcessTrustLevel,
    TokenPrivateNameSpace,
    TokenSingletonAttributes,
    TokenBnoIsolation,
    TokenChildProcessFlags,
    MaxTokenInfoClass,
}

@foreign
typedef PTOKEN_INFORMATION_CLASS = TOKEN_INFORMATION_CLASS*;

@foreign
struct TOKEN_USER {
    User: SID_AND_ATTRIBUTES;
}

@foreign
typedef PTOKEN_USER = TOKEN_USER*;

union _SE_TOKEN_USER___inner_u1 {
    TokenUser: TOKEN_USER;
    User: SID_AND_ATTRIBUTES;
}

union _SE_TOKEN_USER___inner_u2 {
    Sid: SID;
    Buffer: BYTE[68];
}

@foreign
struct _SE_TOKEN_USER {
    u: _SE_TOKEN_USER___inner_u1;
    u2: _SE_TOKEN_USER___inner_u2;
}

@foreign
typedef SE_TOKEN_USER = _SE_TOKEN_USER;

@foreign
typedef PSE_TOKEN_USER = _SE_TOKEN_USER;

@foreign
struct TOKEN_GROUPS {
    GroupCount: DWORD;
    Groups: SID_AND_ATTRIBUTES[1];
}

@foreign
typedef PTOKEN_GROUPS = TOKEN_GROUPS*;

@foreign
struct TOKEN_PRIVILEGES {
    PrivilegeCount: DWORD;
    Privileges: LUID_AND_ATTRIBUTES[1];
}

@foreign
typedef PTOKEN_PRIVILEGES = TOKEN_PRIVILEGES*;

@foreign
struct TOKEN_OWNER {
    Owner: PSID;
}

@foreign
typedef PTOKEN_OWNER = TOKEN_OWNER*;

@foreign
struct TOKEN_PRIMARY_GROUP {
    PrimaryGroup: PSID;
}

@foreign
typedef PTOKEN_PRIMARY_GROUP = TOKEN_PRIMARY_GROUP*;

@foreign
struct TOKEN_DEFAULT_DACL {
    DefaultDacl: PACL;
}

@foreign
typedef PTOKEN_DEFAULT_DACL = TOKEN_DEFAULT_DACL*;

@foreign
struct TOKEN_USER_CLAIMS {
    UserClaims: PCLAIMS_BLOB;
}

@foreign
typedef PTOKEN_USER_CLAIMS = TOKEN_USER_CLAIMS*;

@foreign
struct TOKEN_DEVICE_CLAIMS {
    DeviceClaims: PCLAIMS_BLOB;
}

@foreign
typedef PTOKEN_DEVICE_CLAIMS = TOKEN_DEVICE_CLAIMS*;

@foreign
struct TOKEN_GROUPS_AND_PRIVILEGES {
    SidCount: DWORD;
    SidLength: DWORD;
    Sids: PSID_AND_ATTRIBUTES;
    RestrictedSidCount: DWORD;
    RestrictedSidLength: DWORD;
    RestrictedSids: PSID_AND_ATTRIBUTES;
    PrivilegeCount: DWORD;
    PrivilegeLength: DWORD;
    Privileges: PLUID_AND_ATTRIBUTES;
    AuthenticationId: LUID;
}

@foreign
typedef PTOKEN_GROUPS_AND_PRIVILEGES = TOKEN_GROUPS_AND_PRIVILEGES*;

@foreign
struct TOKEN_LINKED_TOKEN {
    LinkedToken: HANDLE;
}

@foreign
typedef PTOKEN_LINKED_TOKEN = TOKEN_LINKED_TOKEN*;

@foreign
struct TOKEN_ELEVATION {
    TokenIsElevated: DWORD;
}

@foreign
typedef PTOKEN_ELEVATION = TOKEN_ELEVATION*;

@foreign
struct TOKEN_MANDATORY_LABEL {
    Label: SID_AND_ATTRIBUTES;
}

@foreign
typedef PTOKEN_MANDATORY_LABEL = TOKEN_MANDATORY_LABEL*;

@foreign
struct TOKEN_MANDATORY_POLICY {
    Policy: DWORD;
}

@foreign
typedef PTOKEN_MANDATORY_POLICY = TOKEN_MANDATORY_POLICY*;

@foreign
typedef PSECURITY_ATTRIBUTES_OPAQUE = PVOID;

@foreign
struct TOKEN_ACCESS_INFORMATION {
    SidHash: PSID_AND_ATTRIBUTES_HASH;
    RestrictedSidHash: PSID_AND_ATTRIBUTES_HASH;
    Privileges: PTOKEN_PRIVILEGES;
    AuthenticationId: LUID;
    TokenType: TOKEN_TYPE;
    ImpersonationLevel: SECURITY_IMPERSONATION_LEVEL;
    MandatoryPolicy: TOKEN_MANDATORY_POLICY;
    Flags: DWORD;
    AppContainerNumber: DWORD;
    PackageSid: PSID;
    CapabilitiesHash: PSID_AND_ATTRIBUTES_HASH;
    TrustLevelSid: PSID;
    SecurityAttributes: PSECURITY_ATTRIBUTES_OPAQUE;
}

@foreign
typedef PTOKEN_ACCESS_INFORMATION = TOKEN_ACCESS_INFORMATION*;

@foreign
struct TOKEN_AUDIT_POLICY {
    PerUserPolicy: BYTE[30];
}

@foreign
typedef PTOKEN_AUDIT_POLICY = TOKEN_AUDIT_POLICY*;

@foreign
struct TOKEN_SOURCE {
    SourceName: CHAR[8];
    SourceIdentifier: LUID;
}

@foreign
typedef PTOKEN_SOURCE = TOKEN_SOURCE*;

@foreign
struct TOKEN_STATISTICS {
    TokenId: LUID;
    AuthenticationId: LUID;
    ExpirationTime: LARGE_INTEGER;
    TokenType: TOKEN_TYPE;
    ImpersonationLevel: SECURITY_IMPERSONATION_LEVEL;
    DynamicCharged: DWORD;
    DynamicAvailable: DWORD;
    GroupCount: DWORD;
    PrivilegeCount: DWORD;
    ModifiedId: LUID;
}

@foreign
typedef PTOKEN_STATISTICS = TOKEN_STATISTICS*;

@foreign
struct TOKEN_CONTROL {
    TokenId: LUID;
    AuthenticationId: LUID;
    ModifiedId: LUID;
    TokenSource: TOKEN_SOURCE;
}

@foreign
typedef PTOKEN_CONTROL = TOKEN_CONTROL*;

@foreign
struct TOKEN_ORIGIN {
    OriginatingLogonSession: LUID;
}

@foreign
typedef PTOKEN_ORIGIN = TOKEN_ORIGIN*;

@foreign
enum MANDATORY_LEVEL {
    MandatoryLevelUntrusted = 0,
    MandatoryLevelLow,
    MandatoryLevelMedium,
    MandatoryLevelHigh,
    MandatoryLevelSystem,
    MandatoryLevelSecureProcess,
    MandatoryLevelCount,
}

@foreign
typedef PMANDATORY_LEVEL = MANDATORY_LEVEL*;

@foreign
struct TOKEN_APPCONTAINER_INFORMATION {
    TokenAppContainer: PSID;
}

@foreign
typedef PTOKEN_APPCONTAINER_INFORMATION = TOKEN_APPCONTAINER_INFORMATION*;

@foreign
struct TOKEN_SID_INFORMATION {
    Sid: PSID;
}

@foreign
typedef PTOKEN_SID_INFORMATION = TOKEN_SID_INFORMATION*;

@foreign
struct TOKEN_BNO_ISOLATION_INFORMATION {
    IsolationPrefix: PWSTR;
    IsolationEnabled: BOOLEAN;
}

@foreign
typedef PTOKEN_BNO_ISOLATION_INFORMATION = TOKEN_BNO_ISOLATION_INFORMATION*;

@foreign
struct CLAIM_SECURITY_ATTRIBUTE_FQBN_VALUE {
    Version: DWORD64;
    Name: PWSTR;
}

@foreign
typedef PCLAIM_SECURITY_ATTRIBUTE_FQBN_VALUE = CLAIM_SECURITY_ATTRIBUTE_FQBN_VALUE*;

@foreign
struct CLAIM_SECURITY_ATTRIBUTE_OCTET_STRING_VALUE {
    pValue: PVOID;
    ValueLength: DWORD;
}

@foreign
typedef PCLAIM_SECURITY_ATTRIBUTE_OCTET_STRING_VALUE = CLAIM_SECURITY_ATTRIBUTE_OCTET_STRING_VALUE*;

union CLAIM_SECURITY_ATTRIBUTE_V1___inner {
    pInt64: PLONG64;
    pUint64: PDWORD64;
    ppString: PWSTR*;
    pFqbn: PCLAIM_SECURITY_ATTRIBUTE_FQBN_VALUE;
    pOctetString: PCLAIM_SECURITY_ATTRIBUTE_OCTET_STRING_VALUE;
}

@foreign
struct CLAIM_SECURITY_ATTRIBUTE_V1 {
    Name: PWSTR;
    ValueType: WORD;
    Reserved: WORD;
    Flags: DWORD;
    ValueCount: DWORD;
    Values: CLAIM_SECURITY_ATTRIBUTE_V1___inner;
}

@foreign
typedef PCLAIM_SECURITY_ATTRIBUTE_V1 = CLAIM_SECURITY_ATTRIBUTE_V1*;

union CLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1___inner {
    pInt64: DWORD[1];
    pUint64: DWORD[1];
    ppString: DWORD[1];
    pFqbn: DWORD[1];
    pOctetString: DWORD[1];
}

@foreign
struct CLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1 {
    Name: DWORD;
    ValueType: WORD;
    Reserved: WORD;
    Flags: DWORD;
    ValueCount: DWORD;
    Values: CLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1___inner;
}

@foreign
typedef PCLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1 = CLAIM_SECURITY_ATTRIBUTE_RELATIVE_V1*;

union CLAIM_SECURITY_ATTRIBUTES_INFORMATION___inner {
    pAttributeV1: PCLAIM_SECURITY_ATTRIBUTE_V1;
}

@foreign
struct CLAIM_SECURITY_ATTRIBUTES_INFORMATION {
    Version: WORD;
    Reserved: WORD;
    AttributeCount: DWORD;
    Attribute: CLAIM_SECURITY_ATTRIBUTES_INFORMATION___inner;
}

@foreign
typedef PCLAIM_SECURITY_ATTRIBUTES_INFORMATION = CLAIM_SECURITY_ATTRIBUTES_INFORMATION*;

@foreign
typedef SECURITY_CONTEXT_TRACKING_MODE = BOOLEAN;

@foreign
typedef PSECURITY_CONTEXT_TRACKING_MODE = BOOLEAN*;

@foreign
struct _SECURITY_QUALITY_OF_SERVICE {
    Length: DWORD;
    ImpersonationLevel: SECURITY_IMPERSONATION_LEVEL;
    ContextTrackingMode: SECURITY_CONTEXT_TRACKING_MODE;
    EffectiveOnly: BOOLEAN;
}

@foreign
struct SECURITY_QUALITY_OF_SERVICE {
    Length: DWORD;
    ImpersonationLevel: SECURITY_IMPERSONATION_LEVEL;
    ContextTrackingMode: SECURITY_CONTEXT_TRACKING_MODE;
    EffectiveOnly: BOOLEAN;
}

@foreign
typedef PSECURITY_QUALITY_OF_SERVICE = SECURITY_QUALITY_OF_SERVICE*;

@foreign
struct SE_IMPERSONATION_STATE {
    Token: PACCESS_TOKEN;
    CopyOnOpen: BOOLEAN;
    EffectiveOnly: BOOLEAN;
    Level: SECURITY_IMPERSONATION_LEVEL;
}

@foreign
typedef PSE_IMPERSONATION_STATE = SE_IMPERSONATION_STATE*;

@foreign
typedef SECURITY_INFORMATION = DWORD;

@foreign
typedef PSECURITY_INFORMATION = DWORD*;

@foreign
typedef SE_SIGNING_LEVEL = BYTE;

@foreign
typedef PSE_SIGNING_LEVEL = BYTE*;

@foreign
enum SE_IMAGE_SIGNATURE_TYPE {
    SeImageSignatureNone = 0,
    SeImageSignatureEmbedded,
    SeImageSignatureCache,
    SeImageSignatureCatalogCached,
    SeImageSignatureCatalogNotCached,
    SeImageSignatureCatalogHint,
    SeImageSignaturePackageCatalog,
}

@foreign
typedef PSE_IMAGE_SIGNATURE_TYPE = SE_IMAGE_SIGNATURE_TYPE*;

@foreign
enum SE_LEARNING_MODE_DATA_TYPE {
    SeLearningModeInvalidType = 0,
    SeLearningModeSettings,
    SeLearningModeMax,
}

@foreign
struct SECURITY_CAPABILITIES {
    AppContainerSid: PSID;
    Capabilities: PSID_AND_ATTRIBUTES;
    CapabilityCount: DWORD;
    Reserved: DWORD;
}

@foreign
typedef PSECURITY_CAPABILITIES = SECURITY_CAPABILITIES*;

@foreign
typedef LPSECURITY_CAPABILITIES = SECURITY_CAPABILITIES*;

@foreign
struct JOB_SET_ARRAY {
    JobHandle: HANDLE;
    MemberLevel: DWORD;
    Flags: DWORD;
}

@foreign
typedef PJOB_SET_ARRAY = JOB_SET_ARRAY*;

@foreign
struct EXCEPTION_REGISTRATION_RECORD {
    Next: _EXCEPTION_REGISTRATION_RECORD*;
    Handler: PEXCEPTION_ROUTINE;
}

@foreign
typedef PEXCEPTION_REGISTRATION_RECORD = EXCEPTION_REGISTRATION_RECORD*;

union NT_TIB___inner {
    FiberData: PVOID;
    Version: DWORD;
}

@foreign
struct NT_TIB {
    ExceptionList: EXCEPTION_REGISTRATION_RECORD*;
    StackBase: PVOID;
    StackLimit: PVOID;
    SubSystemTib: PVOID;
    u: NT_TIB___inner;
    ArbitraryUserPointer: PVOID;
    Self: _NT_TIB*;
}

@foreign
typedef PNT_TIB = NT_TIB*;

union NT_TIB32___inner {
    FiberData: DWORD;
    Version: DWORD;
}

@foreign
struct NT_TIB32 {
    ExceptionList: DWORD;
    StackBase: DWORD;
    StackLimit: DWORD;
    SubSystemTib: DWORD;
    u: NT_TIB32___inner;
    ArbitraryUserPointer: DWORD;
    Self: DWORD;
}

@foreign
typedef PNT_TIB32 = NT_TIB32*;

union NT_TIB64___inner {
    FiberData: DWORD64;
    Version: DWORD;
}

@foreign
struct NT_TIB64 {
    ExceptionList: DWORD64;
    StackBase: DWORD64;
    StackLimit: DWORD64;
    SubSystemTib: DWORD64;
    u: NT_TIB64___inner;
    ArbitraryUserPointer: DWORD64;
    Self: DWORD64;
}

@foreign
typedef PNT_TIB64 = NT_TIB64*;

@foreign
struct UMS_CREATE_THREAD_ATTRIBUTES {
    UmsVersion: DWORD;
    UmsContext: PVOID;
    UmsCompletionList: PVOID;
}

@foreign
typedef PUMS_CREATE_THREAD_ATTRIBUTES = UMS_CREATE_THREAD_ATTRIBUTES*;

@foreign
struct WOW64_ARCHITECTURE_INFORMATION {
    Machine: DWORD;
    KernelMode: DWORD;
    UserMode: DWORD;
    Native: DWORD;
    Process: DWORD;
    ReservedZero0: DWORD;
}

@foreign
struct QUOTA_LIMITS {
    PagedPoolLimit: SIZE_T;
    NonPagedPoolLimit: SIZE_T;
    MinimumWorkingSetSize: SIZE_T;
    MaximumWorkingSetSize: SIZE_T;
    PagefileLimit: SIZE_T;
    TimeLimit: LARGE_INTEGER;
}

@foreign
typedef PQUOTA_LIMITS = QUOTA_LIMITS*;

// @PROBLEM bitfields
@foreign
struct RATE_QUOTA_LIMIT;

@foreign
typedef PRATE_QUOTA_LIMIT = RATE_QUOTA_LIMIT*;

@foreign
struct QUOTA_LIMITS_EX {
    PagedPoolLimit: SIZE_T;
    NonPagedPoolLimit: SIZE_T;
    MinimumWorkingSetSize: SIZE_T;
    MaximumWorkingSetSize: SIZE_T;
    PagefileLimit: SIZE_T;
    TimeLimit: LARGE_INTEGER;
    WorkingSetLimit: SIZE_T;
    Reserved2: SIZE_T;
    Reserved3: SIZE_T;
    Reserved4: SIZE_T;
    Flags: DWORD;
    CpuRateLimit: RATE_QUOTA_LIMIT;
}

@foreign
typedef PQUOTA_LIMITS_EX = QUOTA_LIMITS_EX*;

@foreign
struct IO_COUNTERS {
    ReadOperationCount: ULONGLONG;
    WriteOperationCount: ULONGLONG;
    OtherOperationCount: ULONGLONG;
    ReadTransferCount: ULONGLONG;
    WriteTransferCount: ULONGLONG;
    OtherTransferCount: ULONGLONG;
}

@foreign
typedef PIO_COUNTERS = IO_COUNTERS*;

@foreign
enum HARDWARE_COUNTER_TYPE {
    PMCCounter,
    MaxHardwareCounterType,
}

@foreign
typedef PHARDWARE_COUNTER_TYPE = HARDWARE_COUNTER_TYPE*;

@foreign
enum PROCESS_MITIGATION_POLICY {
    ProcessDEPPolicy,
    ProcessASLRPolicy,
    ProcessDynamicCodePolicy,
    ProcessStrictHandleCheckPolicy,
    ProcessSystemCallDisablePolicy,
    ProcessMitigationOptionsMask,
    ProcessExtensionPointDisablePolicy,
    ProcessControlFlowGuardPolicy,
    ProcessSignaturePolicy,
    ProcessFontDisablePolicy,
    ProcessImageLoadPolicy,
    ProcessSystemCallFilterPolicy,
    ProcessPayloadRestrictionPolicy,
    ProcessChildProcessPolicy,
    MaxProcessMitigationPolicy,
}

@foreign
typedef PPROCESS_MITIGATION_POLICY = PROCESS_MITIGATION_POLICY*;

// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_ASLR_POLICY;

@foreign
typedef PPROCESS_MITIGATION_ASLR_POLICY = PROCESS_MITIGATION_ASLR_POLICY*;

// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_DEP_POLICY;

@foreign
typedef PPROCESS_MITIGATION_DEP_POLICY = PROCESS_MITIGATION_DEP_POLICY*;

// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_STRICT_HANDLE_CHECK_POLICY;

@foreign
typedef PPROCESS_MITIGATION_STRICT_HANDLE_CHECK_POLICY = PROCESS_MITIGATION_STRICT_HANDLE_CHECK_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_SYSTEM_CALL_DISABLE_POLICY;

@foreign
typedef PPROCESS_MITIGATION_SYSTEM_CALL_DISABLE_POLICY = PROCESS_MITIGATION_SYSTEM_CALL_DISABLE_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_EXTENSION_POINT_DISABLE_POLICY;

@foreign
typedef PPROCESS_MITIGATION_EXTENSION_POINT_DISABLE_POLICY = PROCESS_MITIGATION_EXTENSION_POINT_DISABLE_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_DYNAMIC_CODE_POLICY;

@foreign
typedef PPROCESS_MITIGATION_DYNAMIC_CODE_POLICY = PROCESS_MITIGATION_DYNAMIC_CODE_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_CONTROL_FLOW_GUARD_POLICY;

@foreign
typedef PPROCESS_MITIGATION_CONTROL_FLOW_GUARD_POLICY = PROCESS_MITIGATION_CONTROL_FLOW_GUARD_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_BINARY_SIGNATURE_POLICY;

@foreign
typedef PPROCESS_MITIGATION_BINARY_SIGNATURE_POLICY = PROCESS_MITIGATION_BINARY_SIGNATURE_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_FONT_DISABLE_POLICY;

@foreign
typedef PPROCESS_MITIGATION_FONT_DISABLE_POLICY = PROCESS_MITIGATION_FONT_DISABLE_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_IMAGE_LOAD_POLICY;

@foreign
typedef PPROCESS_MITIGATION_IMAGE_LOAD_POLICY = PROCESS_MITIGATION_IMAGE_LOAD_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_SYSTEM_CALL_FILTER_POLICY;

@foreign
typedef PPROCESS_MITIGATION_SYSTEM_CALL_FILTER_POLICY = PROCESS_MITIGATION_SYSTEM_CALL_FILTER_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_PAYLOAD_RESTRICTION_POLICY;

@foreign
typedef PPROCESS_MITIGATION_PAYLOAD_RESTRICTION_POLICY = PROCESS_MITIGATION_PAYLOAD_RESTRICTION_POLICY*;


// @PROBLEM: bitfields
@foreign
struct PROCESS_MITIGATION_CHILD_PROCESS_POLICY;

@foreign
typedef PPROCESS_MITIGATION_CHILD_PROCESS_POLICY = PROCESS_MITIGATION_CHILD_PROCESS_POLICY*;

@foreign
struct JOBOBJECT_BASIC_ACCOUNTING_INFORMATION {
    TotalUserTime: LARGE_INTEGER;
    TotalKernelTime: LARGE_INTEGER;
    ThisPeriodTotalUserTime: LARGE_INTEGER;
    ThisPeriodTotalKernelTime: LARGE_INTEGER;
    TotalPageFaultCount: DWORD;
    TotalProcesses: DWORD;
    ActiveProcesses: DWORD;
    TotalTerminatedProcesses: DWORD;
}

@foreign
typedef PJOBOBJECT_BASIC_ACCOUNTING_INFORMATION = JOBOBJECT_BASIC_ACCOUNTING_INFORMATION*;

@foreign
struct JOBOBJECT_BASIC_LIMIT_INFORMATION {
    PerProcessUserTimeLimit: LARGE_INTEGER;
    PerJobUserTimeLimit: LARGE_INTEGER;
    LimitFlags: DWORD;
    MinimumWorkingSetSize: SIZE_T;
    MaximumWorkingSetSize: SIZE_T;
    ActiveProcessLimit: DWORD;
    Affinity: ULONG_PTR;
    PriorityClass: DWORD;
    SchedulingClass: DWORD;
}

@foreign
typedef PJOBOBJECT_BASIC_LIMIT_INFORMATION = JOBOBJECT_BASIC_LIMIT_INFORMATION*;

@foreign
struct JOBOBJECT_EXTENDED_LIMIT_INFORMATION {
    BasicLimitInformation: JOBOBJECT_BASIC_LIMIT_INFORMATION;
    IoInfo: IO_COUNTERS;
    ProcessMemoryLimit: SIZE_T;
    JobMemoryLimit: SIZE_T;
    PeakProcessMemoryUsed: SIZE_T;
    PeakJobMemoryUsed: SIZE_T;
}

@foreign
typedef PJOBOBJECT_EXTENDED_LIMIT_INFORMATION = JOBOBJECT_EXTENDED_LIMIT_INFORMATION*;

@foreign
struct JOBOBJECT_BASIC_PROCESS_ID_LIST {
    NumberOfAssignedProcesses: DWORD;
    NumberOfProcessIdsInList: DWORD;
    ProcessIdList: ULONG_PTR[1];
}

@foreign
typedef PJOBOBJECT_BASIC_PROCESS_ID_LIST = JOBOBJECT_BASIC_PROCESS_ID_LIST*;

@foreign
struct JOBOBJECT_BASIC_UI_RESTRICTIONS {
    UIRestrictionsClass: DWORD;
}

@foreign
typedef PJOBOBJECT_BASIC_UI_RESTRICTIONS = JOBOBJECT_BASIC_UI_RESTRICTIONS*;

@foreign
struct JOBOBJECT_SECURITY_LIMIT_INFORMATION {
    SecurityLimitFlags: DWORD;
    JobToken: HANDLE;
    SidsToDisable: PTOKEN_GROUPS;
    PrivilegesToDelete: PTOKEN_PRIVILEGES;
    RestrictedSids: PTOKEN_GROUPS;
}

@foreign
typedef PJOBOBJECT_SECURITY_LIMIT_INFORMATION = JOBOBJECT_SECURITY_LIMIT_INFORMATION*;

@foreign
struct JOBOBJECT_END_OF_JOB_TIME_INFORMATION {
    EndOfJobTimeAction: DWORD;
}

@foreign
typedef PJOBOBJECT_END_OF_JOB_TIME_INFORMATION = JOBOBJECT_END_OF_JOB_TIME_INFORMATION*;

@foreign
struct JOBOBJECT_ASSOCIATE_COMPLETION_PORT {
    CompletionKey: PVOID;
    CompletionPort: HANDLE;
}

@foreign
typedef PJOBOBJECT_ASSOCIATE_COMPLETION_PORT = JOBOBJECT_ASSOCIATE_COMPLETION_PORT*;

@foreign
struct JOBOBJECT_BASIC_AND_IO_ACCOUNTING_INFORMATION {
    BasicInfo: JOBOBJECT_BASIC_ACCOUNTING_INFORMATION;
    IoInfo: IO_COUNTERS;
}

@foreign
typedef PJOBOBJECT_BASIC_AND_IO_ACCOUNTING_INFORMATION = JOBOBJECT_BASIC_AND_IO_ACCOUNTING_INFORMATION*;

@foreign
struct JOBOBJECT_JOBSET_INFORMATION {
    MemberLevel: DWORD;
}

@foreign
typedef PJOBOBJECT_JOBSET_INFORMATION = JOBOBJECT_JOBSET_INFORMATION*;

@foreign
enum JOBOBJECT_RATE_CONTROL_TOLERANCE {
    ToleranceLow = 1,
    ToleranceMedium,
    ToleranceHigh,
}

@foreign
typedef PJOBOBJECT_RATE_CONTROL_TOLERANCE = JOBOBJECT_RATE_CONTROL_TOLERANCE*;

@foreign
enum JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL {
    ToleranceIntervalShort = 1,
    ToleranceIntervalMedium,
    ToleranceIntervalLong,
}

@foreign
typedef PJOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL = JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL*;

@foreign
struct JOBOBJECT_NOTIFICATION_LIMIT_INFORMATION {
    IoReadBytesLimit: DWORD64;
    IoWriteBytesLimit: DWORD64;
    PerJobUserTimeLimit: LARGE_INTEGER;
    JobMemoryLimit: DWORD64;
    RateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    RateControlToleranceInterval: JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL;
    LimitFlags: DWORD;
}

@foreign
typedef PJOBOBJECT_NOTIFICATION_LIMIT_INFORMATION = JOBOBJECT_NOTIFICATION_LIMIT_INFORMATION*;

/*
@PROBLEM Nested struct def at line 11776, C:\Program Files (x86)\Windows Kits\10\include\10.0.16299.0\um\winnt.h

@foreign
struct JOBOBJECT_NOTIFICATION_LIMIT_INFORMATION_2 {
    IoReadBytesLimit: DWORD64;
    IoWriteBytesLimit: DWORD64;
    PerJobUserTimeLimit: LARGE_INTEGER;
    u: (null);
    u2: (null);
    u3: (null);
    LimitFlags: DWORD;
    IoRateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    JobLowMemoryLimit: DWORD64;
    IoRateControlToleranceInterval: JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL;
    NetRateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    NetRateControlToleranceInterval: JOBOBJECT_RATE_CONTROL_TOLERANCE_INTERVAL;
}
*/

@foreign
struct JOBOBJECT_LIMIT_VIOLATION_INFORMATION {
    LimitFlags: DWORD;
    ViolationLimitFlags: DWORD;
    IoReadBytes: DWORD64;
    IoReadBytesLimit: DWORD64;
    IoWriteBytes: DWORD64;
    IoWriteBytesLimit: DWORD64;
    PerJobUserTime: LARGE_INTEGER;
    PerJobUserTimeLimit: LARGE_INTEGER;
    JobMemory: DWORD64;
    JobMemoryLimit: DWORD64;
    RateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    RateControlToleranceLimit: JOBOBJECT_RATE_CONTROL_TOLERANCE;
}

@foreign
typedef PJOBOBJECT_LIMIT_VIOLATION_INFORMATION = JOBOBJECT_LIMIT_VIOLATION_INFORMATION*;

/*
@PROBLEM Nested struct def at line 11820, C:\Program Files (x86)\Windows Kits\10\include\10.0.16299.0\um\winnt.h

@foreign
struct JOBOBJECT_LIMIT_VIOLATION_INFORMATION_2 {
    LimitFlags: DWORD;
    ViolationLimitFlags: DWORD;
    IoReadBytes: DWORD64;
    IoReadBytesLimit: DWORD64;
    IoWriteBytes: DWORD64;
    IoWriteBytesLimit: DWORD64;
    PerJobUserTime: LARGE_INTEGER;
    PerJobUserTimeLimit: LARGE_INTEGER;
    JobMemory: DWORD64;
    u: (null);
    u2: (null);
    u3: (null);
    JobLowMemoryLimit: DWORD64;
    IoRateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    IoRateControlToleranceLimit: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    NetRateControlTolerance: JOBOBJECT_RATE_CONTROL_TOLERANCE;
    NetRateControlToleranceLimit: JOBOBJECT_RATE_CONTROL_TOLERANCE;
}
*/

struct JOBOBJECT_CPU_RATE_CONTROL_INFORMATION___inner_s1 {
    MinRate: WORD;
    MaxRate: WORD;
}

union JOBOBJECT_CPU_RATE_CONTROL_INFORMATION___inner_u1 {
    CpuRate: DWORD;
    Weight: DWORD;
    s: JOBOBJECT_CPU_RATE_CONTROL_INFORMATION___inner_s1;
}

@foreign
struct JOBOBJECT_CPU_RATE_CONTROL_INFORMATION {
    ControlFlags: DWORD;
    u: JOBOBJECT_CPU_RATE_CONTROL_INFORMATION___inner_u1;
}

@foreign
typedef PJOBOBJECT_CPU_RATE_CONTROL_INFORMATION = JOBOBJECT_CPU_RATE_CONTROL_INFORMATION*;

@foreign
enum JOB_OBJECT_NET_RATE_CONTROL_FLAGS {
    JOB_OBJECT_NET_RATE_CONTROL_ENABLE = 1,
    JOB_OBJECT_NET_RATE_CONTROL_MAX_BANDWIDTH = 2,
    JOB_OBJECT_NET_RATE_CONTROL_DSCP_TAG = 4,
    JOB_OBJECT_NET_RATE_CONTROL_VALID_FLAGS = 7,
}

@foreign
typedef __C_ASSERT__ = char[1];

@foreign
struct JOBOBJECT_NET_RATE_CONTROL_INFORMATION {
    MaxBandwidth: DWORD64;
    ControlFlags: JOB_OBJECT_NET_RATE_CONTROL_FLAGS;
    DscpTag: BYTE;
}

@foreign
enum JOB_OBJECT_IO_RATE_CONTROL_FLAGS {
    JOB_OBJECT_IO_RATE_CONTROL_ENABLE = 1,
    JOB_OBJECT_IO_RATE_CONTROL_STANDALONE_VOLUME = 2,
    JOB_OBJECT_IO_RATE_CONTROL_VALID_FLAGS = 3,
}

@foreign
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE {
    MaxIops: LONG64;
    MaxBandwidth: LONG64;
    ReservationIops: LONG64;
    VolumeName: PWSTR;
    BaseIoSize: DWORD;
    ControlFlags: JOB_OBJECT_IO_RATE_CONTROL_FLAGS;
    VolumeNameLength: WORD;
}

@foreign
typedef JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE_V1 = JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE;

@foreign
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE_V2 {
    MaxIops: LONG64;
    MaxBandwidth: LONG64;
    ReservationIops: LONG64;
    VolumeName: PWSTR;
    BaseIoSize: DWORD;
    ControlFlags: JOB_OBJECT_IO_RATE_CONTROL_FLAGS;
    VolumeNameLength: WORD;
    CriticalReservationIops: LONG64;
    ReservationBandwidth: LONG64;
    CriticalReservationBandwidth: LONG64;
    MaxTimePercent: LONG64;
    ReservationTimePercent: LONG64;
    CriticalReservationTimePercent: LONG64;
}

@foreign
struct JOBOBJECT_IO_RATE_CONTROL_INFORMATION_NATIVE_V3 {
    MaxIops: LONG64;
    MaxBandwidth: LONG64;
    ReservationIops: LONG64;
    VolumeName: PWSTR;
    BaseIoSize: DWORD;
    ControlFlags: JOB_OBJECT_IO_RATE_CONTROL_FLAGS;
    VolumeNameLength: WORD;
    CriticalReservationIops: LONG64;
    ReservationBandwidth: LONG64;
    CriticalReservationBandwidth: LONG64;
    MaxTimePercent: LONG64;
    ReservationTimePercent: LONG64;
    CriticalReservationTimePercent: LONG64;
    SoftMaxIops: LONG64;
    SoftMaxBandwidth: LONG64;
    SoftMaxTimePercent: LONG64;
    LimitExcessNotifyIops: LONG64;
    LimitExcessNotifyBandwidth: LONG64;
    LimitExcessNotifyTimePercent: LONG64;
}

@foreign
enum JOBOBJECT_IO_ATTRIBUTION_CONTROL_FLAGS {
    JOBOBJECT_IO_ATTRIBUTION_CONTROL_ENABLE = 1,
    JOBOBJECT_IO_ATTRIBUTION_CONTROL_DISABLE = 2,
    JOBOBJECT_IO_ATTRIBUTION_CONTROL_VALID_FLAGS = 3,
}

@foreign
struct JOBOBJECT_IO_ATTRIBUTION_STATS {
    IoCount: ULONG_PTR;
    TotalNonOverlappedQueueTime: ULONGLONG;
    TotalNonOverlappedServiceTime: ULONGLONG;
    TotalSize: ULONGLONG;
}

@foreign
typedef PJOBOBJECT_IO_ATTRIBUTION_STATS = JOBOBJECT_IO_ATTRIBUTION_STATS*;

@foreign
struct JOBOBJECT_IO_ATTRIBUTION_INFORMATION {
    ControlFlags: DWORD;
    ReadStats: JOBOBJECT_IO_ATTRIBUTION_STATS;
    WriteStats: JOBOBJECT_IO_ATTRIBUTION_STATS;
}

@foreign
typedef PJOBOBJECT_IO_ATTRIBUTION_INFORMATION = JOBOBJECT_IO_ATTRIBUTION_INFORMATION*;

@foreign
enum JOBOBJECTINFOCLASS {
    JobObjectBasicAccountingInformation = 1,
    JobObjectBasicLimitInformation,
    JobObjectBasicProcessIdList,
    JobObjectBasicUIRestrictions,
    JobObjectSecurityLimitInformation,
    JobObjectEndOfJobTimeInformation,
    JobObjectAssociateCompletionPortInformation,
    JobObjectBasicAndIoAccountingInformation,
    JobObjectExtendedLimitInformation,
    JobObjectJobSetInformation,
    JobObjectGroupInformation,
    JobObjectNotificationLimitInformation,
    JobObjectLimitViolationInformation,
    JobObjectGroupInformationEx,
    JobObjectCpuRateControlInformation,
    JobObjectCompletionFilter,
    JobObjectCompletionCounter,
    JobObjectReserved1Information = 18,
    JobObjectReserved2Information,
    JobObjectReserved3Information,
    JobObjectReserved4Information,
    JobObjectReserved5Information,
    JobObjectReserved6Information,
    JobObjectReserved7Information,
    JobObjectReserved8Information,
    JobObjectReserved9Information,
    JobObjectReserved10Information,
    JobObjectReserved11Information,
    JobObjectReserved12Information,
    JobObjectReserved13Information,
    JobObjectReserved14Information = 31,
    JobObjectNetRateControlInformation,
    JobObjectNotificationLimitInformation2,
    JobObjectLimitViolationInformation2,
    JobObjectCreateSilo,
    JobObjectSiloBasicInformation,
    JobObjectReserved15Information = 37,
    JobObjectReserved16Information = 38,
    JobObjectReserved17Information = 39,
    JobObjectReserved18Information = 40,
    JobObjectReserved19Information = 41,
    JobObjectReserved20Information = 42,
    JobObjectReserved21Information = 43,
    JobObjectReserved22Information = 44,
    JobObjectReserved23Information = 45,
    JobObjectReserved24Information = 46,
    JobObjectReserved25Information = 47,
    MaxJobObjectInfoClass,
}

@foreign
struct SILOOBJECT_BASIC_INFORMATION {
    SiloId: DWORD;
    SiloParentId: DWORD;
    NumberOfProcesses: DWORD;
    IsInServerSilo: BOOLEAN;
    Reserved: BYTE[3];
}

@foreign
typedef PSILOOBJECT_BASIC_INFORMATION = SILOOBJECT_BASIC_INFORMATION*;

@foreign
enum SERVERSILO_STATE {
    SERVERSILO_INITING = 0,
    SERVERSILO_STARTED,
    SERVERSILO_SHUTTING_DOWN,
    SERVERSILO_TERMINATING,
    SERVERSILO_TERMINATED,
}

@foreign
typedef PSERVERSILO_STATE = SERVERSILO_STATE*;

@foreign
struct SERVERSILO_BASIC_INFORMATION {
    ServiceSessionId: DWORD;
    State: SERVERSILO_STATE;
    ExitStatus: DWORD;
}

@foreign
typedef PSERVERSILO_BASIC_INFORMATION = SERVERSILO_BASIC_INFORMATION*;

@foreign
enum FIRMWARE_TYPE {
    FirmwareTypeUnknown,
    FirmwareTypeBios,
    FirmwareTypeUefi,
    FirmwareTypeMax,
}

@foreign
typedef PFIRMWARE_TYPE = FIRMWARE_TYPE*;

@foreign
enum LOGICAL_PROCESSOR_RELATIONSHIP {
    RelationProcessorCore,
    RelationNumaNode,
    RelationCache,
    RelationProcessorPackage,
    RelationGroup,
    RelationAll = 65535,
}

@foreign
enum PROCESSOR_CACHE_TYPE {
    CacheUnified,
    CacheInstruction,
    CacheData,
    CacheTrace,
}

@foreign
struct CACHE_DESCRIPTOR {
    Level: BYTE;
    Associativity: BYTE;
    LineSize: WORD;
    Size: DWORD;
    Type: PROCESSOR_CACHE_TYPE;
}

@foreign
typedef PCACHE_DESCRIPTOR = CACHE_DESCRIPTOR*;

struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_s1 {
    Flags: BYTE;
}

struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_s2 {
    NodeNumber: DWORD;
}

union SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_u {
    ProcessorCore: SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_s1;
    NumaNode: SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_s2;
    Cache: CACHE_DESCRIPTOR;
    Reserved: ULONGLONG[2];
}

@foreign
struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION {
    ProcessorMask: ULONG_PTR;
    Relationship: LOGICAL_PROCESSOR_RELATIONSHIP;
    u: SYSTEM_LOGICAL_PROCESSOR_INFORMATION___inner_u;
}

@foreign
typedef PSYSTEM_LOGICAL_PROCESSOR_INFORMATION = SYSTEM_LOGICAL_PROCESSOR_INFORMATION*;

@foreign
struct PROCESSOR_RELATIONSHIP {
    Flags: BYTE;
    EfficiencyClass: BYTE;
    Reserved: BYTE[20];
    GroupCount: WORD;
    GroupMask: GROUP_AFFINITY[1];
}

@foreign
typedef PPROCESSOR_RELATIONSHIP = PROCESSOR_RELATIONSHIP*;

@foreign
struct NUMA_NODE_RELATIONSHIP {
    NodeNumber: DWORD;
    Reserved: BYTE[20];
    GroupMask: GROUP_AFFINITY;
}

@foreign
typedef PNUMA_NODE_RELATIONSHIP = NUMA_NODE_RELATIONSHIP*;

@foreign
struct CACHE_RELATIONSHIP {
    Level: BYTE;
    Associativity: BYTE;
    LineSize: WORD;
    CacheSize: DWORD;
    Type: PROCESSOR_CACHE_TYPE;
    Reserved: BYTE[20];
    GroupMask: GROUP_AFFINITY;
}

@foreign
typedef PCACHE_RELATIONSHIP = CACHE_RELATIONSHIP*;

@foreign
struct PROCESSOR_GROUP_INFO {
    MaximumProcessorCount: BYTE;
    ActiveProcessorCount: BYTE;
    Reserved: BYTE[38];
    ActiveProcessorMask: KAFFINITY;
}

@foreign
typedef PPROCESSOR_GROUP_INFO = PROCESSOR_GROUP_INFO*;

@foreign
struct GROUP_RELATIONSHIP {
    MaximumGroupCount: WORD;
    ActiveGroupCount: WORD;
    Reserved: BYTE[20];
    GroupInfo: PROCESSOR_GROUP_INFO[1];
}

@foreign
typedef PGROUP_RELATIONSHIP = GROUP_RELATIONSHIP*;

union SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX___inner {
    Processor: PROCESSOR_RELATIONSHIP;
    NumaNode: NUMA_NODE_RELATIONSHIP;
    Cache: CACHE_RELATIONSHIP;
    Group: GROUP_RELATIONSHIP;
}

@foreign
struct SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX {
    Relationship: LOGICAL_PROCESSOR_RELATIONSHIP;
    Size: DWORD;
    u: SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX___inner;
}

@foreign
typedef PSYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX = SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX*;

@foreign
enum CPU_SET_INFORMATION_TYPE {
    CpuSetInformation,
}

@foreign
typedef PCPU_SET_INFORMATION_TYPE = CPU_SET_INFORMATION_TYPE*;

// @PROBLEM bitfields
@foreign
struct SYSTEM_CPU_SET_INFORMATION;

@foreign
typedef PSYSTEM_CPU_SET_INFORMATION = SYSTEM_CPU_SET_INFORMATION*;

@foreign
struct SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION {
    CycleTime: DWORD64;
}

@foreign
typedef PSYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION = SYSTEM_PROCESSOR_CYCLE_TIME_INFORMATION*;

@foreign
struct XSTATE_FEATURE {
    Offset: DWORD;
    Size: DWORD;
}


@foreign
typedef PXSTATE_FEATURE = XSTATE_FEATURE*;

// @PROBLEM bitfields
@foreign
struct XSTATE_CONFIGURATION;

@foreign
typedef PXSTATE_CONFIGURATION = XSTATE_CONFIGURATION*;

@foreign
struct MEMORY_BASIC_INFORMATION {
    BaseAddress: PVOID;
    AllocationBase: PVOID;
    AllocationProtect: DWORD;
    RegionSize: SIZE_T;
    State: DWORD;
    Protect: DWORD;
    Type: DWORD;
}

@foreign
typedef PMEMORY_BASIC_INFORMATION = MEMORY_BASIC_INFORMATION*;

@foreign
struct MEMORY_BASIC_INFORMATION32 {
    BaseAddress: DWORD;
    AllocationBase: DWORD;
    AllocationProtect: DWORD;
    RegionSize: DWORD;
    State: DWORD;
    Protect: DWORD;
    Type: DWORD;
}

@foreign
typedef PMEMORY_BASIC_INFORMATION32 = MEMORY_BASIC_INFORMATION32*;

@foreign
struct MEMORY_BASIC_INFORMATION64 {
    BaseAddress: ULONGLONG;
    AllocationBase: ULONGLONG;
    AllocationProtect: DWORD;
    __alignment1: DWORD;
    RegionSize: ULONGLONG;
    State: DWORD;
    Protect: DWORD;
    Type: DWORD;
    __alignment2: DWORD;
}

@foreign
typedef PMEMORY_BASIC_INFORMATION64 = MEMORY_BASIC_INFORMATION64*;

@foreign
struct CFG_CALL_TARGET_INFO {
    Offset: ULONG_PTR;
    Flags: ULONG_PTR;
}

@foreign
typedef PCFG_CALL_TARGET_INFO = CFG_CALL_TARGET_INFO*;

@foreign
struct ENCLAVE_CREATE_INFO_SGX {
    Secs: BYTE[4096];
}

@foreign
typedef PENCLAVE_CREATE_INFO_SGX = ENCLAVE_CREATE_INFO_SGX*;

@foreign
struct ENCLAVE_INIT_INFO_SGX {
    SigStruct: BYTE[1808];
    Reserved1: BYTE[240];
    EInitToken: BYTE[304];
    Reserved2: BYTE[1744];
}

@foreign
typedef PENCLAVE_INIT_INFO_SGX = ENCLAVE_INIT_INFO_SGX*;

@foreign
struct ENCLAVE_CREATE_INFO_VBS {
    Flags: DWORD;
    OwnerID: BYTE[32];
}

@foreign
typedef PENCLAVE_CREATE_INFO_VBS = ENCLAVE_CREATE_INFO_VBS*;

@foreign
struct ENCLAVE_INIT_INFO_VBS {
    Length: DWORD;
    ThreadCount: DWORD;
}

@foreign
typedef PENCLAVE_INIT_INFO_VBS = ENCLAVE_INIT_INFO_VBS*;

@foreign
typedef ENCLAVE_TARGET_FUNCTION = func(arg0: PVOID): PVOID;

@foreign
typedef PENCLAVE_TARGET_FUNCTION = ENCLAVE_TARGET_FUNCTION*;

@foreign
typedef LPENCLAVE_TARGET_FUNCTION = PENCLAVE_TARGET_FUNCTION;

@foreign
struct FILE_ID_128 {
    Identifier: BYTE[16];
}

@foreign
typedef PFILE_ID_128 = FILE_ID_128*;

@foreign
struct FILE_NOTIFY_INFORMATION {
    NextEntryOffset: DWORD;
    Action: DWORD;
    FileNameLength: DWORD;
    FileName: WCHAR[1];
}

@foreign
typedef PFILE_NOTIFY_INFORMATION = FILE_NOTIFY_INFORMATION*;

@foreign
struct FILE_NOTIFY_EXTENDED_INFORMATION {
    NextEntryOffset: DWORD;
    Action: DWORD;
    CreationTime: LARGE_INTEGER;
    LastModificationTime: LARGE_INTEGER;
    LastChangeTime: LARGE_INTEGER;
    LastAccessTime: LARGE_INTEGER;
    AllocatedLength: LARGE_INTEGER;
    FileSize: LARGE_INTEGER;
    FileAttributes: DWORD;
    ReparsePointTag: DWORD;
    FileId: LARGE_INTEGER;
    ParentFileId: LARGE_INTEGER;
    FileNameLength: DWORD;
    FileName: WCHAR[1];
}

@foreign
typedef PFILE_NOTIFY_EXTENDED_INFORMATION = FILE_NOTIFY_EXTENDED_INFORMATION*;

@foreign
union FILE_SEGMENT_ELEMENT {
    Buffer: PVOID64;
    Alignment: ULONGLONG;
}

@foreign
typedef PFILE_SEGMENT_ELEMENT = FILE_SEGMENT_ELEMENT*;

struct REPARSE_GUID_DATA_BUFFER___inner {
    DataBuffer: BYTE[1];
}

@foreign
struct REPARSE_GUID_DATA_BUFFER {
    ReparseTag: DWORD;
    ReparseDataLength: WORD;
    Reserved: WORD;
    ReparseGuid: GUID;
    GenericReparseBuffer: REPARSE_GUID_DATA_BUFFER___inner;
}

@foreign
typedef PREPARSE_GUID_DATA_BUFFER = REPARSE_GUID_DATA_BUFFER*;

@foreign
struct SCRUB_DATA_INPUT {
    Size: DWORD;
    Flags: DWORD;
    MaximumIos: DWORD;
    ObjectId: DWORD[4];
    Reserved: DWORD[13];
    ResumeContext: BYTE[816];
}

@foreign
typedef PSCRUB_DATA_INPUT = SCRUB_DATA_INPUT*;

@foreign
struct SCRUB_PARITY_EXTENT {
    Offset: LONGLONG;
    Length: ULONGLONG;
}

@foreign
typedef PSCRUB_PARITY_EXTENT = SCRUB_PARITY_EXTENT*;

@foreign
struct SCRUB_PARITY_EXTENT_DATA {
    Size: WORD;
    Flags: WORD;
    NumberOfParityExtents: WORD;
    MaximumNumberOfParityExtents: WORD;
    ParityExtents: SCRUB_PARITY_EXTENT[1];
}

@foreign
typedef PSCRUB_PARITY_EXTENT_DATA = SCRUB_PARITY_EXTENT_DATA*;

@foreign
struct SCRUB_DATA_OUTPUT {
    Size: DWORD;
    Flags: DWORD;
    Status: DWORD;
    ErrorFileOffset: ULONGLONG;
    ErrorLength: ULONGLONG;
    NumberOfBytesRepaired: ULONGLONG;
    NumberOfBytesFailed: ULONGLONG;
    InternalFileReference: ULONGLONG;
    ResumeContextLength: WORD;
    ParityExtentDataOffset: WORD;
    Reserved: DWORD[5];
    ResumeContext: BYTE[816];
}

@foreign
typedef PSCRUB_DATA_OUTPUT = SCRUB_DATA_OUTPUT*;

@foreign
enum SharedVirtualDiskSupportType {
    SharedVirtualDisksUnsupported = 0,
    SharedVirtualDisksSupported = 1,
    SharedVirtualDiskSnapshotsSupported = 3,
    SharedVirtualDiskCDPSnapshotsSupported = 7,
}

@foreign
enum SharedVirtualDiskHandleState {
    SharedVirtualDiskHandleStateNone = 0,
    SharedVirtualDiskHandleStateFileShared = 1,
    SharedVirtualDiskHandleStateHandleShared = 3,
}

@foreign
struct SHARED_VIRTUAL_DISK_SUPPORT {
    SharedVirtualDiskSupport: SharedVirtualDiskSupportType;
    HandleState: SharedVirtualDiskHandleState;
}

@foreign
typedef PSHARED_VIRTUAL_DISK_SUPPORT = SHARED_VIRTUAL_DISK_SUPPORT*;

@foreign
struct NETWORK_APP_INSTANCE_EA {
    AppInstanceID: GUID;
    CsvFlags: DWORD;
}

@foreign
typedef PNETWORK_APP_INSTANCE_EA = NETWORK_APP_INSTANCE_EA*;

@foreign
enum SYSTEM_POWER_STATE {
    PowerSystemUnspecified = 0,
    PowerSystemWorking = 1,
    PowerSystemSleeping1 = 2,
    PowerSystemSleeping2 = 3,
    PowerSystemSleeping3 = 4,
    PowerSystemHibernate = 5,
    PowerSystemShutdown = 6,
    PowerSystemMaximum = 7,
}

@foreign
typedef PSYSTEM_POWER_STATE = SYSTEM_POWER_STATE*;

@foreign
enum POWER_ACTION {
    PowerActionNone = 0,
    PowerActionReserved,
    PowerActionSleep,
    PowerActionHibernate,
    PowerActionShutdown,
    PowerActionShutdownReset,
    PowerActionShutdownOff,
    PowerActionWarmEject,
    PowerActionDisplayOff,
}

@foreign
typedef PPOWER_ACTION = POWER_ACTION;

@foreign
enum DEVICE_POWER_STATE {
    PowerDeviceUnspecified = 0,
    PowerDeviceD0,
    PowerDeviceD1,
    PowerDeviceD2,
    PowerDeviceD3,
    PowerDeviceMaximum,
}

@foreign
typedef PDEVICE_POWER_STATE = DEVICE_POWER_STATE*;

@foreign
enum MONITOR_DISPLAY_STATE {
    PowerMonitorOff = 0,
    PowerMonitorOn,
    PowerMonitorDim,
}

@foreign
typedef PMONITOR_DISPLAY_STATE = MONITOR_DISPLAY_STATE*;

@foreign
enum USER_ACTIVITY_PRESENCE {
    PowerUserPresent = 0,
    PowerUserNotPresent,
    PowerUserInactive,
    PowerUserMaximum,
    PowerUserInvalid = 3,
}

@foreign
typedef PUSER_ACTIVITY_PRESENCE = USER_ACTIVITY_PRESENCE*;

@foreign
typedef EXECUTION_STATE = DWORD;

@foreign
typedef PEXECUTION_STATE = DWORD*;

@foreign
enum LATENCY_TIME {
    LT_DONT_CARE,
    LT_LOWEST_LATENCY,
}

@foreign
enum POWER_REQUEST_TYPE {
    PowerRequestDisplayRequired,
    PowerRequestSystemRequired,
    PowerRequestAwayModeRequired,
    PowerRequestExecutionRequired,
}

@foreign
typedef PPOWER_REQUEST_TYPE = POWER_REQUEST_TYPE*;

@foreign
struct CM_POWER_DATA {
    PD_Size: DWORD;
    PD_MostRecentPowerState: DEVICE_POWER_STATE;
    PD_Capabilities: DWORD;
    PD_D1Latency: DWORD;
    PD_D2Latency: DWORD;
    PD_D3Latency: DWORD;
    PD_PowerStateMapping: DEVICE_POWER_STATE[7];
    PD_DeepestSystemWake: SYSTEM_POWER_STATE;
}

@foreign
typedef PCM_POWER_DATA = CM_POWER_DATA*;

@foreign
enum POWER_INFORMATION_LEVEL {
    SystemPowerPolicyAc,
    SystemPowerPolicyDc,
    VerifySystemPolicyAc,
    VerifySystemPolicyDc,
    SystemPowerCapabilities,
    SystemBatteryState,
    SystemPowerStateHandler,
    ProcessorStateHandler,
    SystemPowerPolicyCurrent,
    AdministratorPowerPolicy,
    SystemReserveHiberFile,
    ProcessorInformation,
    SystemPowerInformation,
    ProcessorStateHandler2,
    LastWakeTime,
    LastSleepTime,
    SystemExecutionState,
    SystemPowerStateNotifyHandler,
    ProcessorPowerPolicyAc,
    ProcessorPowerPolicyDc,
    VerifyProcessorPowerPolicyAc,
    VerifyProcessorPowerPolicyDc,
    ProcessorPowerPolicyCurrent,
    SystemPowerStateLogging,
    SystemPowerLoggingEntry,
    SetPowerSettingValue,
    NotifyUserPowerSetting,
    PowerInformationLevelUnused0,
    SystemMonitorHiberBootPowerOff,
    SystemVideoState,
    TraceApplicationPowerMessage,
    TraceApplicationPowerMessageEnd,
    ProcessorPerfStates,
    ProcessorIdleStates,
    ProcessorCap,
    SystemWakeSource,
    SystemHiberFileInformation,
    TraceServicePowerMessage,
    ProcessorLoad,
    PowerShutdownNotification,
    MonitorCapabilities,
    SessionPowerInit,
    SessionDisplayState,
    PowerRequestCreate,
    PowerRequestAction,
    GetPowerRequestList,
    ProcessorInformationEx,
    NotifyUserModeLegacyPowerEvent,
    GroupPark,
    ProcessorIdleDomains,
    WakeTimerList,
    SystemHiberFileSize,
    ProcessorIdleStatesHv,
    ProcessorPerfStatesHv,
    ProcessorPerfCapHv,
    ProcessorSetIdle,
    LogicalProcessorIdling,
    UserPresence,
    PowerSettingNotificationName,
    GetPowerSettingValue,
    IdleResiliency,
    SessionRITState,
    SessionConnectNotification,
    SessionPowerCleanup,
    SessionLockState,
    SystemHiberbootState,
    PlatformInformation,
    PdcInvocation,
    MonitorInvocation,
    FirmwareTableInformationRegistered,
    SetShutdownSelectedTime,
    SuspendResumeInvocation,
    PlmPowerRequestCreate,
    ScreenOff,
    CsDeviceNotification,
    PlatformRole,
    LastResumePerformance,
    DisplayBurst,
    ExitLatencySamplingPercentage,
    RegisterSpmPowerSettings,
    PlatformIdleStates,
    ProcessorIdleVeto,
    PlatformIdleVeto,
    SystemBatteryStatePrecise,
    ThermalEvent,
    PowerRequestActionInternal,
    BatteryDeviceState,
    PowerInformationInternal,
    ThermalStandby,
    SystemHiberFileType,
    PhysicalPowerButtonPress,
    QueryPotentialDripsConstraint,
    EnergyTrackerCreate,
    EnergyTrackerQuery,
    UpdateBlackBoxRecorder,
    PowerInformationLevelMaximum,
}

@foreign
enum POWER_USER_PRESENCE_TYPE {
    UserNotPresent = 0,
    UserPresent = 1,
    UserUnknown = 255,
}

@foreign
typedef PPOWER_USER_PRESENCE_TYPE = POWER_USER_PRESENCE_TYPE;

@foreign
struct POWER_USER_PRESENCE {
    UserPresence: POWER_USER_PRESENCE_TYPE;
}

@foreign
typedef PPOWER_USER_PRESENCE = POWER_USER_PRESENCE*;

@foreign
struct POWER_SESSION_CONNECT {
    Connected: BOOLEAN;
    Console: BOOLEAN;
}

@foreign
typedef PPOWER_SESSION_CONNECT = POWER_SESSION_CONNECT*;

@foreign
struct POWER_SESSION_TIMEOUTS {
    InputTimeout: DWORD;
    DisplayTimeout: DWORD;
}

@foreign
typedef PPOWER_SESSION_TIMEOUTS = POWER_SESSION_TIMEOUTS*;

@foreign
struct POWER_SESSION_RIT_STATE {
    Active: BOOLEAN;
    LastInputTime: DWORD;
}

@foreign
typedef PPOWER_SESSION_RIT_STATE = POWER_SESSION_RIT_STATE*;

@foreign
struct POWER_SESSION_WINLOGON {
    SessionId: DWORD;
    Console: BOOLEAN;
    Locked: BOOLEAN;
}

@foreign
typedef PPOWER_SESSION_WINLOGON = POWER_SESSION_WINLOGON*;

@foreign
struct POWER_IDLE_RESILIENCY {
    CoalescingTimeout: DWORD;
    IdleResiliencyPeriod: DWORD;
}

@foreign
typedef PPOWER_IDLE_RESILIENCY = POWER_IDLE_RESILIENCY*;

@foreign
enum POWER_MONITOR_REQUEST_REASON {
    MonitorRequestReasonUnknown,
    MonitorRequestReasonPowerButton,
    MonitorRequestReasonRemoteConnection,
    MonitorRequestReasonScMonitorpower,
    MonitorRequestReasonUserInput,
    MonitorRequestReasonAcDcDisplayBurst,
    MonitorRequestReasonUserDisplayBurst,
    MonitorRequestReasonPoSetSystemState,
    MonitorRequestReasonSetThreadExecutionState,
    MonitorRequestReasonFullWake,
    MonitorRequestReasonSessionUnlock,
    MonitorRequestReasonScreenOffRequest,
    MonitorRequestReasonIdleTimeout,
    MonitorRequestReasonPolicyChange,
    MonitorRequestReasonSleepButton,
    MonitorRequestReasonLid,
    MonitorRequestReasonBatteryCountChange,
    MonitorRequestReasonGracePeriod,
    MonitorRequestReasonPnP,
    MonitorRequestReasonDP,
    MonitorRequestReasonSxTransition,
    MonitorRequestReasonSystemIdle,
    MonitorRequestReasonNearProximity,
    MonitorRequestReasonThermalStandby,
    MonitorRequestReasonResumePdc,
    MonitorRequestReasonResumeS4,
    MonitorRequestReasonTerminal,
    MonitorRequestReasonPdcSignal,
    MonitorRequestReasonAcDcDisplayBurstSuppressed,
    MonitorRequestReasonSystemStateEntered,
    MonitorRequestReasonWinrt,
    MonitorRequestReasonUserInputKeyboard,
    MonitorRequestReasonUserInputMouse,
    MonitorRequestReasonUserInputTouch,
    MonitorRequestReasonUserInputPen,
    MonitorRequestReasonUserInputAccelerometer,
    MonitorRequestReasonUserInputHid,
    MonitorRequestReasonUserInputPoUserPresent,
    MonitorRequestReasonUserInputSessionSwitch,
    MonitorRequestReasonUserInputInitialization,
    MonitorRequestReasonPdcSignalWindowsMobilePwrNotif,
    MonitorRequestReasonPdcSignalWindowsMobileShell,
    MonitorRequestReasonPdcSignalHeyCortana,
    MonitorRequestReasonPdcSignalHolographicShell,
    MonitorRequestReasonMax,
}

@foreign
enum POWER_MONITOR_REQUEST_TYPE {
    MonitorRequestTypeOff,
    MonitorRequestTypeOnAndPresent,
    MonitorRequestTypeToggleOn,
}

@foreign
struct POWER_MONITOR_INVOCATION {
    Console: BOOLEAN;
    RequestReason: POWER_MONITOR_REQUEST_REASON;
}

@foreign
typedef PPOWER_MONITOR_INVOCATION = POWER_MONITOR_INVOCATION*;

@foreign
struct RESUME_PERFORMANCE {
    PostTimeMs: DWORD;
    TotalResumeTimeMs: ULONGLONG;
    ResumeCompleteTimestamp: ULONGLONG;
}

@foreign
typedef PRESUME_PERFORMANCE = RESUME_PERFORMANCE*;

@foreign
enum SYSTEM_POWER_CONDITION {
    PoAc,
    PoDc,
    PoHot,
    PoConditionMaximum,
}

@foreign
struct SET_POWER_SETTING_VALUE {
    Version: DWORD;
    Guid: GUID;
    PowerCondition: SYSTEM_POWER_CONDITION;
    DataLength: DWORD;
    Data: BYTE[1];
}

@foreign
typedef PSET_POWER_SETTING_VALUE = SET_POWER_SETTING_VALUE;

@foreign
struct NOTIFY_USER_POWER_SETTING {
    Guid: GUID;
}

@foreign
typedef PNOTIFY_USER_POWER_SETTING = NOTIFY_USER_POWER_SETTING;

@foreign
struct APPLICATIONLAUNCH_SETTING_VALUE {
    ActivationTime: LARGE_INTEGER;
    Flags: DWORD;
    ButtonInstanceID: DWORD;
}

@foreign
typedef PAPPLICATIONLAUNCH_SETTING_VALUE = APPLICATIONLAUNCH_SETTING_VALUE*;

@foreign
enum POWER_PLATFORM_ROLE {
    PlatformRoleUnspecified = 0,
    PlatformRoleDesktop,
    PlatformRoleMobile,
    PlatformRoleWorkstation,
    PlatformRoleEnterpriseServer,
    PlatformRoleSOHOServer,
    PlatformRoleAppliancePC,
    PlatformRolePerformanceServer,
    PlatformRoleSlate,
    PlatformRoleMaximum,
}

@foreign
typedef PPOWER_PLATFORM_ROLE = POWER_PLATFORM_ROLE*;

@foreign
struct POWER_PLATFORM_INFORMATION {
    AoAc: BOOLEAN;
}

@foreign
typedef PPOWER_PLATFORM_INFORMATION = POWER_PLATFORM_INFORMATION*;

@foreign
struct BATTERY_REPORTING_SCALE {
    Granularity: DWORD;
    Capacity: DWORD;
}

@foreign
typedef PBATTERY_REPORTING_SCALE = BATTERY_REPORTING_SCALE;

@foreign
struct PPM_WMI_LEGACY_PERFSTATE {
    Frequency: DWORD;
    Flags: DWORD;
    PercentFrequency: DWORD;
}

@foreign
typedef PPPM_WMI_LEGACY_PERFSTATE = PPM_WMI_LEGACY_PERFSTATE;

@foreign
struct PPM_WMI_IDLE_STATE {
    Latency: DWORD;
    Power: DWORD;
    TimeCheck: DWORD;
    PromotePercent: BYTE;
    DemotePercent: BYTE;
    StateType: BYTE;
    Reserved: BYTE;
    StateFlags: DWORD;
    Context: DWORD;
    IdleHandler: DWORD;
    Reserved1: DWORD;
}

@foreign
typedef PPPM_WMI_IDLE_STATE = PPM_WMI_IDLE_STATE;

@foreign
struct PPM_WMI_IDLE_STATES {
    Type: DWORD;
    Count: DWORD;
    TargetState: DWORD;
    OldState: DWORD;
    TargetProcessors: DWORD64;
    State: PPM_WMI_IDLE_STATE[1];
}

@foreign
typedef PPPM_WMI_IDLE_STATES = PPM_WMI_IDLE_STATES;

@foreign
struct PPM_WMI_IDLE_STATES_EX {
    Type: DWORD;
    Count: DWORD;
    TargetState: DWORD;
    OldState: DWORD;
    TargetProcessors: PVOID;
    State: PPM_WMI_IDLE_STATE[1];
}

@foreign
typedef PPPM_WMI_IDLE_STATES_EX = PPM_WMI_IDLE_STATES_EX;

@foreign
struct PPM_WMI_PERF_STATE {
    Frequency: DWORD;
    Power: DWORD;
    PercentFrequency: BYTE;
    IncreaseLevel: BYTE;
    DecreaseLevel: BYTE;
    Type: BYTE;
    IncreaseTime: DWORD;
    DecreaseTime: DWORD;
    Control: DWORD64;
    Status: DWORD64;
    HitCount: DWORD;
    Reserved1: DWORD;
    Reserved2: DWORD64;
    Reserved3: DWORD64;
}

@foreign
typedef PPPM_WMI_PERF_STATE = PPM_WMI_PERF_STATE;

@foreign
struct PPM_WMI_PERF_STATES {
    Count: DWORD;
    MaxFrequency: DWORD;
    CurrentState: DWORD;
    MaxPerfState: DWORD;
    MinPerfState: DWORD;
    LowestPerfState: DWORD;
    ThermalConstraint: DWORD;
    BusyAdjThreshold: BYTE;
    PolicyType: BYTE;
    Type: BYTE;
    Reserved: BYTE;
    TimerInterval: DWORD;
    TargetProcessors: DWORD64;
    PStateHandler: DWORD;
    PStateContext: DWORD;
    TStateHandler: DWORD;
    TStateContext: DWORD;
    FeedbackHandler: DWORD;
    Reserved1: DWORD;
    Reserved2: DWORD64;
    State: PPM_WMI_PERF_STATE[1];
}

@foreign
typedef PPPM_WMI_PERF_STATES = PPM_WMI_PERF_STATES;

@foreign
struct PPM_WMI_PERF_STATES_EX {
    Count: DWORD;
    MaxFrequency: DWORD;
    CurrentState: DWORD;
    MaxPerfState: DWORD;
    MinPerfState: DWORD;
    LowestPerfState: DWORD;
    ThermalConstraint: DWORD;
    BusyAdjThreshold: BYTE;
    PolicyType: BYTE;
    Type: BYTE;
    Reserved: BYTE;
    TimerInterval: DWORD;
    TargetProcessors: PVOID;
    PStateHandler: DWORD;
    PStateContext: DWORD;
    TStateHandler: DWORD;
    TStateContext: DWORD;
    FeedbackHandler: DWORD;
    Reserved1: DWORD;
    Reserved2: DWORD64;
    State: PPM_WMI_PERF_STATE[1];
}

@foreign
typedef PPPM_WMI_PERF_STATES_EX = PPM_WMI_PERF_STATES_EX;

@foreign
struct PPM_IDLE_STATE_ACCOUNTING {
    IdleTransitions: DWORD;
    FailedTransitions: DWORD;
    InvalidBucketIndex: DWORD;
    TotalTime: DWORD64;
    IdleTimeBuckets: DWORD[6];
}

@foreign
typedef PPPM_IDLE_STATE_ACCOUNTING = PPM_IDLE_STATE_ACCOUNTING;

@foreign
struct PPM_IDLE_ACCOUNTING {
    StateCount: DWORD;
    TotalTransitions: DWORD;
    ResetCount: DWORD;
    StartTime: DWORD64;
    State: PPM_IDLE_STATE_ACCOUNTING[1];
}

@foreign
typedef PPPM_IDLE_ACCOUNTING = PPM_IDLE_ACCOUNTING;

@foreign
struct PPM_IDLE_STATE_BUCKET_EX {
    TotalTimeUs: DWORD64;
    MinTimeUs: DWORD;
    MaxTimeUs: DWORD;
    Count: DWORD;
}

@foreign
typedef PPPM_IDLE_STATE_BUCKET_EX = PPM_IDLE_STATE_BUCKET_EX;

@foreign
struct PPM_IDLE_STATE_ACCOUNTING_EX {
    TotalTime: DWORD64;
    IdleTransitions: DWORD;
    FailedTransitions: DWORD;
    InvalidBucketIndex: DWORD;
    MinTimeUs: DWORD;
    MaxTimeUs: DWORD;
    CancelledTransitions: DWORD;
    IdleTimeBuckets: PPM_IDLE_STATE_BUCKET_EX[16];
}

@foreign
typedef PPPM_IDLE_STATE_ACCOUNTING_EX = PPM_IDLE_STATE_ACCOUNTING_EX;

@foreign
struct PPM_IDLE_ACCOUNTING_EX {
    StateCount: DWORD;
    TotalTransitions: DWORD;
    ResetCount: DWORD;
    AbortCount: DWORD;
    StartTime: DWORD64;
    State: PPM_IDLE_STATE_ACCOUNTING_EX[1];
}

@foreign
typedef PPPM_IDLE_ACCOUNTING_EX = PPM_IDLE_ACCOUNTING_EX;

@foreign
struct PPM_PERFSTATE_EVENT {
    State: DWORD;
    Status: DWORD;
    Latency: DWORD;
    Speed: DWORD;
    Processor: DWORD;
}

@foreign
typedef PPPM_PERFSTATE_EVENT = PPM_PERFSTATE_EVENT;

@foreign
struct PPM_PERFSTATE_DOMAIN_EVENT {
    State: DWORD;
    Latency: DWORD;
    Speed: DWORD;
    Processors: DWORD64;
}

@foreign
typedef PPPM_PERFSTATE_DOMAIN_EVENT = PPM_PERFSTATE_DOMAIN_EVENT;

@foreign
struct PPM_IDLESTATE_EVENT {
    NewState: DWORD;
    OldState: DWORD;
    Processors: DWORD64;
}

@foreign
typedef PPPM_IDLESTATE_EVENT = PPM_IDLESTATE_EVENT;

@foreign
struct PPM_THERMALCHANGE_EVENT {
    ThermalConstraint: DWORD;
    Processors: DWORD64;
}

@foreign
typedef PPPM_THERMALCHANGE_EVENT = PPM_THERMALCHANGE_EVENT;

@foreign
struct PPM_THERMAL_POLICY_EVENT {
    Mode: BYTE;
    Processors: DWORD64;
}

@foreign
typedef PPPM_THERMAL_POLICY_EVENT = PPM_THERMAL_POLICY_EVENT;

@foreign
struct POWER_ACTION_POLICY {
    Action: POWER_ACTION;
    Flags: DWORD;
    EventCode: DWORD;
}

@foreign
typedef PPOWER_ACTION_POLICY = POWER_ACTION_POLICY;

@foreign
struct SYSTEM_POWER_LEVEL {
    Enable: BOOLEAN;
    Spare: BYTE[3];
    BatteryLevel: DWORD;
    PowerPolicy: POWER_ACTION_POLICY;
    MinSystemState: SYSTEM_POWER_STATE;
}

@foreign
typedef PSYSTEM_POWER_LEVEL = SYSTEM_POWER_LEVEL;

@foreign
struct SYSTEM_POWER_POLICY {
    Revision: DWORD;
    PowerButton: POWER_ACTION_POLICY;
    SleepButton: POWER_ACTION_POLICY;
    LidClose: POWER_ACTION_POLICY;
    LidOpenWake: SYSTEM_POWER_STATE;
    Reserved: DWORD;
    Idle: POWER_ACTION_POLICY;
    IdleTimeout: DWORD;
    IdleSensitivity: BYTE;
    DynamicThrottle: BYTE;
    Spare2: BYTE[2];
    MinSleep: SYSTEM_POWER_STATE;
    MaxSleep: SYSTEM_POWER_STATE;
    ReducedLatencySleep: SYSTEM_POWER_STATE;
    WinLogonFlags: DWORD;
    Spare3: DWORD;
    DozeS4Timeout: DWORD;
    BroadcastCapacityResolution: DWORD;
    DischargePolicy: SYSTEM_POWER_LEVEL[4];
    VideoTimeout: DWORD;
    VideoDimDisplay: BOOLEAN;
    VideoReserved: DWORD[3];
    SpindownTimeout: DWORD;
    OptimizeForPower: BOOLEAN;
    FanThrottleTolerance: BYTE;
    ForcedThrottle: BYTE;
    MinThrottle: BYTE;
    OverThrottled: POWER_ACTION_POLICY;
}

@foreign
typedef PSYSTEM_POWER_POLICY = SYSTEM_POWER_POLICY*;

@foreign
struct PROCESSOR_IDLESTATE_INFO {
    TimeCheck: DWORD;
    DemotePercent: BYTE;
    PromotePercent: BYTE;
    Spare: BYTE[2];
}

@foreign
typedef PPROCESSOR_IDLESTATE_INFO = PROCESSOR_IDLESTATE_INFO;

// @PROBLEM bitfields
@foreign
struct PROCESSOR_IDLESTATE_POLICY;

@foreign
typedef PPROCESSOR_IDLESTATE_POLICY = PROCESSOR_IDLESTATE_POLICY;

@foreign
struct PROCESSOR_POWER_POLICY_INFO {
    TimeCheck: DWORD;
    DemoteLimit: DWORD;
    PromoteLimit: DWORD;
    DemotePercent: BYTE;
    PromotePercent: BYTE;
    Spare: BYTE[2];
    AllowDemotion: DWORD;
    AllowPromotion: DWORD;
    Reserved: DWORD;
}

@foreign
typedef PPROCESSOR_POWER_POLICY_INFO = PROCESSOR_POWER_POLICY_INFO*;

@foreign
struct PROCESSOR_POWER_POLICY {
    Revision: DWORD;
    DynamicThrottle: BYTE;
    Spare: BYTE[3];
    DisableCStates: DWORD;
    Reserved: DWORD;
    PolicyCount: DWORD;
    Policy: PROCESSOR_POWER_POLICY_INFO[3];
}

@foreign
typedef PPROCESSOR_POWER_POLICY = PROCESSOR_POWER_POLICY*;

// @PROBLEM bitfields
@foreign
struct PROCESSOR_PERFSTATE_POLICY;

@foreign
typedef PPROCESSOR_PERFSTATE_POLICY = PROCESSOR_PERFSTATE_POLICY;

@foreign
struct ADMINISTRATOR_POWER_POLICY {
    MinSleep: SYSTEM_POWER_STATE;
    MaxSleep: SYSTEM_POWER_STATE;
    MinVideoTimeout: DWORD;
    MaxVideoTimeout: DWORD;
    MinSpindownTimeout: DWORD;
    MaxSpindownTimeout: DWORD;
}

@foreign
typedef PADMINISTRATOR_POWER_POLICY = ADMINISTRATOR_POWER_POLICY*;

@foreign
enum HIBERFILE_BUCKET_SIZE {
    HiberFileBucket1GB = 0,
    HiberFileBucket2GB,
    HiberFileBucket4GB,
    HiberFileBucket8GB,
    HiberFileBucket16GB,
    HiberFileBucket32GB,
    HiberFileBucketUnlimited,
    HiberFileBucketMax,
}

@foreign
typedef PHIBERFILE_BUCKET_SIZE = HIBERFILE_BUCKET_SIZE*;

@foreign
struct HIBERFILE_BUCKET {
    MaxPhysicalMemory: DWORD64;
    PhysicalMemoryPercent: DWORD[3];
}

@foreign
typedef PHIBERFILE_BUCKET = HIBERFILE_BUCKET*;

@foreign
struct SYSTEM_POWER_CAPABILITIES {
    PowerButtonPresent: BOOLEAN;
    SleepButtonPresent: BOOLEAN;
    LidPresent: BOOLEAN;
    SystemS1: BOOLEAN;
    SystemS2: BOOLEAN;
    SystemS3: BOOLEAN;
    SystemS4: BOOLEAN;
    SystemS5: BOOLEAN;
    HiberFilePresent: BOOLEAN;
    FullWake: BOOLEAN;
    VideoDimPresent: BOOLEAN;
    ApmPresent: BOOLEAN;
    UpsPresent: BOOLEAN;
    ThermalControl: BOOLEAN;
    ProcessorThrottle: BOOLEAN;
    ProcessorMinThrottle: BYTE;
    ProcessorMaxThrottle: BYTE;
    FastSystemS4: BOOLEAN;
    Hiberboot: BOOLEAN;
    WakeAlarmPresent: BOOLEAN;
    AoAc: BOOLEAN;
    DiskSpinDown: BOOLEAN;
    HiberFileType: BYTE;
    AoAcConnectivitySupported: BOOLEAN;
    spare3: BYTE[6];
    SystemBatteriesPresent: BOOLEAN;
    BatteriesAreShortTerm: BOOLEAN;
    BatteryScale: BATTERY_REPORTING_SCALE[3];
    AcOnLineWake: SYSTEM_POWER_STATE;
    SoftLidWake: SYSTEM_POWER_STATE;
    RtcWake: SYSTEM_POWER_STATE;
    MinDeviceWakeState: SYSTEM_POWER_STATE;
    DefaultLowLatencyWake: SYSTEM_POWER_STATE;
}

@foreign
typedef PSYSTEM_POWER_CAPABILITIES = SYSTEM_POWER_CAPABILITIES;

@foreign
struct SYSTEM_BATTERY_STATE {
    AcOnLine: BOOLEAN;
    BatteryPresent: BOOLEAN;
    Charging: BOOLEAN;
    Discharging: BOOLEAN;
    Spare1: BOOLEAN[3];
    Tag: BYTE;
    MaxCapacity: DWORD;
    RemainingCapacity: DWORD;
    Rate: DWORD;
    EstimatedTime: DWORD;
    DefaultAlert1: DWORD;
    DefaultAlert2: DWORD;
}

@foreign
typedef PSYSTEM_BATTERY_STATE = SYSTEM_BATTERY_STATE;

@foreign
struct IMAGE_DOS_HEADER {
    e_magic: WORD;
    e_cblp: WORD;
    e_cp: WORD;
    e_crlc: WORD;
    e_cparhdr: WORD;
    e_minalloc: WORD;
    e_maxalloc: WORD;
    e_ss: WORD;
    e_sp: WORD;
    e_csum: WORD;
    e_ip: WORD;
    e_cs: WORD;
    e_lfarlc: WORD;
    e_ovno: WORD;
    e_res: WORD[4];
    e_oemid: WORD;
    e_oeminfo: WORD;
    e_res2: WORD[10];
    e_lfanew: LONG;
}

@foreign
typedef PIMAGE_DOS_HEADER = IMAGE_DOS_HEADER*;

@foreign
struct IMAGE_OS2_HEADER {
    ne_magic: WORD;
    ne_ver: CHAR;
    ne_rev: CHAR;
    ne_enttab: WORD;
    ne_cbenttab: WORD;
    ne_crc: LONG;
    ne_flags: WORD;
    ne_autodata: WORD;
    ne_heap: WORD;
    ne_stack: WORD;
    ne_csip: LONG;
    ne_sssp: LONG;
    ne_cseg: WORD;
    ne_cmod: WORD;
    ne_cbnrestab: WORD;
    ne_segtab: WORD;
    ne_rsrctab: WORD;
    ne_restab: WORD;
    ne_modtab: WORD;
    ne_imptab: WORD;
    ne_nrestab: LONG;
    ne_cmovent: WORD;
    ne_align: WORD;
    ne_cres: WORD;
    ne_exetyp: BYTE;
    ne_flagsothers: BYTE;
    ne_pretthunks: WORD;
    ne_psegrefbytes: WORD;
    ne_swaparea: WORD;
    ne_expver: WORD;
}

@foreign
typedef PIMAGE_OS2_HEADER = IMAGE_OS2_HEADER*;

@foreign
struct IMAGE_VXD_HEADER {
    e32_magic: WORD;
    e32_border: BYTE;
    e32_worder: BYTE;
    e32_level: DWORD;
    e32_cpu: WORD;
    e32_os: WORD;
    e32_ver: DWORD;
    e32_mflags: DWORD;
    e32_mpages: DWORD;
    e32_startobj: DWORD;
    e32_eip: DWORD;
    e32_stackobj: DWORD;
    e32_esp: DWORD;
    e32_pagesize: DWORD;
    e32_lastpagesize: DWORD;
    e32_fixupsize: DWORD;
    e32_fixupsum: DWORD;
    e32_ldrsize: DWORD;
    e32_ldrsum: DWORD;
    e32_objtab: DWORD;
    e32_objcnt: DWORD;
    e32_objmap: DWORD;
    e32_itermap: DWORD;
    e32_rsrctab: DWORD;
    e32_rsrccnt: DWORD;
    e32_restab: DWORD;
    e32_enttab: DWORD;
    e32_dirtab: DWORD;
    e32_dircnt: DWORD;
    e32_fpagetab: DWORD;
    e32_frectab: DWORD;
    e32_impmod: DWORD;
    e32_impmodcnt: DWORD;
    e32_impproc: DWORD;
    e32_pagesum: DWORD;
    e32_datapage: DWORD;
    e32_preload: DWORD;
    e32_nrestab: DWORD;
    e32_cbnrestab: DWORD;
    e32_nressum: DWORD;
    e32_autodata: DWORD;
    e32_debuginfo: DWORD;
    e32_debuglen: DWORD;
    e32_instpreload: DWORD;
    e32_instdemand: DWORD;
    e32_heapsize: DWORD;
    e32_res3: BYTE[12];
    e32_winresoff: DWORD;
    e32_winreslen: DWORD;
    e32_devid: WORD;
    e32_ddkver: WORD;
}

@foreign
typedef PIMAGE_VXD_HEADER = IMAGE_VXD_HEADER*;

@foreign
struct IMAGE_FILE_HEADER {
    Machine: WORD;
    NumberOfSections: WORD;
    TimeDateStamp: DWORD;
    PointerToSymbolTable: DWORD;
    NumberOfSymbols: DWORD;
    SizeOfOptionalHeader: WORD;
    Characteristics: WORD;
}

@foreign
typedef PIMAGE_FILE_HEADER = IMAGE_FILE_HEADER*;

@foreign
struct IMAGE_DATA_DIRECTORY {
    VirtualAddress: DWORD;
    Size: DWORD;
}

@foreign
typedef PIMAGE_DATA_DIRECTORY = IMAGE_DATA_DIRECTORY*;

@foreign
struct IMAGE_OPTIONAL_HEADER32 {
    Magic: WORD;
    MajorLinkerVersion: BYTE;
    MinorLinkerVersion: BYTE;
    SizeOfCode: DWORD;
    SizeOfInitializedData: DWORD;
    SizeOfUninitializedData: DWORD;
    AddressOfEntryPoint: DWORD;
    BaseOfCode: DWORD;
    BaseOfData: DWORD;
    ImageBase: DWORD;
    SectionAlignment: DWORD;
    FileAlignment: DWORD;
    MajorOperatingSystemVersion: WORD;
    MinorOperatingSystemVersion: WORD;
    MajorImageVersion: WORD;
    MinorImageVersion: WORD;
    MajorSubsystemVersion: WORD;
    MinorSubsystemVersion: WORD;
    Win32VersionValue: DWORD;
    SizeOfImage: DWORD;
    SizeOfHeaders: DWORD;
    CheckSum: DWORD;
    Subsystem: WORD;
    DllCharacteristics: WORD;
    SizeOfStackReserve: DWORD;
    SizeOfStackCommit: DWORD;
    SizeOfHeapReserve: DWORD;
    SizeOfHeapCommit: DWORD;
    LoaderFlags: DWORD;
    NumberOfRvaAndSizes: DWORD;
    DataDirectory: IMAGE_DATA_DIRECTORY[16];
}

@foreign
typedef PIMAGE_OPTIONAL_HEADER32 = IMAGE_OPTIONAL_HEADER32*;

@foreign
struct IMAGE_ROM_OPTIONAL_HEADER {
    Magic: WORD;
    MajorLinkerVersion: BYTE;
    MinorLinkerVersion: BYTE;
    SizeOfCode: DWORD;
    SizeOfInitializedData: DWORD;
    SizeOfUninitializedData: DWORD;
    AddressOfEntryPoint: DWORD;
    BaseOfCode: DWORD;
    BaseOfData: DWORD;
    BaseOfBss: DWORD;
    GprMask: DWORD;
    CprMask: DWORD[4];
    GpValue: DWORD;
}

@foreign
typedef PIMAGE_ROM_OPTIONAL_HEADER = IMAGE_ROM_OPTIONAL_HEADER*;

@foreign
struct IMAGE_OPTIONAL_HEADER64 {
    Magic: WORD;
    MajorLinkerVersion: BYTE;
    MinorLinkerVersion: BYTE;
    SizeOfCode: DWORD;
    SizeOfInitializedData: DWORD;
    SizeOfUninitializedData: DWORD;
    AddressOfEntryPoint: DWORD;
    BaseOfCode: DWORD;
    ImageBase: ULONGLONG;
    SectionAlignment: DWORD;
    FileAlignment: DWORD;
    MajorOperatingSystemVersion: WORD;
    MinorOperatingSystemVersion: WORD;
    MajorImageVersion: WORD;
    MinorImageVersion: WORD;
    MajorSubsystemVersion: WORD;
    MinorSubsystemVersion: WORD;
    Win32VersionValue: DWORD;
    SizeOfImage: DWORD;
    SizeOfHeaders: DWORD;
    CheckSum: DWORD;
    Subsystem: WORD;
    DllCharacteristics: WORD;
    SizeOfStackReserve: ULONGLONG;
    SizeOfStackCommit: ULONGLONG;
    SizeOfHeapReserve: ULONGLONG;
    SizeOfHeapCommit: ULONGLONG;
    LoaderFlags: DWORD;
    NumberOfRvaAndSizes: DWORD;
    DataDirectory: IMAGE_DATA_DIRECTORY[16];
}

@foreign
typedef PIMAGE_OPTIONAL_HEADER64 = IMAGE_OPTIONAL_HEADER64*;

@foreign
typedef IMAGE_OPTIONAL_HEADER = IMAGE_OPTIONAL_HEADER64;

@foreign
typedef PIMAGE_OPTIONAL_HEADER = PIMAGE_OPTIONAL_HEADER64;

@foreign
struct IMAGE_NT_HEADERS64 {
    Signature: DWORD;
    FileHeader: IMAGE_FILE_HEADER;
    OptionalHeader: IMAGE_OPTIONAL_HEADER64;
}

@foreign
typedef PIMAGE_NT_HEADERS64 = IMAGE_NT_HEADERS64*;

@foreign
struct IMAGE_NT_HEADERS32 {
    Signature: DWORD;
    FileHeader: IMAGE_FILE_HEADER;
    OptionalHeader: IMAGE_OPTIONAL_HEADER32;
}

@foreign
typedef PIMAGE_NT_HEADERS32 = IMAGE_NT_HEADERS32*;

@foreign
struct IMAGE_ROM_HEADERS {
    FileHeader: IMAGE_FILE_HEADER;
    OptionalHeader: IMAGE_ROM_OPTIONAL_HEADER;
}

@foreign
typedef PIMAGE_ROM_HEADERS = IMAGE_ROM_HEADERS*;

@foreign
typedef IMAGE_NT_HEADERS = IMAGE_NT_HEADERS64;

@foreign
typedef PIMAGE_NT_HEADERS = PIMAGE_NT_HEADERS64;

@foreign
struct ANON_OBJECT_HEADER {
    Sig1: WORD;
    Sig2: WORD;
    Version: WORD;
    Machine: WORD;
    TimeDateStamp: DWORD;
    ClassID: CLSID;
    SizeOfData: DWORD;
}

@foreign
struct ANON_OBJECT_HEADER_V2 {
    Sig1: WORD;
    Sig2: WORD;
    Version: WORD;
    Machine: WORD;
    TimeDateStamp: DWORD;
    ClassID: CLSID;
    SizeOfData: DWORD;
    Flags: DWORD;
    MetaDataSize: DWORD;
    MetaDataOffset: DWORD;
}

@foreign
struct ANON_OBJECT_HEADER_BIGOBJ {
    Sig1: WORD;
    Sig2: WORD;
    Version: WORD;
    Machine: WORD;
    TimeDateStamp: DWORD;
    ClassID: CLSID;
    SizeOfData: DWORD;
    Flags: DWORD;
    MetaDataSize: DWORD;
    MetaDataOffset: DWORD;
    NumberOfSections: DWORD;
    PointerToSymbolTable: DWORD;
    NumberOfSymbols: DWORD;
}

union IMAGE_SECTION_HEADER___inner {
    PhysicalAddress: DWORD;
    VirtualSize: DWORD;
}

@foreign
struct IMAGE_SECTION_HEADER {
    Name: BYTE[8];
    Misc: IMAGE_SECTION_HEADER___inner;
    VirtualAddress: DWORD;
    SizeOfRawData: DWORD;
    PointerToRawData: DWORD;
    PointerToRelocations: DWORD;
    PointerToLinenumbers: DWORD;
    NumberOfRelocations: WORD;
    NumberOfLinenumbers: WORD;
    Characteristics: DWORD;
}

@foreign
typedef PIMAGE_SECTION_HEADER = IMAGE_SECTION_HEADER*;

struct IMAGE_SYMBOL___inner_s1 {
    Short: DWORD;
    Long: DWORD;
}

union IMAGE_SYMBOL___inner_u1 {
    ShortName: BYTE[8];
    Name: IMAGE_SYMBOL___inner_s1;
    LongName: DWORD[2];
}

@foreign
struct IMAGE_SYMBOL {
    N: IMAGE_SYMBOL___inner_u1;
    Value: DWORD;
    SectionNumber: SHORT;
    Type: WORD;
    StorageClass: BYTE;
    NumberOfAuxSymbols: BYTE;
}

@foreign
typedef PIMAGE_SYMBOL = IMAGE_SYMBOL*;

struct IMAGE_SYMBOL_EX___inner_s1 {
    Short: DWORD;
    Long: DWORD;
}

union IMAGE_SYMBOL_EX___inner_u1 {
    ShortName: BYTE[8];
    Name: IMAGE_SYMBOL_EX___inner_s1;
    LongName: DWORD[2];
}


@foreign
struct IMAGE_SYMBOL_EX {
    N: IMAGE_SYMBOL_EX___inner_u1;
    Value: DWORD;
    SectionNumber: LONG;
    Type: WORD;
    StorageClass: BYTE;
    NumberOfAuxSymbols: BYTE;
}

@foreign
typedef PIMAGE_SYMBOL_EX = IMAGE_SYMBOL_EX*;

@foreign
struct IMAGE_AUX_SYMBOL_TOKEN_DEF {
    bAuxType: BYTE;
    bReserved: BYTE;
    SymbolTableIndex: DWORD;
    rgbReserved: BYTE[12];
}

@foreign
typedef PIMAGE_AUX_SYMBOL_TOKEN_DEF = IMAGE_AUX_SYMBOL_TOKEN_DEF*;

struct IMAGE_AUX_SYMBOL___inner_s2 {
    Linenumber: WORD;
    Size: WORD;
}

union IMAGE_AUX_SYMBOL___inner_u1 {
    LnSz: IMAGE_AUX_SYMBOL___inner_s2;
    TotalSize: DWORD;
}

struct IMAGE_AUX_SYMBOL___inner_s3 {
    PointerToLinenumber: DWORD;
    PointerToNextFunction: DWORD;
}

struct IMAGE_AUX_SYMBOL___inner_s4 {
    Dimension: WORD[4];
}

union IMAGE_AUX_SYMBOL___inner_u2 {
    Function: IMAGE_AUX_SYMBOL___inner_s3;
    Array: IMAGE_AUX_SYMBOL___inner_s4;
}

@foreign 
struct IMAGE_AUX_SYMBOL___inner_s1 {
    TagIndex: DWORD;
    Misc: IMAGE_AUX_SYMBOL___inner_u1;
    FcnAry: IMAGE_AUX_SYMBOL___inner_u2;
    TvIndex: WORD;
}

struct IMAGE_AUX_SYMBOL___inner_s5 {
    Name: BYTE[18];
}

struct IMAGE_AUX_SYMBOL___inner_s6 {
    Length: DWORD;
    NumberOfRelocations: WORD;
    NumberOfLinenumbers: WORD;
    CheckSum: DWORD;
    Number: SHORT;
    Selection: BYTE;
    bReserved: BYTE;
    HighNumber: SHORT;
}

struct IMAGE_AUX_SYMBOL___inner_s7 {
    crc: DWORD;
    rgbReserved: BYTE[14];
}

@foreign
union IMAGE_AUX_SYMBOL {
    Sym: IMAGE_AUX_SYMBOL___inner_s1;
    File: IMAGE_AUX_SYMBOL___inner_s5;
    Section: IMAGE_AUX_SYMBOL___inner_s6;
    TokenDef: IMAGE_AUX_SYMBOL_TOKEN_DEF;
    CRC: IMAGE_AUX_SYMBOL___inner_s7;
}

@foreign
typedef PIMAGE_AUX_SYMBOL = IMAGE_AUX_SYMBOL*;

struct IMAGE_AUX_SYMBOL_EX___inner_s1 {
    WeakDefaultSymIndex: DWORD;
    WeakSearchType: DWORD;
    rgbReserved: BYTE[12];
}

struct IMAGE_AUX_SYMBOL_EX___inner_s2 {
    Name: BYTE[sizeof(IMAGE_SYMBOL_EX)];
}

struct IMAGE_AUX_SYMBOL_EX___inner_s3 {
    Length: DWORD;
    NumberOfRelocations: WORD;
    NumberOfLinenumbers: WORD;
    CheckSum: DWORD;
    Number: SHORT;
    Selection: BYTE;
    bReserved: BYTE;
    HighNumber: SHORT;
    rgbReserved: BYTE[2];
}

struct IMAGE_AUX_SYMBOL_EX___inner_s4 {
    TokenDef: IMAGE_AUX_SYMBOL_TOKEN_DEF;
    rgbReserved: BYTE[2];
}

struct IMAGE_AUX_SYMBOL_EX___inner_s5 {
    crc: DWORD;
    rgbReserved: BYTE[16];
}

@foreign
union IMAGE_AUX_SYMBOL_EX {
    Sym: IMAGE_AUX_SYMBOL_EX___inner_s1;
    File: IMAGE_AUX_SYMBOL_EX___inner_s2;
    Section: IMAGE_AUX_SYMBOL_EX___inner_s3;
    s: IMAGE_AUX_SYMBOL_EX___inner_s4;
    CRC: IMAGE_AUX_SYMBOL_EX___inner_s5;
}

@foreign
typedef PIMAGE_AUX_SYMBOL_EX = IMAGE_AUX_SYMBOL_EX*;

@foreign
enum IMAGE_AUX_SYMBOL_TYPE {
    IMAGE_AUX_SYMBOL_TYPE_TOKEN_DEF = 1,
}

union IMAGE_RELOCATION___inner {
    VirtualAddress: DWORD;
    RelocCount: DWORD;
}

@foreign
struct IMAGE_RELOCATION {
    u: IMAGE_RELOCATION___inner;
    SymbolTableIndex: DWORD;
    Type: WORD;
}

@foreign
typedef PIMAGE_RELOCATION = IMAGE_RELOCATION*;

union IMAGE_LINENUMBER___inner {
    SymbolTableIndex: DWORD;
    VirtualAddress: DWORD;
}

@foreign
struct IMAGE_LINENUMBER {
    Type: IMAGE_LINENUMBER___inner;
    Linenumber: WORD;
}

@foreign
typedef PIMAGE_LINENUMBER = IMAGE_LINENUMBER*;

@foreign
struct IMAGE_BASE_RELOCATION {
    VirtualAddress: DWORD;
    SizeOfBlock: DWORD;
}

@foreign
typedef PIMAGE_BASE_RELOCATION = IMAGE_BASE_RELOCATION*;

@foreign
struct IMAGE_ARCHIVE_MEMBER_HEADER {
    Name: BYTE[16];
    Date: BYTE[12];
    UserID: BYTE[6];
    GroupID: BYTE[6];
    Mode: BYTE[8];
    Size: BYTE[10];
    EndHeader: BYTE[2];
}

@foreign
typedef PIMAGE_ARCHIVE_MEMBER_HEADER = IMAGE_ARCHIVE_MEMBER_HEADER*;

@foreign
struct IMAGE_EXPORT_DIRECTORY {
    Characteristics: DWORD;
    TimeDateStamp: DWORD;
    MajorVersion: WORD;
    MinorVersion: WORD;
    Name: DWORD;
    Base: DWORD;
    NumberOfFunctions: DWORD;
    NumberOfNames: DWORD;
    AddressOfFunctions: DWORD;
    AddressOfNames: DWORD;
    AddressOfNameOrdinals: DWORD;
}

@foreign
typedef PIMAGE_EXPORT_DIRECTORY = IMAGE_EXPORT_DIRECTORY*;

@foreign
struct IMAGE_IMPORT_BY_NAME {
    Hint: WORD;
    Name: CHAR[1];
}

@foreign
typedef PIMAGE_IMPORT_BY_NAME = IMAGE_IMPORT_BY_NAME*;

union IMAGE_THUNK_DATA64___inner {
    ForwarderString: ULONGLONG;
    Function: ULONGLONG;
    Ordinal: ULONGLONG;
    AddressOfData: ULONGLONG;
}

@foreign
struct IMAGE_THUNK_DATA64 {
    u1: IMAGE_THUNK_DATA64___inner;
}

@foreign
typedef PIMAGE_THUNK_DATA64 = IMAGE_THUNK_DATA64*;

union IMAGE_THUNK_DATA32___inner {
    ForwarderString: DWORD;
    Function: DWORD;
    Ordinal: DWORD;
    AddressOfData: DWORD;
}


@foreign
struct IMAGE_THUNK_DATA32 {
    u1: IMAGE_THUNK_DATA32___inner;
}

@foreign
typedef PIMAGE_THUNK_DATA32 = IMAGE_THUNK_DATA32*;

@foreign
typedef PIMAGE_TLS_CALLBACK = func(DllHandle: PVOID, Reason: DWORD, Reserved: PVOID);

// @PROBLEM bitfields
@foreign
struct IMAGE_TLS_DIRECTORY64;

@foreign
typedef PIMAGE_TLS_DIRECTORY64 = IMAGE_TLS_DIRECTORY64*;

// @PROBLEM bitfields
@foreign
struct IMAGE_TLS_DIRECTORY32;

@foreign
typedef PIMAGE_TLS_DIRECTORY32 = IMAGE_TLS_DIRECTORY32*;

@foreign
typedef IMAGE_THUNK_DATA = IMAGE_THUNK_DATA64;

@foreign
typedef PIMAGE_THUNK_DATA = PIMAGE_THUNK_DATA64;

@foreign
typedef IMAGE_TLS_DIRECTORY = IMAGE_TLS_DIRECTORY64;

@foreign
typedef PIMAGE_TLS_DIRECTORY = PIMAGE_TLS_DIRECTORY64;

union IMAGE_IMPORT_DESCRIPTOR___inner {
    Characteristics: DWORD;
    OriginalFirstThunk: DWORD;
}

@foreign
struct IMAGE_IMPORT_DESCRIPTOR {
    u: IMAGE_IMPORT_DESCRIPTOR___inner;
    TimeDateStamp: DWORD;
    ForwarderChain: DWORD;
    Name: DWORD;
    FirstThunk: DWORD;
}

@foreign
typedef PIMAGE_IMPORT_DESCRIPTOR = IMAGE_IMPORT_DESCRIPTOR*;

@foreign
struct IMAGE_BOUND_IMPORT_DESCRIPTOR {
    TimeDateStamp: DWORD;
    OffsetModuleName: WORD;
    NumberOfModuleForwarderRefs: WORD;
}

@foreign
typedef PIMAGE_BOUND_IMPORT_DESCRIPTOR = IMAGE_BOUND_IMPORT_DESCRIPTOR*;

@foreign
struct IMAGE_BOUND_FORWARDER_REF {
    TimeDateStamp: DWORD;
    OffsetModuleName: WORD;
    Reserved: WORD;
}

@foreign
typedef PIMAGE_BOUND_FORWARDER_REF = IMAGE_BOUND_FORWARDER_REF*;

// @PROBLEM bitfields
@foreign
struct IMAGE_DELAYLOAD_DESCRIPTOR;

@foreign
typedef PIMAGE_DELAYLOAD_DESCRIPTOR = IMAGE_DELAYLOAD_DESCRIPTOR*;

@foreign
typedef PCIMAGE_DELAYLOAD_DESCRIPTOR = IMAGE_DELAYLOAD_DESCRIPTOR*;

@foreign
struct IMAGE_RESOURCE_DIRECTORY {
    Characteristics: DWORD;
    TimeDateStamp: DWORD;
    MajorVersion: WORD;
    MinorVersion: WORD;
    NumberOfNamedEntries: WORD;
    NumberOfIdEntries: WORD;
}

@foreign
typedef PIMAGE_RESOURCE_DIRECTORY = IMAGE_RESOURCE_DIRECTORY*;

// @PROBLEM bitfields
@foreign
struct IMAGE_RESOURCE_DIRECTORY_ENTRY;

@foreign
typedef PIMAGE_RESOURCE_DIRECTORY_ENTRY = IMAGE_RESOURCE_DIRECTORY_ENTRY*;

@foreign
struct IMAGE_RESOURCE_DIRECTORY_STRING {
    Length: WORD;
    NameString: CHAR[1];
}

@foreign
typedef PIMAGE_RESOURCE_DIRECTORY_STRING = IMAGE_RESOURCE_DIRECTORY_STRING*;

@foreign
struct IMAGE_RESOURCE_DIR_STRING_U {
    Length: WORD;
    NameString: WCHAR[1];
}

@foreign
typedef PIMAGE_RESOURCE_DIR_STRING_U = IMAGE_RESOURCE_DIR_STRING_U*;

@foreign
struct IMAGE_RESOURCE_DATA_ENTRY {
    OffsetToData: DWORD;
    Size: DWORD;
    CodePage: DWORD;
    Reserved: DWORD;
}

@foreign
typedef PIMAGE_RESOURCE_DATA_ENTRY = IMAGE_RESOURCE_DATA_ENTRY*;

@foreign
struct IMAGE_LOAD_CONFIG_CODE_INTEGRITY {
    Flags: WORD;
    Catalog: WORD;
    CatalogOffset: DWORD;
    Reserved: DWORD;
}

@foreign
typedef PIMAGE_LOAD_CONFIG_CODE_INTEGRITY = IMAGE_LOAD_CONFIG_CODE_INTEGRITY*;

@foreign
struct IMAGE_DYNAMIC_RELOCATION_TABLE {
    Version: DWORD;
    Size: DWORD;
}

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION_TABLE = IMAGE_DYNAMIC_RELOCATION_TABLE*;

@foreign
struct IMAGE_DYNAMIC_RELOCATION32 {
    Symbol: DWORD;
    BaseRelocSize: DWORD;
}

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION32 = IMAGE_DYNAMIC_RELOCATION32*;

@foreign
struct IMAGE_DYNAMIC_RELOCATION64 {
    Symbol: ULONGLONG;
    BaseRelocSize: DWORD;
}

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION64 = IMAGE_DYNAMIC_RELOCATION64*;

@foreign
struct IMAGE_DYNAMIC_RELOCATION32_V2 {
    HeaderSize: DWORD;
    FixupInfoSize: DWORD;
    Symbol: DWORD;
    SymbolGroup: DWORD;
    Flags: DWORD;
}

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION32_V2 = IMAGE_DYNAMIC_RELOCATION32_V2*;

@foreign
struct IMAGE_DYNAMIC_RELOCATION64_V2 {
    HeaderSize: DWORD;
    FixupInfoSize: DWORD;
    Symbol: ULONGLONG;
    SymbolGroup: DWORD;
    Flags: DWORD;
}

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION64_V2 = IMAGE_DYNAMIC_RELOCATION64_V2*;

@foreign
typedef IMAGE_DYNAMIC_RELOCATION = IMAGE_DYNAMIC_RELOCATION64;

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION = PIMAGE_DYNAMIC_RELOCATION64;

@foreign
typedef IMAGE_DYNAMIC_RELOCATION_V2 = IMAGE_DYNAMIC_RELOCATION64_V2;

@foreign
typedef PIMAGE_DYNAMIC_RELOCATION_V2 = PIMAGE_DYNAMIC_RELOCATION64_V2;

@foreign
struct IMAGE_PROLOGUE_DYNAMIC_RELOCATION_HEADER {
    PrologueByteCount: BYTE;
}

@foreign
typedef PIMAGE_PROLOGUE_DYNAMIC_RELOCATION_HEADER = IMAGE_PROLOGUE_DYNAMIC_RELOCATION_HEADER*;

@foreign
struct IMAGE_EPILOGUE_DYNAMIC_RELOCATION_HEADER {
    EpilogueCount: DWORD;
    EpilogueByteCount: BYTE;
    BranchDescriptorElementSize: BYTE;
    BranchDescriptorCount: WORD;
}

@foreign
typedef PIMAGE_EPILOGUE_DYNAMIC_RELOCATION_HEADER = IMAGE_EPILOGUE_DYNAMIC_RELOCATION_HEADER*;

@foreign
struct IMAGE_LOAD_CONFIG_DIRECTORY32 {
    Size: DWORD;
    TimeDateStamp: DWORD;
    MajorVersion: WORD;
    MinorVersion: WORD;
    GlobalFlagsClear: DWORD;
    GlobalFlagsSet: DWORD;
    CriticalSectionDefaultTimeout: DWORD;
    DeCommitFreeBlockThreshold: DWORD;
    DeCommitTotalFreeThreshold: DWORD;
    LockPrefixTable: DWORD;
    MaximumAllocationSize: DWORD;
    VirtualMemoryThreshold: DWORD;
    ProcessHeapFlags: DWORD;
    ProcessAffinityMask: DWORD;
    CSDVersion: WORD;
    DependentLoadFlags: WORD;
    EditList: DWORD;
    SecurityCookie: DWORD;
    SEHandlerTable: DWORD;
    SEHandlerCount: DWORD;
    GuardCFCheckFunctionPointer: DWORD;
    GuardCFDispatchFunctionPointer: DWORD;
    GuardCFFunctionTable: DWORD;
    GuardCFFunctionCount: DWORD;
    GuardFlags: DWORD;
    CodeIntegrity: IMAGE_LOAD_CONFIG_CODE_INTEGRITY;
    GuardAddressTakenIatEntryTable: DWORD;
    GuardAddressTakenIatEntryCount: DWORD;
    GuardLongJumpTargetTable: DWORD;
    GuardLongJumpTargetCount: DWORD;
    DynamicValueRelocTable: DWORD;
    CHPEMetadataPointer: DWORD;
    GuardRFFailureRoutine: DWORD;
    GuardRFFailureRoutineFunctionPointer: DWORD;
    DynamicValueRelocTableOffset: DWORD;
    DynamicValueRelocTableSection: WORD;
    Reserved2: WORD;
    GuardRFVerifyStackPointerFunctionPointer: DWORD;
    HotPatchTableOffset: DWORD;
    Reserved3: DWORD;
    EnclaveConfigurationPointer: DWORD;
}

@foreign
typedef PIMAGE_LOAD_CONFIG_DIRECTORY32 = IMAGE_LOAD_CONFIG_DIRECTORY32*;

@foreign
struct IMAGE_LOAD_CONFIG_DIRECTORY64 {
    Size: DWORD;
    TimeDateStamp: DWORD;
    MajorVersion: WORD;
    MinorVersion: WORD;
    GlobalFlagsClear: DWORD;
    GlobalFlagsSet: DWORD;
    CriticalSectionDefaultTimeout: DWORD;
    DeCommitFreeBlockThreshold: ULONGLONG;
    DeCommitTotalFreeThreshold: ULONGLONG;
    LockPrefixTable: ULONGLONG;
    MaximumAllocationSize: ULONGLONG;
    VirtualMemoryThreshold: ULONGLONG;
    ProcessAffinityMask: ULONGLONG;
    ProcessHeapFlags: DWORD;
    CSDVersion: WORD;
    DependentLoadFlags: WORD;
    EditList: ULONGLONG;
    SecurityCookie: ULONGLONG;
    SEHandlerTable: ULONGLONG;
    SEHandlerCount: ULONGLONG;
    GuardCFCheckFunctionPointer: ULONGLONG;
    GuardCFDispatchFunctionPointer: ULONGLONG;
    GuardCFFunctionTable: ULONGLONG;
    GuardCFFunctionCount: ULONGLONG;
    GuardFlags: DWORD;
    CodeIntegrity: IMAGE_LOAD_CONFIG_CODE_INTEGRITY;
    GuardAddressTakenIatEntryTable: ULONGLONG;
    GuardAddressTakenIatEntryCount: ULONGLONG;
    GuardLongJumpTargetTable: ULONGLONG;
    GuardLongJumpTargetCount: ULONGLONG;
    DynamicValueRelocTable: ULONGLONG;
    CHPEMetadataPointer: ULONGLONG;
    GuardRFFailureRoutine: ULONGLONG;
    GuardRFFailureRoutineFunctionPointer: ULONGLONG;
    DynamicValueRelocTableOffset: DWORD;
    DynamicValueRelocTableSection: WORD;
    Reserved2: WORD;
    GuardRFVerifyStackPointerFunctionPointer: ULONGLONG;
    HotPatchTableOffset: DWORD;
    Reserved3: DWORD;
    EnclaveConfigurationPointer: ULONGLONG;
}

@foreign
typedef PIMAGE_LOAD_CONFIG_DIRECTORY64 = IMAGE_LOAD_CONFIG_DIRECTORY64*;

@foreign
typedef IMAGE_LOAD_CONFIG_DIRECTORY = IMAGE_LOAD_CONFIG_DIRECTORY64;

@foreign
typedef PIMAGE_LOAD_CONFIG_DIRECTORY = PIMAGE_LOAD_CONFIG_DIRECTORY64;

@foreign
struct IMAGE_HOT_PATCH_INFO {
    Version: DWORD;
    Size: DWORD;
    SequenceNumber: DWORD;
    BaseImageList: DWORD;
    BaseImageCount: DWORD;
    BufferOffset: DWORD;
}

@foreign
typedef PIMAGE_HOT_PATCH_INFO = IMAGE_HOT_PATCH_INFO*;

@foreign
struct IMAGE_HOT_PATCH_BASE {
    SequenceNumber: DWORD;
    Flags: DWORD;
    OriginalTimeDateStamp: DWORD;
    OriginalCheckSum: DWORD;
    CodeIntegrityInfo: DWORD;
    CodeIntegritySize: DWORD;
    PatchTable: DWORD;
    BufferOffset: DWORD;
}

@foreign
typedef PIMAGE_HOT_PATCH_BASE = IMAGE_HOT_PATCH_BASE*;

@foreign
struct IMAGE_HOT_PATCH_HASHES {
    SHA256: BYTE[32];
    SHA1: BYTE[20];
}

@foreign
typedef PIMAGE_HOT_PATCH_HASHES = IMAGE_HOT_PATCH_HASHES*;

@foreign
struct IMAGE_CE_RUNTIME_FUNCTION_ENTRY {
    FuncStart: DWORD;
    PrologLen: DWORD;
    FuncLen: DWORD;
    ThirtyTwoBit: DWORD;
    ExceptionFlag: DWORD;
}

@foreign
typedef PIMAGE_CE_RUNTIME_FUNCTION_ENTRY = IMAGE_CE_RUNTIME_FUNCTION_ENTRY*;

// @PROBLEM bitfields
@foreign
struct IMAGE_ARM_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef PIMAGE_ARM_RUNTIME_FUNCTION_ENTRY = IMAGE_ARM_RUNTIME_FUNCTION_ENTRY*;

// @PROBLEM bitfields
@foreign
struct IMAGE_ARM64_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef PIMAGE_ARM64_RUNTIME_FUNCTION_ENTRY = IMAGE_ARM64_RUNTIME_FUNCTION_ENTRY*;

@foreign
struct IMAGE_ALPHA64_RUNTIME_FUNCTION_ENTRY {
    BeginAddress: ULONGLONG;
    EndAddress: ULONGLONG;
    ExceptionHandler: ULONGLONG;
    HandlerData: ULONGLONG;
    PrologEndAddress: ULONGLONG;
}

@foreign
typedef PIMAGE_ALPHA64_RUNTIME_FUNCTION_ENTRY = IMAGE_ALPHA64_RUNTIME_FUNCTION_ENTRY*;

@foreign
struct IMAGE_ALPHA_RUNTIME_FUNCTION_ENTRY {
    BeginAddress: DWORD;
    EndAddress: DWORD;
    ExceptionHandler: DWORD;
    HandlerData: DWORD;
    PrologEndAddress: DWORD;
}

@foreign
typedef PIMAGE_ALPHA_RUNTIME_FUNCTION_ENTRY = IMAGE_ALPHA_RUNTIME_FUNCTION_ENTRY*;

union _IMAGE_RUNTIME_FUNCTION_ENTRY___inner {
    UnwindInfoAddress: DWORD;
    UnwindData: DWORD;
}

@foreign
struct _IMAGE_RUNTIME_FUNCTION_ENTRY {
    BeginAddress: DWORD;
    EndAddress: DWORD;
    u: _IMAGE_RUNTIME_FUNCTION_ENTRY___inner;
}

@foreign
typedef _PIMAGE_RUNTIME_FUNCTION_ENTRY = _IMAGE_RUNTIME_FUNCTION_ENTRY*;

@foreign
typedef IMAGE_IA64_RUNTIME_FUNCTION_ENTRY = _IMAGE_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef PIMAGE_IA64_RUNTIME_FUNCTION_ENTRY = _PIMAGE_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef IMAGE_RUNTIME_FUNCTION_ENTRY = _IMAGE_RUNTIME_FUNCTION_ENTRY;

@foreign
typedef PIMAGE_RUNTIME_FUNCTION_ENTRY = _PIMAGE_RUNTIME_FUNCTION_ENTRY;

@foreign
struct IMAGE_ENCLAVE_CONFIG32 {
    Size: DWORD;
    MinimumRequiredConfigSize: DWORD;
    PolicyFlags: DWORD;
    NumberOfImports: DWORD;
    ImportList: DWORD;
    ImportEntrySize: DWORD;
    FamilyID: BYTE[16];
    ImageID: BYTE[16];
    ImageVersion: DWORD;
    SecurityVersion: DWORD;
    EnclaveSize: DWORD;
    NumberOfThreads: DWORD;
    EnclaveFlags: DWORD;
}

@foreign
typedef PIMAGE_ENCLAVE_CONFIG32 = IMAGE_ENCLAVE_CONFIG32*;

@foreign
struct IMAGE_ENCLAVE_CONFIG64 {
    Size: DWORD;
    MinimumRequiredConfigSize: DWORD;
    PolicyFlags: DWORD;
    NumberOfImports: DWORD;
    ImportList: DWORD;
    ImportEntrySize: DWORD;
    FamilyID: BYTE[16];
    ImageID: BYTE[16];
    ImageVersion: DWORD;
    SecurityVersion: DWORD;
    EnclaveSize: ULONGLONG;
    NumberOfThreads: DWORD;
    EnclaveFlags: DWORD;
}

@foreign
typedef PIMAGE_ENCLAVE_CONFIG64 = IMAGE_ENCLAVE_CONFIG64*;

@foreign
typedef IMAGE_ENCLAVE_CONFIG = IMAGE_ENCLAVE_CONFIG64;

@foreign
typedef PIMAGE_ENCLAVE_CONFIG = PIMAGE_ENCLAVE_CONFIG64;

@foreign
struct IMAGE_ENCLAVE_IMPORT {
    MatchType: DWORD;
    MinimumSecurityVersion: DWORD;
    UniqueOrAuthorID: BYTE[32];
    FamilyID: BYTE[16];
    ImageID: BYTE[16];
    ImportName: DWORD;
    Reserved: DWORD;
}

@foreign
typedef PIMAGE_ENCLAVE_IMPORT = IMAGE_ENCLAVE_IMPORT*;

@foreign
struct IMAGE_DEBUG_DIRECTORY {
    Characteristics: DWORD;
    TimeDateStamp: DWORD;
    MajorVersion: WORD;
    MinorVersion: WORD;
    Type: DWORD;
    SizeOfData: DWORD;
    AddressOfRawData: DWORD;
    PointerToRawData: DWORD;
}

@foreign
typedef PIMAGE_DEBUG_DIRECTORY = IMAGE_DEBUG_DIRECTORY*;

@foreign
struct IMAGE_COFF_SYMBOLS_HEADER {
    NumberOfSymbols: DWORD;
    LvaToFirstSymbol: DWORD;
    NumberOfLinenumbers: DWORD;
    LvaToFirstLinenumber: DWORD;
    RvaToFirstByteOfCode: DWORD;
    RvaToLastByteOfCode: DWORD;
    RvaToFirstByteOfData: DWORD;
    RvaToLastByteOfData: DWORD;
}

@foreign
typedef PIMAGE_COFF_SYMBOLS_HEADER = IMAGE_COFF_SYMBOLS_HEADER*;

@foreign
struct FPO_DATA {
    ulOffStart: DWORD;
    cbProcSize: DWORD;
    cdwLocals: DWORD;
    cdwParams: WORD;
    cbProlog: WORD;
    cbRegs: WORD;
    fHasSEH: WORD;
    fUseBP: WORD;
    reserved: WORD;
    cbFrame: WORD;
}

@foreign
typedef PFPO_DATA = FPO_DATA*;

@foreign
struct IMAGE_DEBUG_MISC {
    DataType: DWORD;
    Length: DWORD;
    Unicode: BOOLEAN;
    Reserved: BYTE[3];
    Data: BYTE[1];
}

@foreign
typedef PIMAGE_DEBUG_MISC = IMAGE_DEBUG_MISC*;

@foreign
struct IMAGE_FUNCTION_ENTRY {
    StartingAddress: DWORD;
    EndingAddress: DWORD;
    EndOfPrologue: DWORD;
}

@foreign
typedef PIMAGE_FUNCTION_ENTRY = IMAGE_FUNCTION_ENTRY*;

union IMAGE_FUNCTION_ENTRY64___inner {
    EndOfPrologue: ULONGLONG;
    UnwindInfoAddress: ULONGLONG;
}

@foreign
struct IMAGE_FUNCTION_ENTRY64 {
    StartingAddress: ULONGLONG;
    EndingAddress: ULONGLONG;
    u: IMAGE_FUNCTION_ENTRY64___inner;
}

@foreign
typedef PIMAGE_FUNCTION_ENTRY64 = IMAGE_FUNCTION_ENTRY64*;

@foreign
struct IMAGE_SEPARATE_DEBUG_HEADER {
    Signature: WORD;
    Flags: WORD;
    Machine: WORD;
    Characteristics: WORD;
    TimeDateStamp: DWORD;
    CheckSum: DWORD;
    ImageBase: DWORD;
    SizeOfImage: DWORD;
    NumberOfSections: DWORD;
    ExportedNamesSize: DWORD;
    DebugDirectorySize: DWORD;
    SectionAlignment: DWORD;
    Reserved: DWORD[2];
}

@foreign
typedef PIMAGE_SEPARATE_DEBUG_HEADER = IMAGE_SEPARATE_DEBUG_HEADER*;

@foreign
struct NON_PAGED_DEBUG_INFO {
    Signature: WORD;
    Flags: WORD;
    Size: DWORD;
    Machine: WORD;
    Characteristics: WORD;
    TimeDateStamp: DWORD;
    CheckSum: DWORD;
    SizeOfImage: DWORD;
    ImageBase: ULONGLONG;
}

@foreign
typedef PNON_PAGED_DEBUG_INFO = NON_PAGED_DEBUG_INFO*;

@foreign
struct IMAGE_ARCHITECTURE_ENTRY {
    FixupInstRVA: DWORD;
    NewInst: DWORD;
}

@foreign
typedef PIMAGE_ARCHITECTURE_ENTRY = IMAGE_ARCHITECTURE_ENTRY*;

/*
@PROBLEM Nested struct def at line 18344, C:\Program Files (x86)\Windows Kits\10\include\10.0.16299.0\um\winnt.h

@foreign
struct IMPORT_OBJECT_HEADER {
    Sig1: WORD;
    Sig2: WORD;
    Version: WORD;
    Machine: WORD;
    TimeDateStamp: DWORD;
    SizeOfData: DWORD;
    u: (null);
    Type: WORD;
    NameType: WORD;
    Reserved: WORD;
}
*/

@foreign
enum IMPORT_OBJECT_TYPE {
    IMPORT_OBJECT_CODE = 0,
    IMPORT_OBJECT_DATA = 1,
    IMPORT_OBJECT_CONST = 2,
}

@foreign
enum IMPORT_OBJECT_NAME_TYPE {
    IMPORT_OBJECT_ORDINAL = 0,
    IMPORT_OBJECT_NAME = 1,
    IMPORT_OBJECT_NAME_NO_PREFIX = 2,
    IMPORT_OBJECT_NAME_UNDECORATE = 3,
    IMPORT_OBJECT_NAME_EXPORTAS = 4,
}

@foreign
enum ReplacesCorHdrNumericDefines {
    COMIMAGE_FLAGS_ILONLY = 1,
    IMAGE_COR_MIH_METHODRVA = 1,
    COR_VTABLE_32BIT = 1,
    NATIVE_TYPE_MAX_CB = 1,
    COR_VERSION_MAJOR = 2,
    COR_VERSION_MAJOR_V2 = 2,
    COR_VTABLE_64BIT = 2,
    IMAGE_COR_MIH_EHRVA = 2,
    COMIMAGE_FLAGS_32BITREQUIRED = 2,
    COMIMAGE_FLAGS_IL_LIBRARY = 4,
    COR_VTABLE_FROM_UNMANAGED = 4,
    COR_VERSION_MINOR = 5,
    COR_DELETED_NAME_LENGTH = 8,
    IMAGE_COR_MIH_BASICBLOCK = 8,
    COMIMAGE_FLAGS_STRONGNAMESIGNED = 8,
    COR_VTABLEGAP_NAME_LENGTH = 8,
    COR_VTABLE_FROM_UNMANAGED_RETAIN_APPDOMAIN = 8,
    COR_VTABLE_CALL_MOST_DERIVED = 16,
    COMIMAGE_FLAGS_NATIVE_ENTRYPOINT = 16,
    IMAGE_COR_EATJ_THUNK_SIZE = 32,
    COR_ILMETHOD_SECT_SMALL_MAX_DATASIZE = 255,
    MAX_CLASS_NAME = 1024,
    MAX_PACKAGE_NAME = 1024,
    COMIMAGE_FLAGS_TRACKDEBUGDATA = 65536,
    COMIMAGE_FLAGS_32BITPREFERRED = 131072,
}

union IMAGE_COR20_HEADER___inner {
    EntryPointToken: DWORD;
    EntryPointRVA: DWORD;
}

@foreign
struct IMAGE_COR20_HEADER {
    cb: DWORD;
    MajorRuntimeVersion: WORD;
    MinorRuntimeVersion: WORD;
    MetaData: IMAGE_DATA_DIRECTORY;
    Flags: DWORD;
    u: IMAGE_COR20_HEADER___inner;
    Resources: IMAGE_DATA_DIRECTORY;
    StrongNameSignature: IMAGE_DATA_DIRECTORY;
    CodeManagerTable: IMAGE_DATA_DIRECTORY;
    VTableFixups: IMAGE_DATA_DIRECTORY;
    ExportAddressTableJumps: IMAGE_DATA_DIRECTORY;
    ManagedNativeHeader: IMAGE_DATA_DIRECTORY;
}

@foreign
typedef PIMAGE_COR20_HEADER = IMAGE_COR20_HEADER*;

@foreign
func RtlCaptureStackBackTrace(FramesToSkip: DWORD, FramesToCapture: DWORD, BackTrace: PVOID*, BackTraceHash: PDWORD): WORD;

@foreign
func RtlCaptureContext(ContextRecord: PCONTEXT);

@foreign
func RtlUnwind(TargetFrame: PVOID, TargetIp: PVOID, ExceptionRecord: PEXCEPTION_RECORD, ReturnValue: PVOID);

@foreign
func RtlAddFunctionTable(FunctionTable: PRUNTIME_FUNCTION, EntryCount: DWORD, BaseAddress: DWORD64): BOOLEAN;

@foreign
func RtlDeleteFunctionTable(FunctionTable: PRUNTIME_FUNCTION): BOOLEAN;

@foreign
func RtlInstallFunctionTableCallback(TableIdentifier: DWORD64, BaseAddress: DWORD64, Length: DWORD, Callback: PGET_RUNTIME_FUNCTION_CALLBACK, Context: PVOID, OutOfProcessCallbackDll: PCWSTR): BOOLEAN;

@foreign
func RtlAddGrowableFunctionTable(DynamicTable: PVOID*, FunctionTable: PRUNTIME_FUNCTION, EntryCount: DWORD, MaximumEntryCount: DWORD, RangeBase: ULONG_PTR, RangeEnd: ULONG_PTR): DWORD;

@foreign
func RtlGrowFunctionTable(DynamicTable: PVOID, NewEntryCount: DWORD);

@foreign
func RtlDeleteGrowableFunctionTable(DynamicTable: PVOID);

@foreign
func RtlLookupFunctionEntry(ControlPc: DWORD64, ImageBase: PDWORD64, HistoryTable: PUNWIND_HISTORY_TABLE): PRUNTIME_FUNCTION;

@foreign
func RtlRestoreContext(ContextRecord: PCONTEXT, ExceptionRecord: _EXCEPTION_RECORD*);

@foreign
func RtlUnwindEx(TargetFrame: PVOID, TargetIp: PVOID, ExceptionRecord: PEXCEPTION_RECORD, ReturnValue: PVOID, ContextRecord: PCONTEXT, HistoryTable: PUNWIND_HISTORY_TABLE);

@foreign
func RtlVirtualUnwind(HandlerType: DWORD, ImageBase: DWORD64, ControlPc: DWORD64, FunctionEntry: PRUNTIME_FUNCTION, ContextRecord: PCONTEXT, HandlerData: PVOID*, EstablisherFrame: PDWORD64, ContextPointers: PKNONVOLATILE_CONTEXT_POINTERS): PEXCEPTION_ROUTINE;

@foreign
func RtlPcToFileHeader(PcValue: PVOID, BaseOfImage: PVOID*): PVOID;

@foreign
func RtlCompareMemory(Source1: void const*, Source2: void const*, Length: SIZE_T): SIZE_T;

@foreign
struct SLIST_ENTRY {
    Next: _SLIST_ENTRY*;
}

@foreign
typedef PSLIST_ENTRY = SLIST_ENTRY*;

// @PROBLEM bitfields
@foreign
struct SLIST_HEADER;

@foreign
typedef PSLIST_HEADER = SLIST_HEADER*;

@foreign
func RtlInitializeSListHead(ListHead: PSLIST_HEADER);

@foreign
func RtlFirstEntrySList(ListHead: SLIST_HEADER*): PSLIST_ENTRY;

@foreign
func RtlInterlockedPopEntrySList(ListHead: PSLIST_HEADER): PSLIST_ENTRY;

@foreign
func RtlInterlockedPushEntrySList(ListHead: PSLIST_HEADER, ListEntry: PSLIST_ENTRY): PSLIST_ENTRY;

@foreign
func RtlInterlockedPushListSListEx(ListHead: PSLIST_HEADER, List: PSLIST_ENTRY, ListEnd: PSLIST_ENTRY, Count: DWORD): PSLIST_ENTRY;

@foreign
func RtlInterlockedFlushSList(ListHead: PSLIST_HEADER): PSLIST_ENTRY;

@foreign
func RtlQueryDepthSList(ListHead: PSLIST_HEADER): WORD;

@foreign
union RTL_RUN_ONCE {
    Ptr: PVOID;
}

@foreign
typedef PRTL_RUN_ONCE = RTL_RUN_ONCE*;

@foreign
struct RTL_BARRIER {
    Reserved1: DWORD;
    Reserved2: DWORD;
    Reserved3: ULONG_PTR[2];
    Reserved4: DWORD;
    Reserved5: DWORD;
}

@foreign
typedef PRTL_BARRIER = RTL_BARRIER*;

@foreign
func __fastfail(Code: uint);

@foreign
struct MESSAGE_RESOURCE_ENTRY {
    Length: WORD;
    Flags: WORD;
    Text: BYTE[1];
}

@foreign
typedef PMESSAGE_RESOURCE_ENTRY = MESSAGE_RESOURCE_ENTRY*;

@foreign
struct MESSAGE_RESOURCE_BLOCK {
    LowId: DWORD;
    HighId: DWORD;
    OffsetToEntries: DWORD;
}

@foreign
typedef PMESSAGE_RESOURCE_BLOCK = MESSAGE_RESOURCE_BLOCK*;

@foreign
struct MESSAGE_RESOURCE_DATA {
    NumberOfBlocks: DWORD;
    Blocks: MESSAGE_RESOURCE_BLOCK[1];
}

@foreign
typedef PMESSAGE_RESOURCE_DATA = MESSAGE_RESOURCE_DATA*;

@foreign
struct OSVERSIONINFOA {
    dwOSVersionInfoSize: DWORD;
    dwMajorVersion: DWORD;
    dwMinorVersion: DWORD;
    dwBuildNumber: DWORD;
    dwPlatformId: DWORD;
    szCSDVersion: CHAR[128];
}

@foreign
typedef POSVERSIONINFOA = OSVERSIONINFOA*;

@foreign
typedef LPOSVERSIONINFOA = OSVERSIONINFOA*;

@foreign
struct OSVERSIONINFOW {
    dwOSVersionInfoSize: DWORD;
    dwMajorVersion: DWORD;
    dwMinorVersion: DWORD;
    dwBuildNumber: DWORD;
    dwPlatformId: DWORD;
    szCSDVersion: WCHAR[128];
}

@foreign
typedef POSVERSIONINFOW = OSVERSIONINFOW*;

@foreign
typedef LPOSVERSIONINFOW = OSVERSIONINFOW*;

@foreign
typedef RTL_OSVERSIONINFOW = OSVERSIONINFOW;

@foreign
typedef PRTL_OSVERSIONINFOW = OSVERSIONINFOW*;

@foreign
typedef OSVERSIONINFO = OSVERSIONINFOA;

@foreign
typedef POSVERSIONINFO = POSVERSIONINFOA;

@foreign
typedef LPOSVERSIONINFO = LPOSVERSIONINFOA;

@foreign
struct OSVERSIONINFOEXA {
    dwOSVersionInfoSize: DWORD;
    dwMajorVersion: DWORD;
    dwMinorVersion: DWORD;
    dwBuildNumber: DWORD;
    dwPlatformId: DWORD;
    szCSDVersion: CHAR[128];
    wServicePackMajor: WORD;
    wServicePackMinor: WORD;
    wSuiteMask: WORD;
    wProductType: BYTE;
    wReserved: BYTE;
}

@foreign
typedef POSVERSIONINFOEXA = OSVERSIONINFOEXA*;

@foreign
typedef LPOSVERSIONINFOEXA = OSVERSIONINFOEXA*;

@foreign
struct OSVERSIONINFOEXW {
    dwOSVersionInfoSize: DWORD;
    dwMajorVersion: DWORD;
    dwMinorVersion: DWORD;
    dwBuildNumber: DWORD;
    dwPlatformId: DWORD;
    szCSDVersion: WCHAR[128];
    wServicePackMajor: WORD;
    wServicePackMinor: WORD;
    wSuiteMask: WORD;
    wProductType: BYTE;
    wReserved: BYTE;
}

@foreign
typedef POSVERSIONINFOEXW = OSVERSIONINFOEXW*;

@foreign
typedef LPOSVERSIONINFOEXW = OSVERSIONINFOEXW*;

@foreign
typedef RTL_OSVERSIONINFOEXW = OSVERSIONINFOEXW;

@foreign
typedef PRTL_OSVERSIONINFOEXW = OSVERSIONINFOEXW*;

@foreign
typedef OSVERSIONINFOEX = OSVERSIONINFOEXA;

@foreign
typedef POSVERSIONINFOEX = POSVERSIONINFOEXA;

@foreign
typedef LPOSVERSIONINFOEX = LPOSVERSIONINFOEXA;

@foreign
func VerSetConditionMask(ConditionMask: ULONGLONG, TypeMask: DWORD, Condition: BYTE): ULONGLONG;

@foreign
func RtlGetProductInfo(OSMajorVersion: DWORD, OSMinorVersion: DWORD, SpMajorVersion: DWORD, SpMinorVersion: DWORD, ReturnedProductType: PDWORD): BOOLEAN;

@foreign
enum RTL_UMS_THREAD_INFO_CLASS {
    UmsThreadInvalidInfoClass = 0,
    UmsThreadUserContext,
    UmsThreadPriority,
    UmsThreadAffinity,
    UmsThreadTeb,
    UmsThreadIsSuspended,
    UmsThreadIsTerminated,
    UmsThreadMaxInfoClass,
}

@foreign
typedef PRTL_UMS_THREAD_INFO_CLASS = RTL_UMS_THREAD_INFO_CLASS*;

@foreign
enum RTL_UMS_SCHEDULER_REASON {
    UmsSchedulerStartup = 0,
    UmsSchedulerThreadBlocked,
    UmsSchedulerThreadYield,
}

@foreign
typedef PRTL_UMS_SCHEDULER_REASON = RTL_UMS_SCHEDULER_REASON*;

@foreign
typedef RTL_UMS_SCHEDULER_ENTRY_POINT = func(Reason: RTL_UMS_SCHEDULER_REASON, ActivationPayload: ULONG_PTR, SchedulerParam: PVOID);

@foreign
typedef PRTL_UMS_SCHEDULER_ENTRY_POINT = RTL_UMS_SCHEDULER_ENTRY_POINT*;

@foreign
func RtlCrc32(Buffer: void const*, Size: usize, InitialCrc: DWORD): DWORD;

@foreign
func RtlCrc64(Buffer: void const*, Size: usize, InitialCrc: ULONGLONG): ULONGLONG;

@foreign
enum OS_DEPLOYEMENT_STATE_VALUES {
    OS_DEPLOYMENT_STANDARD = 1,
    OS_DEPLOYMENT_COMPACT,
}

@foreign
func RtlOsDeploymentState(Flags: DWORD): OS_DEPLOYEMENT_STATE_VALUES;

@foreign
struct NV_MEMORY_RANGE {
    BaseAddress: void*;
    Length: SIZE_T;
}

@foreign
typedef PNV_MEMORY_RANGE = NV_MEMORY_RANGE*;

@foreign
func RtlGetNonVolatileToken(NvBuffer: PVOID, Size: SIZE_T, NvToken: PVOID*): DWORD;

@foreign
func RtlFreeNonVolatileToken(NvToken: PVOID): DWORD;

@foreign
func RtlFlushNonVolatileMemory(NvToken: PVOID, NvBuffer: PVOID, Size: SIZE_T, Flags: DWORD): DWORD;

@foreign
func RtlDrainNonVolatileFlush(NvToken: PVOID): DWORD;

@foreign
func RtlWriteNonVolatileMemory(NvToken: PVOID, NvDestination: void*, Source: void*, Size: SIZE_T, Flags: DWORD): DWORD;

@foreign
func RtlFlushNonVolatileMemoryRanges(NvToken: PVOID, NvRanges: PNV_MEMORY_RANGE, NumRanges: SIZE_T, Flags: DWORD): DWORD;

@foreign
struct CORRELATION_VECTOR {
    Version: CHAR;
    Vector: CHAR[129];
}

@foreign
typedef PCORRELATION_VECTOR = CORRELATION_VECTOR*;

@foreign
func RtlInitializeCorrelationVector(CorrelationVector: PCORRELATION_VECTOR, Version: int, Guid: GUID*): DWORD;

@foreign
func RtlIncrementCorrelationVector(CorrelationVector: PCORRELATION_VECTOR): DWORD;

@foreign
func RtlExtendCorrelationVector(CorrelationVector: PCORRELATION_VECTOR): DWORD;

@foreign
func RtlValidateCorrelationVector(Vector: PCORRELATION_VECTOR): DWORD;

@foreign
enum IMAGE_POLICY_ENTRY_TYPE {
    ImagePolicyEntryTypeNone = 0,
    ImagePolicyEntryTypeBool,
    ImagePolicyEntryTypeInt8,
    ImagePolicyEntryTypeUInt8,
    ImagePolicyEntryTypeInt16,
    ImagePolicyEntryTypeUInt16,
    ImagePolicyEntryTypeInt32,
    ImagePolicyEntryTypeUInt32,
    ImagePolicyEntryTypeInt64,
    ImagePolicyEntryTypeUInt64,
    ImagePolicyEntryTypeAnsiString,
    ImagePolicyEntryTypeUnicodeString,
    ImagePolicyEntryTypeMaximum,
}

@foreign
enum IMAGE_POLICY_ID {
    ImagePolicyIdNone = 0,
    ImagePolicyIdEtw,
    ImagePolicyIdDebug,
    ImagePolicyIdCrashDump,
    ImagePolicyIdCrashDumpKey,
    ImagePolicyIdCrashDumpKeyGuid,
    ImagePolicyIdParentSd,
    ImagePolicyIdParentSdRev,
    ImagePolicyIdSvn,
    ImagePolicyIdDeviceId,
    ImagePolicyIdCapability,
    ImagePolicyIdScenarioId,
    ImagePolicyIdMaximum,
}

union IMAGE_POLICY_ENTRY___inner {
    None: void const*;
    BoolValue: BOOLEAN;
    Int8Value: INT8;
    UInt8Value: UINT8;
    Int16Value: INT16;
    UInt16Value: UINT16;
    Int32Value: INT32;
    UInt32Value: UINT32;
    Int64Value: INT64;
    UInt64Value: UINT64;
    AnsiStringValue: PCSTR;
    UnicodeStringValue: PCWSTR;
}

@foreign
struct IMAGE_POLICY_ENTRY {
    Type: IMAGE_POLICY_ENTRY_TYPE;
    PolicyId: IMAGE_POLICY_ID;
    u: IMAGE_POLICY_ENTRY___inner;
}

@foreign
typedef PCIMAGE_POLICY_ENTRY = IMAGE_POLICY_ENTRY const*;

@foreign
struct IMAGE_POLICY_METADATA {
    Version: BYTE;
    Reserved0: BYTE[7];
    ApplicationId: ULONGLONG;
    Policies: IMAGE_POLICY_ENTRY[];
}

@foreign
typedef PCIMAGE_POLICY_METADATA = IMAGE_POLICY_METADATA*;

@foreign
struct RTL_CRITICAL_SECTION_DEBUG {
    Type: WORD;
    CreatorBackTraceIndex: WORD;
    CriticalSection: _RTL_CRITICAL_SECTION*;
    ProcessLocksList: LIST_ENTRY;
    EntryCount: DWORD;
    ContentionCount: DWORD;
    Flags: DWORD;
    CreatorBackTraceIndexHigh: WORD;
    SpareWORD: WORD;
}

@foreign
typedef PRTL_CRITICAL_SECTION_DEBUG = RTL_CRITICAL_SECTION_DEBUG*;

@foreign
typedef RTL_RESOURCE_DEBUG = RTL_CRITICAL_SECTION_DEBUG;

@foreign
typedef PRTL_RESOURCE_DEBUG = RTL_CRITICAL_SECTION_DEBUG*;

@foreign
struct RTL_CRITICAL_SECTION {
    DebugInfo: PRTL_CRITICAL_SECTION_DEBUG;
    LockCount: LONG;
    RecursionCount: LONG;
    OwningThread: HANDLE;
    LockSemaphore: HANDLE;
    SpinCount: ULONG_PTR;
}

@foreign
typedef PRTL_CRITICAL_SECTION = RTL_CRITICAL_SECTION*;

@foreign
struct RTL_SRWLOCK {
    Ptr: PVOID;
}

@foreign
typedef PRTL_SRWLOCK = RTL_SRWLOCK*;

@foreign
struct RTL_CONDITION_VARIABLE {
    Ptr: PVOID;
}

@foreign
typedef PRTL_CONDITION_VARIABLE = RTL_CONDITION_VARIABLE*;

@foreign
typedef PAPCFUNC = func(Parameter: ULONG_PTR);

@foreign
typedef PVECTORED_EXCEPTION_HANDLER = func(ExceptionInfo: EXCEPTION_POINTERS*): LONG;

@foreign
enum HEAP_INFORMATION_CLASS {
    HeapCompatibilityInformation = 0,
    HeapEnableTerminationOnCorruption = 1,
    HeapOptimizeResources = 3,
}

@foreign
struct HEAP_OPTIMIZE_RESOURCES_INFORMATION {
    Version: DWORD;
    Flags: DWORD;
}

@foreign
typedef PHEAP_OPTIMIZE_RESOURCES_INFORMATION = HEAP_OPTIMIZE_RESOURCES_INFORMATION*;

@foreign
typedef WAITORTIMERCALLBACKFUNC = func(arg0: PVOID, arg1: BOOLEAN);

@foreign
typedef WORKERCALLBACKFUNC = func(arg0: PVOID);

@foreign
typedef APC_CALLBACK_FUNCTION = func(arg0: DWORD, arg1: PVOID, arg2: PVOID);

@foreign
typedef WAITORTIMERCALLBACK = WAITORTIMERCALLBACKFUNC;

@foreign
typedef PFLS_CALLBACK_FUNCTION = func(lpFlsData: PVOID);

@foreign
typedef PSECURE_MEMORY_CACHE_CALLBACK = func(Addr: PVOID, Range: SIZE_T): BOOLEAN;

@foreign
enum ACTIVATION_CONTEXT_INFO_CLASS {
    ActivationContextBasicInformation = 1,
    ActivationContextDetailedInformation = 2,
    AssemblyDetailedInformationInActivationContxt = 3,
    AssemblyDetailedInformationInActivationContext = 3,
    FileInformationInAssemblyOfAssemblyInActivationContxt = 4,
    FileInformationInAssemblyOfAssemblyInActivationContext = 4,
    RunlevelInformationInActivationContext = 5,
    CompatibilityInformationInActivationContext = 6,
    ActivationContextManifestResourceName = 7,
    MaxActivationContextInfoClass,
}

@foreign
struct ACTIVATION_CONTEXT_QUERY_INDEX {
    ulAssemblyIndex: DWORD;
    ulFileIndexInAssembly: DWORD;
}

@foreign
typedef PACTIVATION_CONTEXT_QUERY_INDEX = ACTIVATION_CONTEXT_QUERY_INDEX*;

@foreign
typedef PCACTIVATION_CONTEXT_QUERY_INDEX = ACTIVATION_CONTEXT_QUERY_INDEX*;

@foreign
struct ASSEMBLY_FILE_DETAILED_INFORMATION {
    ulFlags: DWORD;
    ulFilenameLength: DWORD;
    ulPathLength: DWORD;
    lpFileName: PCWSTR;
    lpFilePath: PCWSTR;
}

@foreign
typedef PASSEMBLY_FILE_DETAILED_INFORMATION = ASSEMBLY_FILE_DETAILED_INFORMATION*;

@foreign
typedef PCASSEMBLY_FILE_DETAILED_INFORMATION = ASSEMBLY_FILE_DETAILED_INFORMATION*;

@foreign
struct ACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION {
    ulFlags: DWORD;
    ulEncodedAssemblyIdentityLength: DWORD;
    ulManifestPathType: DWORD;
    ulManifestPathLength: DWORD;
    liManifestLastWriteTime: LARGE_INTEGER;
    ulPolicyPathType: DWORD;
    ulPolicyPathLength: DWORD;
    liPolicyLastWriteTime: LARGE_INTEGER;
    ulMetadataSatelliteRosterIndex: DWORD;
    ulManifestVersionMajor: DWORD;
    ulManifestVersionMinor: DWORD;
    ulPolicyVersionMajor: DWORD;
    ulPolicyVersionMinor: DWORD;
    ulAssemblyDirectoryNameLength: DWORD;
    lpAssemblyEncodedAssemblyIdentity: PCWSTR;
    lpAssemblyManifestPath: PCWSTR;
    lpAssemblyPolicyPath: PCWSTR;
    lpAssemblyDirectoryName: PCWSTR;
    ulFileCount: DWORD;
}

@foreign
typedef PACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION = ACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION*;

@foreign
typedef PCACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION = ACTIVATION_CONTEXT_ASSEMBLY_DETAILED_INFORMATION*;

@foreign
enum ACTCTX_REQUESTED_RUN_LEVEL {
    ACTCTX_RUN_LEVEL_UNSPECIFIED = 0,
    ACTCTX_RUN_LEVEL_AS_INVOKER,
    ACTCTX_RUN_LEVEL_HIGHEST_AVAILABLE,
    ACTCTX_RUN_LEVEL_REQUIRE_ADMIN,
    ACTCTX_RUN_LEVEL_NUMBERS,
}

@foreign
struct ACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION {
    ulFlags: DWORD;
    RunLevel: ACTCTX_REQUESTED_RUN_LEVEL;
    UiAccess: DWORD;
}

@foreign
typedef PACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION = ACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION*;

@foreign
typedef PCACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION = ACTIVATION_CONTEXT_RUN_LEVEL_INFORMATION*;

@foreign
enum ACTCTX_COMPATIBILITY_ELEMENT_TYPE {
    ACTCTX_COMPATIBILITY_ELEMENT_TYPE_UNKNOWN = 0,
    ACTCTX_COMPATIBILITY_ELEMENT_TYPE_OS,
    ACTCTX_COMPATIBILITY_ELEMENT_TYPE_MITIGATION,
}

@foreign
struct COMPATIBILITY_CONTEXT_ELEMENT {
    Id: GUID;
    Type: ACTCTX_COMPATIBILITY_ELEMENT_TYPE;
}

@foreign
typedef PCOMPATIBILITY_CONTEXT_ELEMENT = COMPATIBILITY_CONTEXT_ELEMENT*;

@foreign
typedef PCCOMPATIBILITY_CONTEXT_ELEMENT = COMPATIBILITY_CONTEXT_ELEMENT*;

@foreign
struct ACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION {
    ElementCount: DWORD;
    Elements: COMPATIBILITY_CONTEXT_ELEMENT[];
}

@foreign
typedef PACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION = ACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION*;

@foreign
typedef PCACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION = ACTIVATION_CONTEXT_COMPATIBILITY_INFORMATION*;

@foreign
struct SUPPORTED_OS_INFO {
    MajorVersion: WORD;
    MinorVersion: WORD;
}

@foreign
typedef PSUPPORTED_OS_INFO = SUPPORTED_OS_INFO*;

@foreign
struct ACTIVATION_CONTEXT_DETAILED_INFORMATION {
    dwFlags: DWORD;
    ulFormatVersion: DWORD;
    ulAssemblyCount: DWORD;
    ulRootManifestPathType: DWORD;
    ulRootManifestPathChars: DWORD;
    ulRootConfigurationPathType: DWORD;
    ulRootConfigurationPathChars: DWORD;
    ulAppDirPathType: DWORD;
    ulAppDirPathChars: DWORD;
    lpRootManifestPath: PCWSTR;
    lpRootConfigurationPath: PCWSTR;
    lpAppDirPath: PCWSTR;
}

@foreign
typedef PACTIVATION_CONTEXT_DETAILED_INFORMATION = ACTIVATION_CONTEXT_DETAILED_INFORMATION*;

@foreign
typedef PCACTIVATION_CONTEXT_DETAILED_INFORMATION = ACTIVATION_CONTEXT_DETAILED_INFORMATION*;

@foreign
struct HARDWARE_COUNTER_DATA {
    Type: HARDWARE_COUNTER_TYPE;
    Reserved: DWORD;
    Value: DWORD64;
}

@foreign
typedef PHARDWARE_COUNTER_DATA = HARDWARE_COUNTER_DATA*;

@foreign
struct PERFORMANCE_DATA {
    Size: WORD;
    Version: BYTE;
    HwCountersCount: BYTE;
    ContextSwitchCount: DWORD;
    WaitReasonBitMap: DWORD64;
    CycleTime: DWORD64;
    RetryCount: DWORD;
    Reserved: DWORD;
    HwCounters: HARDWARE_COUNTER_DATA[16];
}

@foreign
typedef PPERFORMANCE_DATA = PERFORMANCE_DATA*;

@foreign
func RtlGetDeviceFamilyInfoEnum(pullUAPInfo: ULONGLONG*, pulDeviceFamily: DWORD*, pulDeviceForm: DWORD*);

@foreign
func RtlConvertDeviceFamilyInfoToString(pulDeviceFamilyBufferSize: PDWORD, pulDeviceFormBufferSize: PDWORD, DeviceFamily: PWSTR, DeviceForm: PWSTR): DWORD;

@foreign
func RtlSwitchedVVI(VersionInfo: PRTL_OSVERSIONINFOEXW, TypeMask: DWORD, ConditionMask: ULONGLONG): DWORD;

@foreign
struct EVENTLOGRECORD {
    Length: DWORD;
    Reserved: DWORD;
    RecordNumber: DWORD;
    TimeGenerated: DWORD;
    TimeWritten: DWORD;
    EventID: DWORD;
    EventType: WORD;
    NumStrings: WORD;
    EventCategory: WORD;
    ReservedFlags: WORD;
    ClosingRecordNumber: DWORD;
    StringOffset: DWORD;
    UserSidLength: DWORD;
    UserSidOffset: DWORD;
    DataLength: DWORD;
    DataOffset: DWORD;
}

@foreign
typedef PEVENTLOGRECORD = EVENTLOGRECORD*;

@foreign
typedef EVENTSFORLOGFILE = _EVENTSFORLOGFILE;

@foreign
typedef PEVENTSFORLOGFILE = _EVENTSFORLOGFILE*;

@foreign
typedef PACKEDEVENTINFO = _PACKEDEVENTINFO;

@foreign
typedef PPACKEDEVENTINFO = _PACKEDEVENTINFO*;

@foreign
struct _EVENTSFORLOGFILE {
    ulSize: DWORD;
    szLogicalLogFile: WCHAR[256];
    ulNumRecords: DWORD;
    pEventLogRecords: EVENTLOGRECORD[];
}

@foreign
struct _PACKEDEVENTINFO {
    ulSize: DWORD;
    ulNumEventsForLogFile: DWORD;
    ulOffsets: DWORD[];
}

@foreign
enum SERVICE_NODE_TYPE {
    DriverType = 1,
    FileSystemType = 2,
    AdapterType = 4,
    RecognizerType = 8,
    Win32ServiceOwnProcess = 16,
    Win32ServiceShareProcess = 32,
}

@foreign
enum SERVICE_LOAD_TYPE {
    BootLoad = 0,
    SystemLoad = 1,
    AutoLoad = 2,
    DemandLoad = 3,
    DisableLoad = 4,
}

@foreign
enum SERVICE_ERROR_TYPE {
    IgnoreError = 0,
    NormalError = 1,
    SevereError = 2,
    CriticalError = 3,
}

@foreign
struct TAPE_ERASE {
    Type: DWORD;
    Immediate: BOOLEAN;
}

@foreign
typedef PTAPE_ERASE = TAPE_ERASE*;

@foreign
struct TAPE_PREPARE {
    Operation: DWORD;
    Immediate: BOOLEAN;
}

@foreign
typedef PTAPE_PREPARE = TAPE_PREPARE*;

@foreign
struct TAPE_WRITE_MARKS {
    Type: DWORD;
    Count: DWORD;
    Immediate: BOOLEAN;
}

@foreign
typedef PTAPE_WRITE_MARKS = TAPE_WRITE_MARKS*;

@foreign
struct TAPE_GET_POSITION {
    Type: DWORD;
    Partition: DWORD;
    Offset: LARGE_INTEGER;
}

@foreign
typedef PTAPE_GET_POSITION = TAPE_GET_POSITION*;

@foreign
struct TAPE_SET_POSITION {
    Method: DWORD;
    Partition: DWORD;
    Offset: LARGE_INTEGER;
    Immediate: BOOLEAN;
}

@foreign
typedef PTAPE_SET_POSITION = TAPE_SET_POSITION*;

@foreign
struct TAPE_GET_DRIVE_PARAMETERS {
    ECC: BOOLEAN;
    Compression: BOOLEAN;
    DataPadding: BOOLEAN;
    ReportSetmarks: BOOLEAN;
    DefaultBlockSize: DWORD;
    MaximumBlockSize: DWORD;
    MinimumBlockSize: DWORD;
    MaximumPartitionCount: DWORD;
    FeaturesLow: DWORD;
    FeaturesHigh: DWORD;
    EOTWarningZoneSize: DWORD;
}

@foreign
typedef PTAPE_GET_DRIVE_PARAMETERS = TAPE_GET_DRIVE_PARAMETERS*;

@foreign
struct TAPE_SET_DRIVE_PARAMETERS {
    ECC: BOOLEAN;
    Compression: BOOLEAN;
    DataPadding: BOOLEAN;
    ReportSetmarks: BOOLEAN;
    EOTWarningZoneSize: DWORD;
}

@foreign
typedef PTAPE_SET_DRIVE_PARAMETERS = TAPE_SET_DRIVE_PARAMETERS*;

@foreign
struct TAPE_GET_MEDIA_PARAMETERS {
    Capacity: LARGE_INTEGER;
    Remaining: LARGE_INTEGER;
    BlockSize: DWORD;
    PartitionCount: DWORD;
    WriteProtected: BOOLEAN;
}

@foreign
typedef PTAPE_GET_MEDIA_PARAMETERS = TAPE_GET_MEDIA_PARAMETERS*;

@foreign
struct TAPE_SET_MEDIA_PARAMETERS {
    BlockSize: DWORD;
}

@foreign
typedef PTAPE_SET_MEDIA_PARAMETERS = TAPE_SET_MEDIA_PARAMETERS*;

@foreign
struct TAPE_CREATE_PARTITION {
    Method: DWORD;
    Count: DWORD;
    Size: DWORD;
}

@foreign
typedef PTAPE_CREATE_PARTITION = TAPE_CREATE_PARTITION*;

@foreign
struct TAPE_WMI_OPERATIONS {
    Method: DWORD;
    DataBufferSize: DWORD;
    DataBuffer: PVOID;
}

@foreign
typedef PTAPE_WMI_OPERATIONS = TAPE_WMI_OPERATIONS*;

@foreign
enum TAPE_DRIVE_PROBLEM_TYPE {
    TapeDriveProblemNone,
    TapeDriveReadWriteWarning,
    TapeDriveReadWriteError,
    TapeDriveReadWarning,
    TapeDriveWriteWarning,
    TapeDriveReadError,
    TapeDriveWriteError,
    TapeDriveHardwareError,
    TapeDriveUnsupportedMedia,
    TapeDriveScsiConnectionError,
    TapeDriveTimetoClean,
    TapeDriveCleanDriveNow,
    TapeDriveMediaLifeExpired,
    TapeDriveSnappedTape,
}

@foreign
enum TRANSACTION_OUTCOME {
    TransactionOutcomeUndetermined = 1,
    TransactionOutcomeCommitted,
    TransactionOutcomeAborted,
}

@foreign
enum TRANSACTION_STATE {
    TransactionStateNormal = 1,
    TransactionStateIndoubt,
    TransactionStateCommittedNotify,
}

@foreign
struct TRANSACTION_BASIC_INFORMATION {
    TransactionId: GUID;
    State: DWORD;
    Outcome: DWORD;
}

@foreign
typedef PTRANSACTION_BASIC_INFORMATION = TRANSACTION_BASIC_INFORMATION*;

@foreign
struct TRANSACTIONMANAGER_BASIC_INFORMATION {
    TmIdentity: GUID;
    VirtualClock: LARGE_INTEGER;
}

@foreign
typedef PTRANSACTIONMANAGER_BASIC_INFORMATION = TRANSACTIONMANAGER_BASIC_INFORMATION*;

@foreign
struct TRANSACTIONMANAGER_LOG_INFORMATION {
    LogIdentity: GUID;
}

@foreign
typedef PTRANSACTIONMANAGER_LOG_INFORMATION = TRANSACTIONMANAGER_LOG_INFORMATION*;

@foreign
struct TRANSACTIONMANAGER_LOGPATH_INFORMATION {
    LogPathLength: DWORD;
    LogPath: WCHAR[1];
}

@foreign
typedef PTRANSACTIONMANAGER_LOGPATH_INFORMATION = TRANSACTIONMANAGER_LOGPATH_INFORMATION*;

@foreign
struct TRANSACTIONMANAGER_RECOVERY_INFORMATION {
    LastRecoveredLsn: ULONGLONG;
}

@foreign
typedef PTRANSACTIONMANAGER_RECOVERY_INFORMATION = TRANSACTIONMANAGER_RECOVERY_INFORMATION*;

@foreign
struct TRANSACTIONMANAGER_OLDEST_INFORMATION {
    OldestTransactionGuid: GUID;
}

@foreign
typedef PTRANSACTIONMANAGER_OLDEST_INFORMATION = TRANSACTIONMANAGER_OLDEST_INFORMATION*;

@foreign
struct TRANSACTION_PROPERTIES_INFORMATION {
    IsolationLevel: DWORD;
    IsolationFlags: DWORD;
    Timeout: LARGE_INTEGER;
    Outcome: DWORD;
    DescriptionLength: DWORD;
    Description: WCHAR[1];
}

@foreign
typedef PTRANSACTION_PROPERTIES_INFORMATION = TRANSACTION_PROPERTIES_INFORMATION*;

@foreign
struct TRANSACTION_BIND_INFORMATION {
    TmHandle: HANDLE;
}

@foreign
typedef PTRANSACTION_BIND_INFORMATION = TRANSACTION_BIND_INFORMATION*;

@foreign
struct TRANSACTION_ENLISTMENT_PAIR {
    EnlistmentId: GUID;
    ResourceManagerId: GUID;
}

@foreign
typedef PTRANSACTION_ENLISTMENT_PAIR = TRANSACTION_ENLISTMENT_PAIR*;

@foreign
struct TRANSACTION_ENLISTMENTS_INFORMATION {
    NumberOfEnlistments: DWORD;
    EnlistmentPair: TRANSACTION_ENLISTMENT_PAIR[1];
}

@foreign
typedef PTRANSACTION_ENLISTMENTS_INFORMATION = TRANSACTION_ENLISTMENTS_INFORMATION*;

@foreign
struct TRANSACTION_SUPERIOR_ENLISTMENT_INFORMATION {
    SuperiorEnlistmentPair: TRANSACTION_ENLISTMENT_PAIR;
}

@foreign
typedef PTRANSACTION_SUPERIOR_ENLISTMENT_INFORMATION = TRANSACTION_SUPERIOR_ENLISTMENT_INFORMATION*;

@foreign
struct RESOURCEMANAGER_BASIC_INFORMATION {
    ResourceManagerId: GUID;
    DescriptionLength: DWORD;
    Description: WCHAR[1];
}

@foreign
typedef PRESOURCEMANAGER_BASIC_INFORMATION = RESOURCEMANAGER_BASIC_INFORMATION*;

@foreign
struct RESOURCEMANAGER_COMPLETION_INFORMATION {
    IoCompletionPortHandle: HANDLE;
    CompletionKey: ULONG_PTR;
}

@foreign
typedef PRESOURCEMANAGER_COMPLETION_INFORMATION = RESOURCEMANAGER_COMPLETION_INFORMATION*;

@foreign
enum TRANSACTION_INFORMATION_CLASS {
    TransactionBasicInformation,
    TransactionPropertiesInformation,
    TransactionEnlistmentInformation,
    TransactionSuperiorEnlistmentInformation,
    TransactionBindInformation,
    TransactionDTCPrivateInformation,
}

@foreign
enum TRANSACTIONMANAGER_INFORMATION_CLASS {
    TransactionManagerBasicInformation,
    TransactionManagerLogInformation,
    TransactionManagerLogPathInformation,
    TransactionManagerOnlineProbeInformation = 3,
    TransactionManagerRecoveryInformation = 4,
    TransactionManagerOldestTransactionInformation = 5,
}

@foreign
enum RESOURCEMANAGER_INFORMATION_CLASS {
    ResourceManagerBasicInformation,
    ResourceManagerCompletionInformation,
}

@foreign
struct ENLISTMENT_BASIC_INFORMATION {
    EnlistmentId: GUID;
    TransactionId: GUID;
    ResourceManagerId: GUID;
}

@foreign
typedef PENLISTMENT_BASIC_INFORMATION = ENLISTMENT_BASIC_INFORMATION*;

@foreign
struct ENLISTMENT_CRM_INFORMATION {
    CrmTransactionManagerId: GUID;
    CrmResourceManagerId: GUID;
    CrmEnlistmentId: GUID;
}

@foreign
typedef PENLISTMENT_CRM_INFORMATION = ENLISTMENT_CRM_INFORMATION*;

@foreign
enum ENLISTMENT_INFORMATION_CLASS {
    EnlistmentBasicInformation,
    EnlistmentRecoveryInformation,
    EnlistmentCrmInformation,
}

@foreign
struct TRANSACTION_LIST_ENTRY {
    UOW: UOW;
}

@foreign
typedef PTRANSACTION_LIST_ENTRY = TRANSACTION_LIST_ENTRY*;

@foreign
struct TRANSACTION_LIST_INFORMATION {
    NumberOfTransactions: DWORD;
    TransactionInformation: TRANSACTION_LIST_ENTRY[1];
}

@foreign
typedef PTRANSACTION_LIST_INFORMATION = TRANSACTION_LIST_INFORMATION*;

@foreign
enum KTMOBJECT_TYPE {
    KTMOBJECT_TRANSACTION,
    KTMOBJECT_TRANSACTION_MANAGER,
    KTMOBJECT_RESOURCE_MANAGER,
    KTMOBJECT_ENLISTMENT,
    KTMOBJECT_INVALID,
}

@foreign
typedef PKTMOBJECT_TYPE = KTMOBJECT_TYPE*;

@foreign
struct KTMOBJECT_CURSOR {
    LastQuery: GUID;
    ObjectIdCount: DWORD;
    ObjectIds: GUID[1];
}

@foreign
typedef PKTMOBJECT_CURSOR = KTMOBJECT_CURSOR*;

@foreign
typedef TP_VERSION = DWORD;

@foreign
typedef PTP_VERSION = DWORD*;

@foreign
typedef TP_CALLBACK_INSTANCE = _TP_CALLBACK_INSTANCE;

@foreign
typedef PTP_CALLBACK_INSTANCE = _TP_CALLBACK_INSTANCE*;

@foreign
typedef PTP_SIMPLE_CALLBACK = func(Instance: PTP_CALLBACK_INSTANCE, Context: PVOID);

@foreign
typedef TP_POOL = _TP_POOL;

@foreign
typedef PTP_POOL = _TP_POOL*;

@foreign
enum TP_CALLBACK_PRIORITY {
    TP_CALLBACK_PRIORITY_HIGH,
    TP_CALLBACK_PRIORITY_NORMAL,
    TP_CALLBACK_PRIORITY_LOW,
    TP_CALLBACK_PRIORITY_INVALID,
    TP_CALLBACK_PRIORITY_COUNT = 3,
}

@foreign
struct TP_POOL_STACK_INFORMATION {
    StackReserve: SIZE_T;
    StackCommit: SIZE_T;
}

@foreign
typedef PTP_POOL_STACK_INFORMATION = TP_POOL_STACK_INFORMATION*;

@foreign
typedef TP_CLEANUP_GROUP = _TP_CLEANUP_GROUP;

@foreign
typedef PTP_CLEANUP_GROUP = _TP_CLEANUP_GROUP*;

@foreign
typedef PTP_CLEANUP_GROUP_CANCEL_CALLBACK = func(ObjectContext: PVOID, CleanupContext: PVOID);

// @PROBLEM bitfields
@foreign
struct TP_CALLBACK_ENVIRON_V3;

@foreign
typedef TP_CALLBACK_ENVIRON = TP_CALLBACK_ENVIRON_V3;

@foreign
typedef PTP_CALLBACK_ENVIRON = TP_CALLBACK_ENVIRON_V3*;

@foreign
typedef TP_WORK = _TP_WORK;

@foreign
typedef PTP_WORK = _TP_WORK*;

@foreign
typedef PTP_WORK_CALLBACK = func(Instance: PTP_CALLBACK_INSTANCE, Context: PVOID, Work: PTP_WORK);

@foreign
typedef TP_TIMER = _TP_TIMER;

@foreign
typedef PTP_TIMER = _TP_TIMER*;

@foreign
typedef PTP_TIMER_CALLBACK = func(Instance: PTP_CALLBACK_INSTANCE, Context: PVOID, Timer: PTP_TIMER);

@foreign
typedef TP_WAIT_RESULT = DWORD;

@foreign
typedef TP_WAIT = _TP_WAIT;

@foreign
typedef PTP_WAIT = _TP_WAIT*;

@foreign
typedef PTP_WAIT_CALLBACK = func(Instance: PTP_CALLBACK_INSTANCE, Context: PVOID, Wait: PTP_WAIT, WaitResult: TP_WAIT_RESULT);

@foreign
typedef TP_IO = _TP_IO;

@foreign
typedef PTP_IO = _TP_IO*;

@foreign
struct _TP_WAIT;

@foreign
struct _TP_CLEANUP_GROUP;

@foreign
struct _TP_POOL;

@foreign
struct _TP_CALLBACK_INSTANCE;

@foreign
struct _TP_IO;

@foreign
struct _TP_WORK;

@foreign
struct _TP_TIMER;

